{"version":3,"file":"static/chunks/pages/packet-log-16cc6d5c41414c3d.js","mappings":"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","sources":["webpack://_N_E/?7b24","webpack://_N_E/./src/pages/packet-log.tsx"],"sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/packet-log\",\n      function () {\n        return require(\"private-next-pages/packet-log.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/packet-log\"])\n      });\n    }\n  ","import { ICommandBarItemProps, Stack, StackItem } from \"@fluentui/react\";\nimport { makeStyles, mergeClasses, shorthands } from \"@griffel/react\";\nimport { AdbCommand, decodeUtf8 } from \"@yume-chan/adb\";\nimport { autorun, makeAutoObservable, observable, runInAction } from \"mobx\";\nimport { observer } from \"mobx-react-lite\";\nimport { NextPage } from \"next\";\nimport Head from \"next/head\";\nimport { CommandBar, Grid, GridCellProps, GridColumn, GridHeaderProps, GridRowProps, HexViewer, toText } from \"../components\";\nimport { GlobalState, PacketLogItem } from \"../state\";\nimport { Icons, RouteStackProps, useStableCallback, withDisplayName } from \"../utils\";\n\nconst ADB_COMMAND_NAME = {\n    [AdbCommand.Auth]: 'AUTH',\n    [AdbCommand.Close]: 'CLSE',\n    [AdbCommand.Connect]: 'CNXN',\n    [AdbCommand.OK]: 'OKAY',\n    [AdbCommand.Open]: 'OPEN',\n    [AdbCommand.Write]: 'WRTE',\n};\n\ninterface Column extends GridColumn {\n    title: string;\n}\n\nconst LINE_HEIGHT = 32;\n\nconst state = new class {\n    get empty() {\n        return !GlobalState.logs.length;\n    }\n\n    get commandBarItems(): ICommandBarItemProps[] {\n        return [\n            {\n                key: 'clear',\n                disabled: this.empty,\n                iconProps: { iconName: Icons.Delete },\n                text: 'Clear',\n                onClick: () => GlobalState.clearLog(),\n            }\n        ];\n    }\n\n    selectedPacket: PacketLogItem | undefined = undefined;\n\n    constructor() {\n        makeAutoObservable(\n            this,\n            {\n                selectedPacket: observable.ref,\n            }\n        );\n\n        autorun(() => {\n            if (GlobalState.logs.length === 0) {\n                this.selectedPacket = undefined;\n            }\n        });\n    }\n};\n\nconst useClasses = makeStyles({\n    grow: {\n        height: 0,\n    },\n    grid: {\n        height: '100%',\n    },\n    header: {\n        textAlign: 'center',\n        lineHeight: `${LINE_HEIGHT}px`,\n    },\n    row: {\n        '&:hover': {\n            backgroundColor: '#f3f2f1',\n        },\n    },\n    selected: {\n        backgroundColor: '#edebe9',\n    },\n    code: {\n        fontFamily: 'monospace',\n        textOverflow: 'ellipsis',\n        whiteSpace: 'nowrap',\n        lineHeight: LINE_HEIGHT + 'px',\n        cursor: 'default',\n        ...shorthands.overflow('hidden'),\n    },\n    hexViewer: {\n        ...shorthands.padding('12px'),\n        ...shorthands.borderTop('1px', 'solid', 'rgb(243, 242, 241)'),\n    },\n});\n\nconst columns: Column[] = [\n    {\n        title: 'Direction',\n        width: 100,\n        CellComponent: withDisplayName('Direction')(({ className, rowIndex, ...rest }: GridCellProps) => {\n            const item = GlobalState.logs[rowIndex];\n\n            const classes = useClasses();\n\n            return (\n                <div\n                    className={mergeClasses(className, classes.code)}\n                    {...rest}\n                >\n                    {item.direction}\n                </div>\n            );\n        }),\n    },\n    {\n        title: 'Command',\n        width: 100,\n        CellComponent: withDisplayName('Command')(({ className, rowIndex, ...rest }: GridCellProps) => {\n            const item = GlobalState.logs[rowIndex];\n\n            if (!item.commandString) {\n                item.commandString =\n                    ADB_COMMAND_NAME[item.command as AdbCommand] ??\n                    decodeUtf8(new Uint32Array([item.command]));\n            }\n\n            const classes = useClasses();\n\n            return (\n                <div\n                    className={mergeClasses(className, classes.code)}\n                    {...rest}\n                >\n                    {item.commandString}\n                </div>\n            );\n        }),\n    },\n    {\n        title: 'Arg0',\n        width: 100,\n        CellComponent: withDisplayName('Command')(({ className, rowIndex, ...rest }: GridCellProps) => {\n            const item = GlobalState.logs[rowIndex];\n\n            if (!item.arg0String) {\n                item.arg0String = item.arg0.toString(16).padStart(8, '0');\n            }\n\n            const classes = useClasses();\n\n            return (\n                <div\n                    className={mergeClasses(className, classes.code)}\n                    {...rest}\n                >\n                    {item.arg0String}\n                </div>\n            );\n        }),\n    },\n    {\n        title: 'Arg1',\n        width: 100,\n        CellComponent: withDisplayName('Command')(({ className, rowIndex, ...rest }: GridCellProps) => {\n            const item = GlobalState.logs[rowIndex];\n\n            if (!item.arg1String) {\n                item.arg1String = item.arg1.toString(16).padStart(8, '0');\n            }\n\n            const classes = useClasses();\n\n            return (\n                <div\n                    className={mergeClasses(className, classes.code)}\n                    {...rest}\n                >\n                    {item.arg1String}\n                </div>\n            );\n        }),\n    },\n    {\n        title: 'Payload',\n        width: 200,\n        flexGrow: 1,\n        CellComponent: withDisplayName('Command')(({ className, rowIndex, ...rest }: GridCellProps) => {\n            const item = GlobalState.logs[rowIndex];\n\n            if (!item.payloadString) {\n                item.payloadString = toText(item.payload.subarray(0, 100));\n            }\n\n            const classes = useClasses();\n\n            return (\n                <div\n                    className={mergeClasses(className, classes.code)}\n                    {...rest}\n                >\n                    {item.payloadString}\n                </div>\n            );\n        }),\n    },\n];\n\nconst Header = withDisplayName('Header')(({\n    className,\n    columnIndex,\n    ...rest\n}: GridHeaderProps) => {\n    const classes = useClasses();\n\n    return (\n        <div className={mergeClasses(className, classes.header)} {...rest}>\n            {columns[columnIndex].title}\n        </div>\n    );\n});\n\nconst Row = observer(function Row({\n    className,\n    rowIndex,\n    ...rest\n}: GridRowProps) {\n    const classes = useClasses();\n\n    const handleClick = useStableCallback(() => {\n        runInAction(() => {\n            state.selectedPacket = GlobalState.logs[rowIndex];\n        });\n    });\n\n    return (\n        <div\n            className={mergeClasses(\n                className,\n                classes.row,\n                state.selectedPacket === GlobalState.logs[rowIndex] && classes.selected\n            )}\n            onClick={handleClick}\n            {...rest}\n        />\n    );\n});\n\nconst PacketLog: NextPage = () => {\n    const classes = useClasses();\n\n    return (\n        <Stack {...RouteStackProps} tokens={{}}>\n            <Head>\n                <title>Packet Log - Android Web Toolbox</title>\n            </Head>\n\n            <CommandBar items={state.commandBarItems} />\n\n            <StackItem className={classes.grow} grow>\n                <Grid\n                    className={classes.grid}\n                    rowCount={GlobalState.logs.length}\n                    rowHeight={LINE_HEIGHT}\n                    columns={columns}\n                    HeaderComponent={Header}\n                    RowComponent={Row}\n                />\n            </StackItem>\n\n            {state.selectedPacket && state.selectedPacket.payload.length > 0 && (\n                <StackItem className={classes.grow} grow>\n                    <HexViewer className={classes.hexViewer} data={state.selectedPacket.payload} />\n                </StackItem>\n            )}\n        </Stack>\n    );\n};\n\nexport default observer(PacketLog);\n"],"names":["window","__NEXT_P","push","ADB_COMMAND_NAME","AdbCommand","state","selectedPacket","undefined","makeAutoObservable","this","observable","autorun","GlobalState","empty","commandBarItems","key","disabled","iconProps","iconName","Icons","text","onClick","useClasses","makeStyles","grow","height","grid","header","textAlign","lineHeight","row","backgroundColor","selected","code","fontFamily","textOverflow","whiteSpace","LINE_HEIGHT","cursor","shorthands","hexViewer","columns","title","width","CellComponent","withDisplayName","className","rowIndex","rest","item","classes","div","mergeClasses","direction","commandString","command","decodeUtf8","Uint32Array","arg0String","arg0","toString","padStart","arg1String","arg1","flexGrow","payloadString","toText","payload","subarray","Header","columnIndex","Row","observer","handleClick","useStableCallback","runInAction","Stack","RouteStackProps","tokens","Head","CommandBar","items","StackItem","Grid","rowCount","rowHeight","HeaderComponent","RowComponent","length","HexViewer","data"],"sourceRoot":""}