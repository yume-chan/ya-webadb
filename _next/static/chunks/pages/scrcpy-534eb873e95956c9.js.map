{"version":3,"file":"static/chunks/pages/scrcpy-534eb873e95956c9.js","mappings":"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","sources":["webpack://_N_E/?e32f","webpack://_N_E/./src/components/command-bar-spacer-item.tsx","webpack://_N_E/../../libraries/scrcpy/src/codec/av1.ts","webpack://_N_E/../../libraries/scrcpy/src/codec/nalu.ts","webpack://_N_E/../../libraries/scrcpy/src/codec/h264.ts","webpack://_N_E/../../libraries/scrcpy/src/codec/h265.ts","webpack://_N_E/../../libraries/scrcpy/src/codec/index.ts","webpack://_N_E/../../libraries/scrcpy/src/control/basic.ts","webpack://_N_E/../../libraries/scrcpy/src/control/inject-touch.ts","webpack://_N_E/../../libraries/scrcpy/src/control/type.ts","webpack://_N_E/../../libraries/scrcpy/src/control/hover-helper.ts","webpack://_N_E/../../libraries/scrcpy/src/control/inject-keycode.ts","webpack://_N_E/../../libraries/scrcpy/src/control/inject-text.ts","webpack://_N_E/../../libraries/scrcpy/src/control/rotate-device.ts","webpack://_N_E/../../libraries/scrcpy/src/control/set-screen-power-mode.ts","webpack://_N_E/../../libraries/scrcpy/src/control/serializer.ts","webpack://_N_E/../../libraries/scrcpy/src/control/writer.ts","webpack://_N_E/../../libraries/scrcpy/src/control/index.ts","webpack://_N_E/../../libraries/scrcpy/src/device-message/type.ts","webpack://_N_E/../../libraries/scrcpy/src/device-message/ack-clipboard.ts","webpack://_N_E/../../libraries/scrcpy/src/device-message/clipboard.ts","webpack://_N_E/../../libraries/scrcpy/src/device-message/stream.ts","webpack://_N_E/../../libraries/scrcpy/src/device-message/index.ts","webpack://_N_E/../../libraries/scrcpy/src/options/1_16/codec-options.ts","webpack://_N_E/../../libraries/scrcpy/src/options/1_16/float-to-uint16.ts","webpack://_N_E/../../libraries/scrcpy/src/options/1_16/init.ts","webpack://_N_E/../../libraries/scrcpy/src/options/1_16/message.ts","webpack://_N_E/../../libraries/scrcpy/src/options/codec.ts","webpack://_N_E/../../libraries/scrcpy/src/options/types.ts","webpack://_N_E/../../libraries/scrcpy/src/options/1_16/scroll.ts","webpack://_N_E/../../libraries/scrcpy/src/options/1_16/options.ts","webpack://_N_E/../../libraries/scrcpy/src/options/1_16/index.ts","webpack://_N_E/../../libraries/scrcpy/src/options/1_17.ts","webpack://_N_E/../../libraries/scrcpy/src/options/1_18.ts","webpack://_N_E/../../libraries/scrcpy/src/options/1_21.ts","webpack://_N_E/../../libraries/scrcpy/src/options/1_22/scroll.ts","webpack://_N_E/../../libraries/scrcpy/src/options/1_22/options.ts","webpack://_N_E/../../libraries/scrcpy/src/options/1_22/index.ts","webpack://_N_E/../../libraries/scrcpy/src/options/1_23.ts","webpack://_N_E/../../libraries/scrcpy/src/options/1_24.ts","webpack://_N_E/../../libraries/scrcpy/src/options/1_25/scroll.ts","webpack://_N_E/../../libraries/scrcpy/src/options/1_25/options.ts","webpack://_N_E/../../libraries/scrcpy/src/options/1_25/index.ts","webpack://_N_E/../../libraries/scrcpy/src/options/2_0.ts","webpack://_N_E/../../libraries/scrcpy/src/options/2_1.ts","webpack://_N_E/../../libraries/scrcpy/src/options/latest.ts","webpack://_N_E/../../libraries/scrcpy/src/options/index.ts","webpack://_N_E/../../libraries/scrcpy/src/index.ts","webpack://_N_E/../../libraries/scrcpy-decoder-webcodecs/src/index.ts","webpack://_N_E/./src/components/scrcpy/recorder.ts","webpack://_N_E/../../libraries/adb-scrcpy/src/client.ts","webpack://_N_E/../../libraries/adb-scrcpy/src/connection.ts","webpack://_N_E/../../libraries/adb-scrcpy/src/options/types.ts","webpack://_N_E/../../libraries/adb-scrcpy/src/options/1_16.ts","webpack://_N_E/../../libraries/adb-scrcpy/src/options/1_22.ts","webpack://_N_E/../../libraries/adb-scrcpy/src/options/2_0.ts","webpack://_N_E/../../libraries/adb-scrcpy/src/options/2_1.ts","webpack://_N_E/../../libraries/adb-scrcpy/src/options/latest.ts","webpack://_N_E/../../libraries/adb-scrcpy/src/options/index.ts","webpack://_N_E/../../libraries/adb-scrcpy/src/index.ts","webpack://_N_E/../../libraries/fetch-scrcpy-server/index.js","webpack://_N_E/../../libraries/pcm-player/src/index.ts","webpack://_N_E/./src/components/scrcpy/audio-decode-stream.ts","webpack://_N_E/./src/components/scrcpy/fetch-server.ts","webpack://_N_E/./src/components/scrcpy/input.ts","webpack://_N_E/../../libraries/scrcpy-decoder-tinyh264/src/wrapper.ts","webpack://_N_E/../../libraries/scrcpy-decoder-tinyh264/src/decoder.ts","webpack://_N_E/../../libraries/scrcpy-decoder-tinyh264/src/index.ts","webpack://_N_E/./src/components/scrcpy/settings.tsx","webpack://_N_E/./src/components/scrcpy/state.tsx","webpack://_N_E/./src/components/scrcpy/command-bar.tsx","webpack://_N_E/./src/components/scrcpy/navigation-bar.tsx","webpack://_N_E/./src/components/scrcpy/video-container.tsx","webpack://_N_E/./src/components/scrcpy/index.ts","webpack://_N_E/./src/hooks/add-event-listener.ts","webpack://_N_E/./src/hooks/layout-effect.ts","webpack://_N_E/./src/hooks/stable-callback.ts","webpack://_N_E/./src/hooks/local-storage.ts","webpack://_N_E/./src/hooks/index.ts","webpack://_N_E/./src/pages/scrcpy.tsx","webpack://_N_E/<anon>"],"sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/scrcpy\",\n      function () {\n        return require(\"private-next-pages/scrcpy.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/scrcpy\"])\n      });\n    }\n  ","import { useEffect, useState } from \"react\";\n\nexport function CommandBarSpacerItem() {\n    const [container, setContainer] = useState<HTMLDivElement | null>(null);\n\n    useEffect(() => {\n        if (!container) {\n            return;\n        }\n\n        const parent = container.parentElement!;\n        const originalFlexGrow = parent.style.flexGrow;\n        parent.style.flexGrow = \"1\";\n        return () => {\n            parent.style.flexGrow = originalFlexGrow;\n        };\n    }, [container]);\n\n    return <div ref={setContainer} />;\n}\n","export enum AndroidAv1Profile {\n    Main8 = 1 << 0,\n    Main10 = 1 << 1,\n    Main10Hdr10 = 1 << 12,\n    Main10Hdr10Plus = 1 << 13,\n}\n\nexport enum AndroidAv1Level {\n    Level2 = 1 << 0,\n    Level21 = 1 << 1,\n    Level22 = 1 << 2,\n    Level23 = 1 << 3,\n    Level3 = 1 << 4,\n    Level31 = 1 << 5,\n    Level32 = 1 << 6,\n    Level33 = 1 << 7,\n    Level4 = 1 << 8,\n    Level41 = 1 << 9,\n    Level42 = 1 << 10,\n    Level43 = 1 << 11,\n    Level5 = 1 << 12,\n    Level51 = 1 << 13,\n    Level52 = 1 << 14,\n    Level53 = 1 << 15,\n    Level6 = 1 << 16,\n    Level61 = 1 << 17,\n    Level62 = 1 << 18,\n    Level63 = 1 << 19,\n    Level7 = 1 << 20,\n    Level71 = 1 << 21,\n    Level72 = 1 << 22,\n    Level73 = 1 << 23,\n}\n","/**\n * Split NAL units from an H.264/H.265 Annex B stream.\n *\n * The input is not modified.\n * The returned NAL units are views of the input (no memory allocation nor copy),\n * and still contains emulation prevention bytes.\n *\n * This methods returns a generator, so it can be stopped immediately\n * after the interested NAL unit is found.\n */\nexport function* annexBSplitNalu(buffer: Uint8Array): Generator<Uint8Array> {\n    // -1 means we haven't found the first start code\n    let start = -1;\n    // How many `0x00`s in a row we have counted\n    let zeroCount = 0;\n    let inEmulation = false;\n\n    for (let i = 0; i < buffer.length; i += 1) {\n        const byte = buffer[i]!;\n\n        if (inEmulation) {\n            if (byte > 0x03) {\n                // `0x00000304` or larger are invalid\n                throw new Error(\"Invalid data\");\n            }\n\n            inEmulation = false;\n            continue;\n        }\n\n        if (byte === 0x00) {\n            zeroCount += 1;\n            continue;\n        }\n\n        const prevZeroCount = zeroCount;\n        zeroCount = 0;\n\n        if (start === -1) {\n            // 0x000001 is the start code\n            // But it can be preceded by any number of zeros\n            // So 2 is the minimal\n            if (prevZeroCount >= 2 && byte === 0x01) {\n                // Found start of first NAL unit\n                start = i + 1;\n                continue;\n            }\n\n            // Not begin with start code\n            throw new Error(\"Invalid data\");\n        }\n\n        if (prevZeroCount < 2) {\n            // zero or one `0x00`s are acceptable\n            continue;\n        }\n\n        if (byte === 0x01) {\n            // Found another NAL unit\n            yield buffer.subarray(start, i - prevZeroCount);\n\n            start = i + 1;\n            continue;\n        }\n\n        if (prevZeroCount > 2) {\n            // Too much `0x00`s\n            throw new Error(\"Invalid data\");\n        }\n\n        switch (byte) {\n            case 0x02:\n                // Didn't find why, but 7.4.1 NAL unit semantics forbids `0x000002` appearing in NAL units\n                throw new Error(\"Invalid data\");\n            case 0x03:\n                // `0x000003` is the \"emulation_prevention_three_byte\"\n                // `0x00000300`, `0x00000301`, `0x00000302` and `0x00000303` represent\n                // `0x000000`, `0x000001`, `0x000002` and `0x000003` respectively\n                inEmulation = true;\n                break;\n            default:\n                // `0x000004` or larger are as-is\n                break;\n        }\n    }\n\n    if (inEmulation) {\n        throw new Error(\"Invalid data\");\n    }\n\n    yield buffer.subarray(start, buffer.length);\n}\n\n/**\n * Remove emulation prevention bytes from a H.264/H.265 NAL Unit.\n *\n * The input is not modified.\n * If the input doesn't contain any emulation prevention bytes,\n * the input is returned as-is.\n * Otherwise, a new `Uint8Array` is created and returned.\n */\nexport function naluRemoveEmulation(buffer: Uint8Array) {\n    // output will be created when first emulation prevention byte is found\n    let output: Uint8Array | undefined;\n    let outputOffset = 0;\n\n    let zeroCount = 0;\n    let inEmulation = false;\n\n    let i = 0;\n    scan: for (; i < buffer.length; i += 1) {\n        const byte = buffer[i]!;\n\n        if (byte === 0x00) {\n            zeroCount += 1;\n            continue;\n        }\n\n        // Current byte is not zero\n        const prevZeroCount = zeroCount;\n        zeroCount = 0;\n\n        if (prevZeroCount < 2) {\n            // zero or one `0x00`s are acceptable\n            continue;\n        }\n\n        if (byte === 0x01) {\n            // Unexpected start code\n            throw new Error(\"Invalid data\");\n        }\n\n        if (prevZeroCount > 2) {\n            // Too much `0x00`s\n            throw new Error(\"Invalid data\");\n        }\n\n        switch (byte) {\n            case 0x02:\n                // Didn't find why, but 7.4.1 NAL unit semantics forbids `0x000002` appearing in NAL units\n                throw new Error(\"Invalid data\");\n            case 0x03:\n                // `0x000003` is the \"emulation_prevention_three_byte\"\n                // `0x00000300`, `0x00000301`, `0x00000302` and `0x00000303` represent\n                // `0x000000`, `0x000001`, `0x000002` and `0x000003` respectively\n                inEmulation = true;\n\n                // Create output and copy the data before the emulation prevention byte\n                // Output size is unknown, so we use the input size as an upper bound\n                output = new Uint8Array(buffer.length - 1);\n                output.set(buffer.subarray(0, i));\n                outputOffset = i;\n                i += 1;\n                break scan;\n            default:\n                // `0x000004` or larger are as-is\n                break;\n        }\n    }\n\n    if (!output) {\n        return buffer;\n    }\n\n    // Continue at the byte after the emulation prevention byte\n    for (; i < buffer.length; i += 1) {\n        const byte = buffer[i]!;\n\n        output[outputOffset] = byte;\n        outputOffset += 1;\n\n        if (inEmulation) {\n            if (byte > 0x03) {\n                // `0x00000304` or larger are invalid\n                throw new Error(\"Invalid data\");\n            }\n\n            // `00000300000300` results in `0000000000` (both `0x03` are removed)\n            // which means the `0x00` after `0x03` also counts\n            if (byte === 0x00) {\n                zeroCount += 1;\n            }\n\n            inEmulation = false;\n            continue;\n        }\n\n        if (byte === 0x00) {\n            zeroCount += 1;\n            continue;\n        }\n\n        const prevZeroCount = zeroCount;\n        zeroCount = 0;\n\n        if (prevZeroCount < 2) {\n            // zero or one `0x00`s are acceptable\n            continue;\n        }\n\n        if (byte === 0x01) {\n            // Unexpected start code\n            throw new Error(\"Invalid data\");\n        }\n\n        if (prevZeroCount > 2) {\n            // Too much `0x00`s\n            throw new Error(\"Invalid data\");\n        }\n\n        switch (byte) {\n            case 0x02:\n                // Didn't find why, but 7.4.1 NAL unit semantics forbids `0x000002` appearing in NAL units\n                throw new Error(\"Invalid data\");\n            case 0x03:\n                // `0x000003` is the \"emulation_prevention_three_byte\"\n                // `0x00000300`, `0x00000301`, `0x00000302` and `0x00000303` represent\n                // `0x000000`, `0x000001`, `0x000002` and `0x000003` respectively\n                inEmulation = true;\n\n                // Remove the emulation prevention byte\n                outputOffset -= 1;\n                break;\n            default:\n                // `0x000004` or larger are as-is\n                break;\n        }\n    }\n\n    return output.subarray(0, outputOffset);\n}\n\nexport class NaluSodbBitReader {\n    readonly #nalu: Uint8Array;\n    readonly #byteLength: number;\n    readonly #stopBitIndex: number;\n\n    #zeroCount = 0;\n    #bytePosition = -1;\n    #bitPosition = -1;\n    #byte = 0;\n\n    get byteLength() {\n        return this.#byteLength;\n    }\n\n    get stopBitIndex() {\n        return this.#stopBitIndex;\n    }\n\n    get bytePosition() {\n        return this.#bytePosition;\n    }\n\n    get bitPosition() {\n        return this.#bitPosition;\n    }\n\n    get ended() {\n        return (\n            this.#bytePosition === this.#byteLength &&\n            this.#bitPosition === this.#stopBitIndex\n        );\n    }\n\n    constructor(nalu: Uint8Array) {\n        this.#nalu = nalu;\n\n        for (let i = nalu.length - 1; i >= 0; i -= 1) {\n            if (this.#nalu[i] === 0) {\n                continue;\n            }\n\n            const byte = nalu[i]!;\n            for (let j = 0; j < 8; j += 1) {\n                if (((byte >> j) & 1) === 1) {\n                    this.#byteLength = i;\n                    this.#stopBitIndex = j;\n                    this.#readByte();\n                    return;\n                }\n            }\n        }\n\n        throw new Error(\"Stop bit not found\");\n    }\n\n    #readByte() {\n        this.#byte = this.#nalu[this.#bytePosition]!;\n        if (this.#zeroCount === 2 && this.#byte === 3) {\n            this.#zeroCount = 0;\n            this.#bytePosition += 1;\n            this.#readByte();\n            return;\n        }\n\n        if (this.#byte === 0) {\n            this.#zeroCount += 1;\n        } else {\n            this.#zeroCount = 0;\n        }\n    }\n\n    next() {\n        if (this.#bitPosition === -1) {\n            this.#bitPosition = 7;\n            this.#bytePosition += 1;\n            this.#readByte();\n        }\n\n        if (this.ended) {\n            throw new Error(\"Bit index out of bounds\");\n        }\n\n        const value = (this.#byte >> this.#bitPosition) & 1;\n        this.#bitPosition -= 1;\n        return value;\n    }\n\n    read(length: number): number {\n        if (length > 32) {\n            throw new Error(\"Read length too large\");\n        }\n\n        let result = 0;\n        for (let i = 0; i < length; i += 1) {\n            result = (result << 1) | this.next();\n        }\n        return result;\n    }\n\n    skip(length: number) {\n        for (let i = 0; i < length; i += 1) {\n            this.next();\n        }\n    }\n\n    decodeExponentialGolombNumber(): number {\n        let length = 0;\n        while (this.next() === 0) {\n            length += 1;\n        }\n        if (length === 0) {\n            return 0;\n        }\n        return ((1 << length) | this.read(length)) - 1;\n    }\n\n    #save() {\n        return {\n            zeroCount: this.#zeroCount,\n            bytePosition: this.#bytePosition,\n            bitPosition: this.#bitPosition,\n            byte: this.#byte,\n        };\n    }\n\n    #restore(state: {\n        zeroCount: number;\n        bytePosition: number;\n        bitPosition: number;\n        byte: number;\n    }) {\n        this.#zeroCount = state.zeroCount;\n        this.#bytePosition = state.bytePosition;\n        this.#bitPosition = state.bitPosition;\n        this.#byte = state.byte;\n    }\n\n    peek(length: number) {\n        const state = this.#save();\n        const result = this.read(length);\n        this.#restore(state);\n        return result;\n    }\n\n    readBytes(length: number): Uint8Array {\n        const result = new Uint8Array(length);\n        for (let i = 0; i < length; i += 1) {\n            result[i] = this.read(8);\n        }\n        return result;\n    }\n\n    peekBytes(length: number): Uint8Array {\n        const state = this.#save();\n        const result = this.readBytes(length);\n        this.#restore(state);\n        return result;\n    }\n}\n","// cspell: ignore golomb\n// cspell: ignore qpprime\n// cspell: ignore colour\n\nimport { NaluSodbBitReader, annexBSplitNalu } from \"./nalu.js\";\n\n// From https://developer.android.com/reference/android/media/MediaCodecInfo.CodecProfileLevel\nexport enum AndroidAvcProfile {\n    Baseline = 1 << 0,\n    Main = 1 << 1,\n    Extended = 1 << 2,\n    High = 1 << 3,\n    High10 = 1 << 4,\n    High422 = 1 << 5,\n    High444 = 1 << 6,\n    ConstrainedBaseline = 1 << 16,\n    ConstrainedHigh = 1 << 19,\n}\n\nexport enum AndroidAvcLevel {\n    Level1 = 1 << 0,\n    Level1b = 1 << 1,\n    Level11 = 1 << 2,\n    Level12 = 1 << 3,\n    Level13 = 1 << 4,\n    Level2 = 1 << 5,\n    Level21 = 1 << 6,\n    Level22 = 1 << 7,\n    Level3 = 1 << 8,\n    Level31 = 1 << 9,\n    Level32 = 1 << 10,\n    Level4 = 1 << 11,\n    Level41 = 1 << 12,\n    Level42 = 1 << 13,\n    Level5 = 1 << 14,\n    Level51 = 1 << 15,\n    Level52 = 1 << 16,\n    Level6 = 1 << 17,\n    Level61 = 1 << 18,\n    Level62 = 1 << 19,\n}\n\n// H.264 has two standards: ITU-T H.264 and ISO/IEC 14496-10\n// they have the same content, and refer themselves as \"H.264\".\n// The name \"AVC\" (Advanced Video Coding) is only used in ISO spec name,\n// and other ISO specs referring to H.264.\n// Because this module parses H.264 Annex B format,\n// it's named \"h264\" instead of \"avc\".\n\n// 7.3.2.1.1 Sequence parameter set data syntax\n// Variable names in this method uses the snake_case convention as in the spec for easier referencing.\nexport function h264ParseSequenceParameterSet(nalu: Uint8Array) {\n    const reader = new NaluSodbBitReader(nalu);\n    if (reader.next() !== 0) {\n        throw new Error(\"Invalid data\");\n    }\n\n    const nal_ref_idc = reader.read(2);\n    const nal_unit_type = reader.read(5);\n\n    if (nal_unit_type !== 7) {\n        throw new Error(\"Invalid data\");\n    }\n\n    if (nal_ref_idc === 0) {\n        throw new Error(\"Invalid data\");\n    }\n\n    const profile_idc = reader.read(8);\n    const constraint_set = reader.peek(8);\n\n    const constraint_set0_flag = !!reader.next();\n    const constraint_set1_flag = !!reader.next();\n    const constraint_set2_flag = !!reader.next();\n    const constraint_set3_flag = !!reader.next();\n    const constraint_set4_flag = !!reader.next();\n    const constraint_set5_flag = !!reader.next();\n\n    // reserved_zero_2bits\n    if (reader.read(2) !== 0) {\n        throw new Error(\"Invalid data\");\n    }\n\n    const level_idc = reader.read(8);\n    const seq_parameter_set_id = reader.decodeExponentialGolombNumber();\n\n    if (\n        profile_idc === 100 ||\n        profile_idc === 110 ||\n        profile_idc === 122 ||\n        profile_idc === 244 ||\n        profile_idc === 44 ||\n        profile_idc === 83 ||\n        profile_idc === 86 ||\n        profile_idc === 118 ||\n        profile_idc === 128 ||\n        profile_idc === 138 ||\n        profile_idc === 139 ||\n        profile_idc === 134\n    ) {\n        const chroma_format_idc = reader.decodeExponentialGolombNumber();\n        if (chroma_format_idc === 3) {\n            // separate_colour_plane_flag\n            reader.next();\n        }\n\n        // bit_depth_luma_minus8\n        reader.decodeExponentialGolombNumber();\n        // bit_depth_chroma_minus8\n        reader.decodeExponentialGolombNumber();\n\n        // qpprime_y_zero_transform_bypass_flag\n        reader.next();\n\n        const seq_scaling_matrix_present_flag = !!reader.next();\n        if (seq_scaling_matrix_present_flag) {\n            const seq_scaling_list_present_flag: boolean[] = [];\n            for (let i = 0; i < (chroma_format_idc !== 3 ? 8 : 12); i += 1) {\n                seq_scaling_list_present_flag[i] = !!reader.next();\n                if (seq_scaling_list_present_flag[i])\n                    if (i < 6) {\n                        // TODO\n                        // scaling_list( ScalingList4x4[ i ], 16,\n                        //               UseDefaultScalingMatrix4x4Flag[ i ])\n                    } else {\n                        // TODO\n                        // scaling_list( ScalingList8x8[ i  6 ], 64,\n                        //               UseDefaultScalingMatrix8x8Flag[ i  6 ] )\n                    }\n            }\n        }\n    }\n\n    // log2_max_frame_num_minus4\n    reader.decodeExponentialGolombNumber();\n    const pic_order_cnt_type = reader.decodeExponentialGolombNumber();\n    if (pic_order_cnt_type === 0) {\n        // log2_max_pic_order_cnt_lsb_minus4\n        reader.decodeExponentialGolombNumber();\n    } else if (pic_order_cnt_type === 1) {\n        // delta_pic_order_always_zero_flag\n        reader.next();\n        // offset_for_non_ref_pic\n        reader.decodeExponentialGolombNumber();\n        // offset_for_top_to_bottom_field\n        reader.decodeExponentialGolombNumber();\n        const num_ref_frames_in_pic_order_cnt_cycle =\n            reader.decodeExponentialGolombNumber();\n        const offset_for_ref_frame: number[] = [];\n        for (let i = 0; i < num_ref_frames_in_pic_order_cnt_cycle; i += 1) {\n            offset_for_ref_frame[i] = reader.decodeExponentialGolombNumber();\n        }\n    }\n\n    // max_num_ref_frames\n    reader.decodeExponentialGolombNumber();\n    // gaps_in_frame_num_value_allowed_flag\n    reader.next();\n    const pic_width_in_mbs_minus1 = reader.decodeExponentialGolombNumber();\n    const pic_height_in_map_units_minus1 =\n        reader.decodeExponentialGolombNumber();\n\n    const frame_mbs_only_flag = reader.next();\n    if (!frame_mbs_only_flag) {\n        // mb_adaptive_frame_field_flag\n        reader.next();\n    }\n\n    // direct_8x8_inference_flag\n    reader.next();\n\n    const frame_cropping_flag = !!reader.next();\n    let frame_crop_left_offset: number;\n    let frame_crop_right_offset: number;\n    let frame_crop_top_offset: number;\n    let frame_crop_bottom_offset: number;\n    if (frame_cropping_flag) {\n        frame_crop_left_offset = reader.decodeExponentialGolombNumber();\n        frame_crop_right_offset = reader.decodeExponentialGolombNumber();\n        frame_crop_top_offset = reader.decodeExponentialGolombNumber();\n        frame_crop_bottom_offset = reader.decodeExponentialGolombNumber();\n    } else {\n        frame_crop_left_offset = 0;\n        frame_crop_right_offset = 0;\n        frame_crop_top_offset = 0;\n        frame_crop_bottom_offset = 0;\n    }\n\n    const vui_parameters_present_flag = !!reader.next();\n    if (vui_parameters_present_flag) {\n        // TODO\n        // vui_parameters( )\n    }\n\n    return {\n        profile_idc,\n        constraint_set,\n        constraint_set0_flag,\n        constraint_set1_flag,\n        constraint_set2_flag,\n        constraint_set3_flag,\n        constraint_set4_flag,\n        constraint_set5_flag,\n        level_idc,\n        seq_parameter_set_id,\n        pic_width_in_mbs_minus1,\n        pic_height_in_map_units_minus1,\n        frame_mbs_only_flag,\n        frame_cropping_flag,\n        frame_crop_left_offset,\n        frame_crop_right_offset,\n        frame_crop_top_offset,\n        frame_crop_bottom_offset,\n    };\n}\n\n/**\n * Find Sequence Parameter Set (SPS) and Picture Parameter Set (PPS)\n * from H.264 Annex B formatted data.\n */\nexport function h264SearchConfiguration(buffer: Uint8Array) {\n    let sequenceParameterSet: Uint8Array | undefined;\n    let pictureParameterSet: Uint8Array | undefined;\n\n    for (const nalu of annexBSplitNalu(buffer)) {\n        const naluType = nalu[0]! & 0x1f;\n        switch (naluType) {\n            case 7: // Sequence parameter set\n                sequenceParameterSet = nalu;\n                if (pictureParameterSet) {\n                    return {\n                        sequenceParameterSet,\n                        pictureParameterSet,\n                    };\n                }\n                break;\n            case 8: // Picture parameter set\n                pictureParameterSet = nalu;\n                if (sequenceParameterSet) {\n                    return {\n                        sequenceParameterSet,\n                        pictureParameterSet,\n                    };\n                }\n                break;\n            default:\n                // ignore\n                break;\n        }\n    }\n\n    throw new Error(\"Invalid data\");\n}\n\nexport interface H264Configuration {\n    pictureParameterSet: Uint8Array;\n    sequenceParameterSet: Uint8Array;\n\n    profileIndex: number;\n    constraintSet: number;\n    levelIndex: number;\n\n    encodedWidth: number;\n    encodedHeight: number;\n\n    cropLeft: number;\n    cropRight: number;\n    cropTop: number;\n    cropBottom: number;\n    croppedWidth: number;\n    croppedHeight: number;\n}\n\nexport function h264ParseConfiguration(data: Uint8Array): H264Configuration {\n    const { sequenceParameterSet, pictureParameterSet } =\n        h264SearchConfiguration(data);\n\n    const {\n        profile_idc: profileIndex,\n        constraint_set: constraintSet,\n        level_idc: levelIndex,\n        pic_width_in_mbs_minus1,\n        pic_height_in_map_units_minus1,\n        frame_mbs_only_flag,\n        frame_crop_left_offset,\n        frame_crop_right_offset,\n        frame_crop_top_offset,\n        frame_crop_bottom_offset,\n    } = h264ParseSequenceParameterSet(sequenceParameterSet);\n\n    const encodedWidth = (pic_width_in_mbs_minus1 + 1) * 16;\n    const encodedHeight =\n        (pic_height_in_map_units_minus1 + 1) * (2 - frame_mbs_only_flag) * 16;\n    const cropLeft = frame_crop_left_offset * 2;\n    const cropRight = frame_crop_right_offset * 2;\n    const cropTop = frame_crop_top_offset * 2;\n    const cropBottom = frame_crop_bottom_offset * 2;\n\n    const croppedWidth = encodedWidth - cropLeft - cropRight;\n    const croppedHeight = encodedHeight - cropTop - cropBottom;\n\n    return {\n        pictureParameterSet,\n        sequenceParameterSet,\n        profileIndex,\n        constraintSet,\n        levelIndex,\n        encodedWidth,\n        encodedHeight,\n        cropLeft,\n        cropRight,\n        cropTop,\n        cropBottom,\n        croppedWidth,\n        croppedHeight,\n    };\n}\n","// cspell: ignore golomb\n// cspell: ignore qpprime\n// cspell: ignore colour\n// cspell: ignore inbld\n// cspell: ignore Coef\n// cspell: ignore coeffs\n// cspell: ignore Pocs\n// cspell: ignore overscan\n// cspell: ignore disp\n// cspell: ignore bitstream\n// cspell: ignore scal\n// cspell: ignore ivmc\n// cspell: ignore dbbp\n// cspell: ignore texmc\n// cspell: ignore rbsp\n// cspell: ignore cprms\n\nimport { NaluSodbBitReader, annexBSplitNalu } from \"./nalu.js\";\n\nexport enum AndroidHevcProfile {\n    Main = 1 << 0,\n    Main10 = 1 << 1,\n    MainStill = 1 << 2,\n    Main10Hdr10 = 1 << 12,\n    Main10Hdr10Plus = 1 << 13,\n}\n\nexport enum AndroidHevcLevel {\n    MainTierLevel1 = 1 << 0,\n    HighTierLevel1 = 1 << 1,\n    MainTierLevel2 = 1 << 2,\n    HighTierLevel2 = 1 << 3,\n    MainTierLevel21 = 1 << 4,\n    HighTierLevel21 = 1 << 5,\n    MainTierLevel3 = 1 << 6,\n    HighTierLevel3 = 1 << 7,\n    MainTierLevel31 = 1 << 8,\n    HighTierLevel31 = 1 << 9,\n    MainTierLevel4 = 1 << 10,\n    HighTierLevel4 = 1 << 11,\n    MainTierLevel41 = 1 << 12,\n    HighTierLevel41 = 1 << 13,\n    MainTierLevel5 = 1 << 14,\n    HighTierLevel5 = 1 << 15,\n    MainTierLevel51 = 1 << 16,\n    HighTierLevel51 = 1 << 17,\n    MainTierLevel52 = 1 << 18,\n    HighTierLevel52 = 1 << 19,\n    MainTierLevel6 = 1 << 20,\n    HighTierLevel6 = 1 << 21,\n    MainTierLevel61 = 1 << 22,\n    HighTierLevel61 = 1 << 23,\n    MainTierLevel62 = 1 << 24,\n    HighTierLevel62 = 1 << 25,\n}\n\n/**\n * 6.2 Source, decoded and output picture formats\n */\nexport function getSubWidthC(chroma_format_idc: number) {\n    switch (chroma_format_idc) {\n        case 0:\n        case 3:\n            return 1;\n        case 1:\n        case 2:\n            return 2;\n        default:\n            throw new Error(\"Invalid chroma_format_idc\");\n    }\n}\n\n/**\n * 6.2 Source, decoded and output picture formats\n */\nexport function getSubHeightC(chroma_format_idc: number) {\n    switch (chroma_format_idc) {\n        case 0:\n        case 2:\n        case 3:\n            return 1;\n        case 1:\n            return 2;\n        default:\n            throw new Error(\"Invalid chroma_format_idc\");\n    }\n}\n\n/**\n * 7.3.1.1 General NAL unit syntax\n */\nexport function h265ParseNaluHeader(nalu: Uint8Array) {\n    const reader = new NaluSodbBitReader(nalu);\n    if (reader.next() !== 0) {\n        throw new Error(\"Invalid NALU header\");\n    }\n\n    const nal_unit_type = reader.read(6);\n    const nuh_layer_id = reader.read(6);\n    const nuh_temporal_id_plus1 = reader.read(3);\n\n    return {\n        nal_unit_type,\n        nuh_layer_id,\n        nuh_temporal_id_plus1,\n    };\n}\n\nexport type H265NaluHeader = ReturnType<typeof h265ParseNaluHeader>;\n\nexport interface H265NaluRaw extends H265NaluHeader {\n    data: Uint8Array;\n    rbsp: Uint8Array;\n}\n\n/**\n * 7.3.2.1 Video parameter set RBSP syntax\n */\nexport function h265ParseVideoParameterSet(nalu: Uint8Array) {\n    const reader = new NaluSodbBitReader(nalu);\n\n    const vps_video_parameter_set_id = reader.read(4);\n    const vps_base_layer_internal_flag = !!reader.next();\n    const vps_base_layer_available_flag = !!reader.next();\n    const vps_max_layers_minus1 = reader.read(6);\n    const vps_max_sub_layers_minus1 = reader.read(3);\n    const vps_temporal_id_nesting_flag = !!reader.next();\n    reader.skip(16);\n\n    const profileTierLevel = h265ParseProfileTierLevel(\n        reader,\n        true,\n        vps_max_sub_layers_minus1,\n    );\n\n    const vps_sub_layer_ordering_info_present_flag = !!reader.next();\n    const vps_max_dec_pic_buffering_minus1: number[] = [];\n    const vps_max_num_reorder_pics: number[] = [];\n    const vps_max_latency_increase_plus1: number[] = [];\n    for (\n        let i = vps_sub_layer_ordering_info_present_flag\n            ? 0\n            : vps_max_sub_layers_minus1;\n        i <= vps_max_sub_layers_minus1;\n        i += 1\n    ) {\n        vps_max_dec_pic_buffering_minus1[i] =\n            reader.decodeExponentialGolombNumber();\n        vps_max_num_reorder_pics[i] = reader.decodeExponentialGolombNumber();\n        vps_max_latency_increase_plus1[i] =\n            reader.decodeExponentialGolombNumber();\n    }\n\n    const vps_max_layer_id = reader.read(6);\n    const vps_num_layer_sets_minus1 = reader.decodeExponentialGolombNumber();\n    const layer_id_included_flag: boolean[][] = [];\n    for (let i = 1; i <= vps_num_layer_sets_minus1; i += 1) {\n        layer_id_included_flag[i] = [];\n        for (let j = 0; j <= vps_max_layer_id; j += 1) {\n            layer_id_included_flag[i]![j] = !!reader.next();\n        }\n    }\n\n    const vps_timing_info_present_flag = !!reader.next();\n    let vps_num_units_in_tick: number | undefined;\n    let vps_time_scale: number | undefined;\n    let vps_poc_proportional_to_timing_flag: boolean | undefined;\n    let vps_num_ticks_poc_diff_one_minus1: number | undefined;\n    let vps_num_hrd_parameters: number | undefined;\n    let hrd_layer_set_idx: number[] | undefined;\n    let cprms_present_flag: boolean[] | undefined;\n    let hrdParameters: H265HrdParameters[] | undefined;\n    if (vps_timing_info_present_flag) {\n        vps_num_units_in_tick = reader.read(32);\n        vps_time_scale = reader.read(32);\n\n        vps_poc_proportional_to_timing_flag = !!reader.next();\n        if (vps_poc_proportional_to_timing_flag) {\n            vps_num_ticks_poc_diff_one_minus1 =\n                reader.decodeExponentialGolombNumber();\n        }\n\n        vps_num_hrd_parameters = reader.decodeExponentialGolombNumber();\n\n        hrd_layer_set_idx = [];\n        cprms_present_flag = [true];\n        hrdParameters = [];\n        for (let i = 0; i < vps_num_hrd_parameters; i += 1) {\n            hrd_layer_set_idx[i] = reader.decodeExponentialGolombNumber();\n            if (i > 0) {\n                cprms_present_flag[i] = !!reader.next();\n            }\n            hrdParameters[i] = h265ParseHrdParameters(\n                reader,\n                cprms_present_flag[i]!,\n                vps_max_sub_layers_minus1,\n            );\n        }\n    }\n\n    const vps_extension_flag = !!reader.next();\n\n    return {\n        vps_video_parameter_set_id,\n        vps_base_layer_internal_flag,\n        vps_base_layer_available_flag,\n        vps_max_layers_minus1,\n        vps_max_sub_layers_minus1,\n        vps_temporal_id_nesting_flag,\n        profileTierLevel,\n        vps_sub_layer_ordering_info_present_flag,\n        vps_max_dec_pic_buffering_minus1,\n        vps_max_num_reorder_pics,\n        vps_max_latency_increase_plus1,\n        vps_max_layer_id,\n        vps_num_layer_sets_minus1,\n        layer_id_included_flag,\n        vps_timing_info_present_flag,\n        vps_num_units_in_tick,\n        vps_time_scale,\n        vps_poc_proportional_to_timing_flag,\n        vps_num_ticks_poc_diff_one_minus1,\n        vps_num_hrd_parameters,\n        hrd_layer_set_idx,\n        cprms_present_flag,\n        hrdParameters,\n        vps_extension_flag,\n    };\n}\n\nexport type SubLayerHrdParameters = ReturnType<\n    typeof h265ParseSubLayerHrdParameters\n>;\n\n/**\n * 7.3.2.2.1 General sequence parameter set RBSP syntax\n */\nexport function h265ParseSequenceParameterSet(nalu: Uint8Array) {\n    const reader = new NaluSodbBitReader(nalu);\n\n    const sps_video_parameter_set_id = reader.read(4);\n    const sps_max_sub_layers_minus1 = reader.read(3);\n    const sps_temporal_id_nesting_flag = !!reader.next();\n\n    const profileTierLevel = h265ParseProfileTierLevel(\n        reader,\n        true,\n        sps_max_sub_layers_minus1,\n    );\n\n    const sps_seq_parameter_set_id = reader.decodeExponentialGolombNumber();\n    const chroma_format_idc = reader.decodeExponentialGolombNumber();\n    let separate_colour_plane_flag: boolean | undefined;\n    if (chroma_format_idc === 3) {\n        separate_colour_plane_flag = !!reader.next();\n    }\n\n    const pic_width_in_luma_samples = reader.decodeExponentialGolombNumber();\n    const pic_height_in_luma_samples = reader.decodeExponentialGolombNumber();\n\n    const conformance_window_flag = !!reader.next();\n    let conf_win_left_offset: number | undefined;\n    let conf_win_right_offset: number | undefined;\n    let conf_win_top_offset: number | undefined;\n    let conf_win_bottom_offset: number | undefined;\n    if (conformance_window_flag) {\n        conf_win_left_offset = reader.decodeExponentialGolombNumber();\n        conf_win_right_offset = reader.decodeExponentialGolombNumber();\n        conf_win_top_offset = reader.decodeExponentialGolombNumber();\n        conf_win_bottom_offset = reader.decodeExponentialGolombNumber();\n    }\n\n    const bit_depth_luma_minus8 = reader.decodeExponentialGolombNumber();\n    const bit_depth_chroma_minus8 = reader.decodeExponentialGolombNumber();\n    const log2_max_pic_order_cnt_lsb_minus4 =\n        reader.decodeExponentialGolombNumber();\n\n    let sps_max_dec_pic_buffering_minus1: number[] | undefined;\n    let sps_max_num_reorder_pics: number[] | undefined;\n    let sps_max_latency_increase_plus1: number[] | undefined;\n    const sps_sub_layer_ordering_info_present_flag = !!reader.next();\n    for (\n        let i = sps_sub_layer_ordering_info_present_flag\n            ? 0\n            : sps_max_sub_layers_minus1;\n        i <= sps_max_sub_layers_minus1;\n        i += 1\n    ) {\n        sps_max_dec_pic_buffering_minus1 = [];\n        sps_max_num_reorder_pics = [];\n        sps_max_latency_increase_plus1 = [];\n        for (let i = 0; i <= sps_max_sub_layers_minus1; i += 1) {\n            sps_max_dec_pic_buffering_minus1[i] =\n                reader.decodeExponentialGolombNumber();\n            sps_max_num_reorder_pics[i] =\n                reader.decodeExponentialGolombNumber();\n            sps_max_latency_increase_plus1[i] =\n                reader.decodeExponentialGolombNumber();\n        }\n    }\n\n    const log2_min_luma_coding_block_size_minus3 =\n        reader.decodeExponentialGolombNumber();\n    const log2_diff_max_min_luma_coding_block_size =\n        reader.decodeExponentialGolombNumber();\n    const log2_min_luma_transform_block_size_minus2 =\n        reader.decodeExponentialGolombNumber();\n    const log2_diff_max_min_luma_transform_block_size =\n        reader.decodeExponentialGolombNumber();\n    const max_transform_hierarchy_depth_inter =\n        reader.decodeExponentialGolombNumber();\n    const max_transform_hierarchy_depth_intra =\n        reader.decodeExponentialGolombNumber();\n\n    const scaling_list_enabled_flag = !!reader.next();\n    let sps_scaling_list_data_present_flag: boolean | undefined;\n    let scalingListData: number[][][] | undefined;\n    if (scaling_list_enabled_flag) {\n        sps_scaling_list_data_present_flag = !!reader.next();\n        if (sps_scaling_list_data_present_flag) {\n            scalingListData = h265ParseScalingListData(reader);\n        }\n    }\n\n    const amp_enabled_flag = !!reader.next();\n    const sample_adaptive_offset_enabled_flag = !!reader.next();\n    const pcm_enabled_flag = !!reader.next();\n    let pcm_sample_bit_depth_luma_minus1: number | undefined;\n    let pcm_sample_bit_depth_chroma_minus1: number | undefined;\n    let log2_min_pcm_luma_coding_block_size_minus3: number | undefined;\n    let log2_diff_max_min_pcm_luma_coding_block_size: number | undefined;\n    let pcm_loop_filter_disabled_flag: boolean | undefined;\n    if (pcm_enabled_flag) {\n        pcm_sample_bit_depth_luma_minus1 = reader.read(4);\n        pcm_sample_bit_depth_chroma_minus1 = reader.read(4);\n        log2_min_pcm_luma_coding_block_size_minus3 = reader.read(4);\n        log2_diff_max_min_pcm_luma_coding_block_size = reader.read(4);\n        pcm_loop_filter_disabled_flag = !!reader.next();\n    }\n\n    const num_short_term_ref_pic_sets = reader.decodeExponentialGolombNumber();\n    const shortTermRefPicSets: ShortTermReferencePictureSet[] = [];\n    for (let i = 0; i < num_short_term_ref_pic_sets; i += 1) {\n        shortTermRefPicSets[i] = h265ParseShortTermReferencePictureSet(\n            reader,\n            i,\n            num_short_term_ref_pic_sets,\n            shortTermRefPicSets,\n        );\n    }\n\n    const long_term_ref_pics_present_flag = !!reader.next();\n    let num_long_term_ref_pics_sps: number | undefined;\n    let lt_ref_pic_poc_lsb_sps: number[] | undefined;\n    let used_by_curr_pic_lt_sps_flag: boolean[] | undefined;\n    if (long_term_ref_pics_present_flag) {\n        num_long_term_ref_pics_sps = reader.decodeExponentialGolombNumber();\n        lt_ref_pic_poc_lsb_sps = [];\n        used_by_curr_pic_lt_sps_flag = [];\n        for (let i = 0; i < num_long_term_ref_pics_sps; i += 1) {\n            lt_ref_pic_poc_lsb_sps[i] = reader.read(\n                log2_max_pic_order_cnt_lsb_minus4 + 4,\n            );\n            used_by_curr_pic_lt_sps_flag[i] = !!reader.next();\n        }\n    }\n\n    const sps_temporal_mvp_enabled_flag = !!reader.next();\n    const strong_intra_smoothing_enabled_flag = !!reader.next();\n    const vui_parameters_present_flag = !!reader.next();\n    let vuiParameters: H265VuiParameters | undefined;\n    if (vui_parameters_present_flag) {\n        vuiParameters = h265ParseVuiParameters(reader);\n    }\n\n    const sps_extension_present_flag = !!reader.next();\n    let sps_range_extension_flag: boolean | undefined;\n    let sps_multilayer_extension_flag: boolean | undefined;\n    let sps_3d_extension_flag: boolean | undefined;\n    let sps_scc_extension_flag: boolean | undefined;\n    let sps_extension_4bits: number | undefined;\n    if (sps_extension_present_flag) {\n        sps_range_extension_flag = !!reader.next();\n        sps_multilayer_extension_flag = !!reader.next();\n        sps_3d_extension_flag = !!reader.next();\n        sps_scc_extension_flag = !!reader.next();\n        sps_extension_4bits = reader.read(4);\n    }\n\n    if (sps_range_extension_flag) {\n        throw new Error(\"Not implemented\");\n    }\n\n    let spsMultilayerExtension: H265SpsMultilayerExtension | undefined;\n    if (sps_multilayer_extension_flag) {\n        spsMultilayerExtension = h265ParseSpsMultilayerExtension(reader);\n    }\n\n    let sps3dExtension: H265Sps3dExtension | undefined;\n    if (sps_3d_extension_flag) {\n        sps3dExtension = h265ParseSps3dExtension(reader);\n    }\n\n    if (sps_scc_extension_flag) {\n        throw new Error(\"Not implemented\");\n    }\n\n    let sps_extension_data_flag: boolean[] | undefined;\n    if (sps_extension_4bits) {\n        sps_extension_data_flag = [];\n        let i = 0;\n        while (!reader.ended) {\n            sps_extension_data_flag[i] = !!reader.next();\n            i += 1;\n        }\n    }\n\n    return {\n        sps_video_parameter_set_id,\n        sps_max_sub_layers_minus1,\n        sps_temporal_id_nesting_flag,\n        profileTierLevel,\n        sps_seq_parameter_set_id,\n        chroma_format_idc,\n        separate_colour_plane_flag,\n        pic_width_in_luma_samples,\n        pic_height_in_luma_samples,\n        conformance_window_flag,\n        conf_win_left_offset,\n        conf_win_right_offset,\n        conf_win_top_offset,\n        conf_win_bottom_offset,\n        bit_depth_luma_minus8,\n        bit_depth_chroma_minus8,\n        log2_max_pic_order_cnt_lsb_minus4,\n        sps_sub_layer_ordering_info_present_flag,\n        sps_max_dec_pic_buffering_minus1,\n        sps_max_num_reorder_pics,\n        sps_max_latency_increase_plus1,\n        log2_min_luma_coding_block_size_minus3,\n        log2_diff_max_min_luma_coding_block_size,\n        log2_min_luma_transform_block_size_minus2,\n        log2_diff_max_min_luma_transform_block_size,\n        max_transform_hierarchy_depth_inter,\n        max_transform_hierarchy_depth_intra,\n        scaling_list_enabled_flag,\n        sps_scaling_list_data_present_flag,\n        scalingListData,\n        amp_enabled_flag,\n        sample_adaptive_offset_enabled_flag,\n        pcm_enabled_flag,\n        pcm_sample_bit_depth_luma_minus1,\n        pcm_sample_bit_depth_chroma_minus1,\n        log2_min_pcm_luma_coding_block_size_minus3,\n        log2_diff_max_min_pcm_luma_coding_block_size,\n        pcm_loop_filter_disabled_flag,\n        num_short_term_ref_pic_sets,\n        shortTermRefPicSets,\n        long_term_ref_pics_present_flag,\n        num_long_term_ref_pics_sps,\n        lt_ref_pic_poc_lsb_sps,\n        used_by_curr_pic_lt_sps_flag,\n        sps_temporal_mvp_enabled_flag,\n        strong_intra_smoothing_enabled_flag,\n        vui_parameters_present_flag,\n        vuiParameters,\n        sps_extension_present_flag,\n        sps_range_extension_flag,\n        sps_multilayer_extension_flag,\n        sps_3d_extension_flag,\n        sps_scc_extension_flag,\n        sps_extension_4bits,\n        spsMultilayerExtension,\n        sps3dExtension,\n        sps_extension_data_flag,\n    };\n}\n\n/**\n * 7.3.3 Profile, tier and level syntax\n *\n * Common part between general_profile_tier_level and\n * sub_layer_profile_tier_level\n */\nfunction h265ParseProfileTier(reader: NaluSodbBitReader) {\n    const profile_space = reader.read(2);\n    const tier_flag = !!reader.next();\n    const profile_idc = reader.read(5);\n\n    const profileCompatibilitySet = reader.peekBytes(4);\n    const profile_compatibility_flag: boolean[] = [];\n    for (let j = 0; j < 32; j += 1) {\n        profile_compatibility_flag[j] = !!reader.next();\n    }\n\n    const constraintSet = reader.peekBytes(6);\n\n    const progressive_source_flag = !!reader.next();\n    const interlaced_source_flag = !!reader.next();\n    const non_packed_constraint_flag = !!reader.next();\n    const frame_only_constraint_flag = !!reader.next();\n\n    let max_12bit_constraint_flag: boolean | undefined;\n    let max_10bit_constraint_flag: boolean | undefined;\n    let max_8bit_constraint_flag: boolean | undefined;\n    let max_422chroma_constraint_flag: boolean | undefined;\n    let max_420chroma_constraint_flag: boolean | undefined;\n    let max_monochrome_constraint_flag: boolean | undefined;\n    let intra_constraint_flag: boolean | undefined;\n    let one_picture_only_constraint_flag: boolean | undefined;\n    let lower_bit_rate_constraint_flag: boolean | undefined;\n    let max_14bit_constraint_flag: boolean | undefined;\n    if (\n        profile_idc === 4 ||\n        profile_compatibility_flag[4] ||\n        profile_idc === 5 ||\n        profile_compatibility_flag[5] ||\n        profile_idc === 6 ||\n        profile_compatibility_flag[6] ||\n        profile_idc === 7 ||\n        profile_compatibility_flag[7] ||\n        profile_idc === 8 ||\n        profile_compatibility_flag[8] ||\n        profile_idc === 9 ||\n        profile_compatibility_flag[9] ||\n        profile_idc === 10 ||\n        profile_compatibility_flag[10] ||\n        profile_idc === 11 ||\n        profile_compatibility_flag[11]\n    ) {\n        max_12bit_constraint_flag = !!reader.next();\n        max_10bit_constraint_flag = !!reader.next();\n        max_8bit_constraint_flag = !!reader.next();\n        max_422chroma_constraint_flag = !!reader.next();\n        max_420chroma_constraint_flag = !!reader.next();\n        max_monochrome_constraint_flag = !!reader.next();\n        intra_constraint_flag = !!reader.next();\n        one_picture_only_constraint_flag = !!reader.next();\n        lower_bit_rate_constraint_flag = !!reader.next();\n        if (\n            profile_idc === 5 ||\n            profile_compatibility_flag[5] ||\n            profile_idc === 9 ||\n            profile_compatibility_flag[9] ||\n            profile_idc === 10 ||\n            profile_compatibility_flag[10] ||\n            profile_idc === 11 ||\n            profile_compatibility_flag[11]\n        ) {\n            max_14bit_constraint_flag = !!reader.next();\n            reader.skip(33);\n        } else {\n            reader.skip(34);\n        }\n    } else if (profile_idc === 2 || profile_compatibility_flag[2]) {\n        reader.skip(7);\n        one_picture_only_constraint_flag = !!reader.next();\n        reader.skip(35);\n    } else {\n        reader.skip(43);\n    }\n\n    let inbld_flag: boolean | undefined;\n    if (\n        profile_idc === 1 ||\n        profile_compatibility_flag[1] ||\n        profile_idc === 2 ||\n        profile_compatibility_flag[2] ||\n        profile_idc === 3 ||\n        profile_compatibility_flag[3] ||\n        profile_idc === 4 ||\n        profile_compatibility_flag[4] ||\n        profile_idc === 5 ||\n        profile_compatibility_flag[5] ||\n        profile_idc === 9 ||\n        profile_compatibility_flag[9] ||\n        profile_idc === 11 ||\n        profile_compatibility_flag[11]\n    ) {\n        inbld_flag = !!reader.next();\n    } else {\n        reader.skip(1);\n    }\n\n    return {\n        profile_space,\n        tier_flag,\n        profile_idc,\n        profileCompatibilitySet,\n        profile_compatibility_flag,\n        constraintSet,\n        progressive_source_flag,\n        interlaced_source_flag,\n        non_packed_constraint_flag,\n        frame_only_constraint_flag,\n        max_12bit_constraint_flag,\n        max_10bit_constraint_flag,\n        max_8bit_constraint_flag,\n        max_422chroma_constraint_flag,\n        max_420chroma_constraint_flag,\n        max_monochrome_constraint_flag,\n        intra_constraint_flag,\n        one_picture_only_constraint_flag,\n        lower_bit_rate_constraint_flag,\n        max_14bit_constraint_flag,\n        inbld_flag,\n    };\n}\n\nexport type H265ProfileTier = ReturnType<typeof h265ParseProfileTier>;\n\nexport interface H265ProfileTierLevel {\n    generalProfileTier: H265ProfileTier | undefined;\n    general_level_idc: number;\n    sub_layer_profile_present_flag: boolean[];\n    sub_layer_level_present_flag: boolean[];\n    subLayerProfileTier: H265ProfileTier[];\n    sub_layer_level_idc: number[];\n}\n\n/**\n * 7.3.3 Profile, tier and level syntax\n */\nfunction h265ParseProfileTierLevel(\n    reader: NaluSodbBitReader,\n    profilePresentFlag: true,\n    maxNumSubLayersMinus1: number,\n): H265ProfileTierLevel & { generalProfileTier: H265ProfileTier };\nfunction h265ParseProfileTierLevel(\n    reader: NaluSodbBitReader,\n    profilePresentFlag: false,\n    maxNumSubLayersMinus1: number,\n): H265ProfileTierLevel & { generalProfileTier: undefined };\nfunction h265ParseProfileTierLevel(\n    reader: NaluSodbBitReader,\n    profilePresentFlag: boolean,\n    maxNumSubLayersMinus1: number,\n): H265ProfileTierLevel;\nfunction h265ParseProfileTierLevel(\n    reader: NaluSodbBitReader,\n    profilePresentFlag: boolean,\n    maxNumSubLayersMinus1: number,\n): H265ProfileTierLevel {\n    let generalProfileTier: H265ProfileTier | undefined;\n    if (profilePresentFlag) {\n        generalProfileTier = h265ParseProfileTier(reader);\n    }\n\n    const general_level_idc = reader.read(8);\n\n    const sub_layer_profile_present_flag: boolean[] = [];\n    const sub_layer_level_present_flag: boolean[] = [];\n    for (let i = 0; i < maxNumSubLayersMinus1; i += 1) {\n        sub_layer_profile_present_flag[i] = !!reader.next();\n        sub_layer_level_present_flag[i] = !!reader.next();\n    }\n\n    if (maxNumSubLayersMinus1 > 0) {\n        for (let i = maxNumSubLayersMinus1; i < 8; i += 1) {\n            reader.read(2);\n        }\n    }\n\n    const subLayerProfileTier: H265ProfileTier[] = [];\n    const sub_layer_level_idc: number[] = [];\n    for (let i = 0; i < maxNumSubLayersMinus1; i += 1) {\n        if (sub_layer_profile_present_flag[i]) {\n            subLayerProfileTier[i] = h265ParseProfileTier(reader);\n        }\n        if (sub_layer_level_present_flag[i]) {\n            sub_layer_level_idc[i] = reader.read(8);\n        }\n    }\n\n    return {\n        generalProfileTier,\n        general_level_idc,\n        sub_layer_profile_present_flag,\n        sub_layer_level_present_flag,\n        subLayerProfileTier,\n        sub_layer_level_idc,\n    };\n}\n\n/**\n * 7.3.4 Scaling list data syntax\n */\nexport function h265ParseScalingListData(reader: NaluSodbBitReader) {\n    const scaling_list: number[][][] = [];\n    for (let sizeId = 0; sizeId < 4; sizeId += 1) {\n        scaling_list[sizeId] = [];\n        for (let matrixId = 0; matrixId < 6; matrixId += sizeId === 3 ? 3 : 1) {\n            const scaling_list_pred_mode_flag = !!reader.next();\n            if (!scaling_list_pred_mode_flag) {\n                reader.decodeExponentialGolombNumber();\n            } else {\n                let nextCoef = 8;\n                const coefNum = Math.min(64, 1 << (4 + (sizeId << 1)));\n                if (sizeId > 1) {\n                    const scaling_list_dc_coef_minus8 =\n                        reader.decodeExponentialGolombNumber();\n                    nextCoef = scaling_list_dc_coef_minus8 + 8;\n                }\n                scaling_list[sizeId]![matrixId] = [];\n                for (let i = 0; i < coefNum; i += 1) {\n                    const scaling_list_delta_coef =\n                        reader.decodeExponentialGolombNumber();\n                    nextCoef = (nextCoef + scaling_list_delta_coef + 256) % 256;\n                    scaling_list[sizeId]![matrixId]![i] = nextCoef;\n                }\n            }\n        }\n    }\n    return scaling_list;\n}\n\ninterface ShortTermReferencePictureSet {\n    stRpsIdx: number;\n    num_short_term_ref_pic_sets: number;\n\n    inter_ref_pic_set_prediction_flag: boolean;\n    delta_idx_minus1: number;\n    delta_rps_sign: boolean;\n    abs_delta_rps_minus1: number;\n    used_by_curr_pic_flag: boolean[];\n    use_delta_flag: boolean[];\n    num_negative_pics: number;\n    num_positive_pics: number;\n    delta_poc_s0_minus1: number[];\n    used_by_curr_pic_s0_flag: boolean[];\n    delta_poc_s1_minus1: number[];\n    used_by_curr_pic_s1_flag: boolean[];\n}\n\n/**\n * 7.3.7 Short-term reference picture set syntax\n */\nexport function h265ParseShortTermReferencePictureSet(\n    reader: NaluSodbBitReader,\n    stRpsIdx: number,\n    num_short_term_ref_pic_sets: number,\n    sets: ShortTermReferencePictureSet[],\n): ShortTermReferencePictureSet {\n    let inter_ref_pic_set_prediction_flag = false;\n    if (stRpsIdx !== 0) {\n        inter_ref_pic_set_prediction_flag = !!reader.next();\n    }\n    let delta_idx_minus1 = 0;\n    let delta_rps_sign = false;\n    let abs_delta_rps_minus1 = 0;\n    const used_by_curr_pic_flag: boolean[] = [];\n    const use_delta_flag: boolean[] = [];\n    let num_negative_pics = 0;\n    let num_positive_pics = 0;\n    const delta_poc_s0_minus1: number[] = [];\n    const used_by_curr_pic_s0_flag: boolean[] = [];\n    const delta_poc_s1_minus1: number[] = [];\n    const used_by_curr_pic_s1_flag: boolean[] = [];\n    if (inter_ref_pic_set_prediction_flag) {\n        if (stRpsIdx === num_short_term_ref_pic_sets) {\n            delta_idx_minus1 = reader.decodeExponentialGolombNumber();\n        }\n        delta_rps_sign = !!reader.next();\n        abs_delta_rps_minus1 = reader.decodeExponentialGolombNumber();\n        const RefRpsIdx = stRpsIdx - (delta_idx_minus1 + 1);\n        const RefRps = sets[RefRpsIdx]!;\n        const NumDeltaPocs_RefRpsIdx =\n            RefRps.num_negative_pics + RefRps.num_positive_pics;\n        for (let j = 0; j <= NumDeltaPocs_RefRpsIdx; j += 1) {\n            used_by_curr_pic_flag[j] = !!reader.next();\n            if (!used_by_curr_pic_flag[j]!) {\n                use_delta_flag[j] = !!reader.next();\n            } else {\n                use_delta_flag[j] = true;\n            }\n        }\n\n        const DeltaRps =\n            (1 - 2 * Number(delta_rps_sign)) * (abs_delta_rps_minus1 + 1);\n\n        const RefPocS0: number[] = [];\n        const RefPocS1: number[] = [];\n        const pocS0: number[] = [];\n        const pocS1: number[] = [];\n\n        let dPoc = 0;\n        for (let i = 0; i < RefRps.num_negative_pics; i += 1) {\n            dPoc -= RefRps.delta_poc_s0_minus1[i]! + 1;\n            RefPocS0[i] = dPoc;\n        }\n        dPoc = 0;\n        for (let i = 0; i < RefRps.num_positive_pics; i += 1) {\n            dPoc += RefRps.delta_poc_s1_minus1[i]! + 1;\n            RefPocS1[i] = dPoc;\n        }\n\n        let i = 0;\n        if (RefRps.num_positive_pics > 0) {\n            for (let j = RefRps.num_positive_pics - 1; j >= 0; j -= 1) {\n                dPoc = RefPocS1[j]! + DeltaRps;\n                if (dPoc < 0 && use_delta_flag[RefRps.num_negative_pics + j]) {\n                    pocS0[i] = dPoc;\n                    used_by_curr_pic_s0_flag[i] =\n                        used_by_curr_pic_flag[RefRps.num_negative_pics + j]!;\n                    i += 1;\n                }\n            }\n        }\n        if (DeltaRps < 0 && use_delta_flag[NumDeltaPocs_RefRpsIdx]) {\n            pocS0[i] = DeltaRps;\n            used_by_curr_pic_s0_flag[i] =\n                used_by_curr_pic_flag[NumDeltaPocs_RefRpsIdx]!;\n            i += 1;\n        }\n        for (let j = 0; j < RefRps.num_negative_pics; j += 1) {\n            dPoc = RefPocS0[j]! + DeltaRps;\n            if (dPoc < 0 && use_delta_flag[j]) {\n                pocS0[i] = dPoc;\n                used_by_curr_pic_s0_flag[i] = used_by_curr_pic_flag[j]!;\n                i += 1;\n            }\n        }\n\n        num_negative_pics = i;\n        let prev = 0;\n        for (i = 0; i < num_negative_pics; i += 1) {\n            const current = pocS0[i]!;\n            delta_poc_s0_minus1[i] = -(current - prev - 1);\n            prev = current;\n        }\n\n        i = 0;\n        if (RefRps.num_negative_pics > 0) {\n            for (let j = RefRps.num_negative_pics - 1; j >= 0; j -= 1) {\n                dPoc = RefPocS0[j]! + DeltaRps;\n                if (dPoc > 0 && use_delta_flag[j]) {\n                    pocS1[i] = dPoc;\n                    used_by_curr_pic_s1_flag[i] = used_by_curr_pic_flag[j]!;\n                    i += 1;\n                }\n            }\n        }\n        if (DeltaRps > 0 && use_delta_flag[NumDeltaPocs_RefRpsIdx]) {\n            pocS1[i] = DeltaRps;\n            used_by_curr_pic_s1_flag[i] =\n                used_by_curr_pic_flag[NumDeltaPocs_RefRpsIdx]!;\n            i += 1;\n        }\n        for (let j = 0; j < RefRps.num_positive_pics; j += 1) {\n            dPoc = RefPocS1[j]! + DeltaRps;\n            if (dPoc > 0 && use_delta_flag[RefRps.num_negative_pics + j]) {\n                pocS1[i] = dPoc;\n                used_by_curr_pic_s1_flag[i] =\n                    used_by_curr_pic_flag[RefRps.num_negative_pics + j]!;\n                i += 1;\n            }\n        }\n\n        num_positive_pics = i;\n        prev = 0;\n        for (i = 0; i < num_positive_pics; i += 1) {\n            const current = pocS1[i]!;\n            delta_poc_s1_minus1[i] = current - prev - 1;\n            prev = current;\n        }\n    } else {\n        num_negative_pics = reader.decodeExponentialGolombNumber();\n        num_positive_pics = reader.decodeExponentialGolombNumber();\n        for (let i = 0; i < num_negative_pics; i += 1) {\n            delta_poc_s0_minus1[i] = reader.decodeExponentialGolombNumber();\n            used_by_curr_pic_s0_flag[i] = !!reader.next();\n        }\n        for (let i = 0; i < num_positive_pics; i += 1) {\n            delta_poc_s1_minus1[i] = reader.decodeExponentialGolombNumber();\n            used_by_curr_pic_s1_flag[i] = !!reader.next();\n        }\n    }\n\n    return {\n        stRpsIdx,\n        num_short_term_ref_pic_sets,\n        inter_ref_pic_set_prediction_flag,\n        delta_idx_minus1,\n        delta_rps_sign,\n        abs_delta_rps_minus1,\n        used_by_curr_pic_flag,\n        use_delta_flag,\n        num_negative_pics,\n        num_positive_pics,\n        delta_poc_s0_minus1,\n        used_by_curr_pic_s0_flag,\n        delta_poc_s1_minus1,\n        used_by_curr_pic_s1_flag,\n    };\n}\n\n/**\n * E.2.1 VUI parameters syntax\n */\nexport function h265ParseVuiParameters(reader: NaluSodbBitReader) {\n    const aspect_ratio_info_present_flag = !!reader.next();\n    let aspect_ratio_idc: number | undefined;\n    let sar_width: number | undefined;\n    let sar_height: number | undefined;\n    if (aspect_ratio_info_present_flag) {\n        aspect_ratio_idc = reader.read(8);\n        if (aspect_ratio_idc === 255) {\n            sar_width = reader.read(16);\n            sar_height = reader.read(16);\n        }\n    }\n\n    const overscan_info_present_flag = !!reader.next();\n    let overscan_appropriate_flag: boolean | undefined;\n    if (overscan_info_present_flag) {\n        overscan_appropriate_flag = !!reader.next();\n    }\n\n    const video_signal_type_present_flag = !!reader.next();\n    let video_format: number | undefined;\n    let video_full_range_flag: boolean | undefined;\n    let colour_description_present_flag: boolean | undefined;\n    let colour_primaries: number | undefined;\n    let transfer_characteristics: number | undefined;\n    let matrix_coeffs: number | undefined;\n    if (video_signal_type_present_flag) {\n        video_format = reader.read(3);\n        video_full_range_flag = !!reader.next();\n        colour_description_present_flag = !!reader.next();\n        if (colour_description_present_flag) {\n            colour_primaries = reader.read(8);\n            transfer_characteristics = reader.read(8);\n            matrix_coeffs = reader.read(8);\n        }\n    }\n\n    const chroma_loc_info_present_flag = !!reader.next();\n    let chroma_sample_loc_type_top_field: number | undefined;\n    let chroma_sample_loc_type_bottom_field: number | undefined;\n    if (chroma_loc_info_present_flag) {\n        chroma_sample_loc_type_top_field =\n            reader.decodeExponentialGolombNumber();\n        chroma_sample_loc_type_bottom_field =\n            reader.decodeExponentialGolombNumber();\n    }\n\n    const neutral_chroma_indication_flag = !!reader.next();\n    const field_seq_flag = !!reader.next();\n    const frame_field_info_present_flag = !!reader.next();\n\n    const default_display_window_flag = !!reader.next();\n    let def_disp_win_left_offset: number | undefined;\n    let def_disp_win_right_offset: number | undefined;\n    let def_disp_win_top_offset: number | undefined;\n    let def_disp_win_bottom_offset: number | undefined;\n    if (default_display_window_flag) {\n        def_disp_win_left_offset = reader.decodeExponentialGolombNumber();\n        def_disp_win_right_offset = reader.decodeExponentialGolombNumber();\n        def_disp_win_top_offset = reader.decodeExponentialGolombNumber();\n        def_disp_win_bottom_offset = reader.decodeExponentialGolombNumber();\n    }\n\n    const vui_timing_info_present_flag = !!reader.next();\n    let vui_num_units_in_tick: number | undefined;\n    let vui_time_scale: number | undefined;\n    let vui_poc_proportional_to_timing_flag: boolean | undefined;\n    let vui_num_ticks_poc_diff_one_minus1: number | undefined;\n    let vui_hrd_parameters_present_flag: boolean | undefined;\n    if (vui_timing_info_present_flag) {\n        vui_num_units_in_tick = reader.read(32);\n        vui_time_scale = reader.read(32);\n        vui_poc_proportional_to_timing_flag = !!reader.next();\n        if (vui_poc_proportional_to_timing_flag) {\n            vui_num_ticks_poc_diff_one_minus1 =\n                reader.decodeExponentialGolombNumber();\n        }\n        vui_hrd_parameters_present_flag = !!reader.next();\n        if (vui_hrd_parameters_present_flag) {\n            throw new Error(\"Not implemented\");\n        }\n    }\n\n    const bitstream_restriction_flag = !!reader.next();\n    let tiles_fixed_structure_flag: boolean | undefined;\n    let motion_vectors_over_pic_boundaries_flag: boolean | undefined;\n    let restricted_ref_pic_lists_flag: boolean | undefined;\n    let min_spatial_segmentation_idc: number | undefined;\n    let max_bytes_per_pic_denom: number | undefined;\n    let max_bits_per_min_cu_denom: number | undefined;\n    let log2_max_mv_length_horizontal: number | undefined;\n    let log2_max_mv_length_vertical: number | undefined;\n    if (bitstream_restriction_flag) {\n        tiles_fixed_structure_flag = !!reader.next();\n        motion_vectors_over_pic_boundaries_flag = !!reader.next();\n        restricted_ref_pic_lists_flag = !!reader.next();\n        min_spatial_segmentation_idc = reader.decodeExponentialGolombNumber();\n        max_bytes_per_pic_denom = reader.decodeExponentialGolombNumber();\n        max_bits_per_min_cu_denom = reader.decodeExponentialGolombNumber();\n        log2_max_mv_length_horizontal = reader.decodeExponentialGolombNumber();\n        log2_max_mv_length_vertical = reader.decodeExponentialGolombNumber();\n    }\n\n    return {\n        aspect_ratio_info_present_flag,\n        aspect_ratio_idc,\n        sar_width,\n        sar_height,\n\n        overscan_info_present_flag,\n        overscan_appropriate_flag,\n\n        video_signal_type_present_flag,\n        video_format,\n        video_full_range_flag,\n        colour_description_present_flag,\n        colour_primaries,\n        transfer_characteristics,\n        matrix_coeffs,\n\n        chroma_loc_info_present_flag,\n        chroma_sample_loc_type_top_field,\n        chroma_sample_loc_type_bottom_field,\n\n        neutral_chroma_indication_flag,\n        field_seq_flag,\n        frame_field_info_present_flag,\n\n        default_display_window_flag,\n        def_disp_win_left_offset,\n        def_disp_win_right_offset,\n        def_disp_win_top_offset,\n        def_disp_win_bottom_offset,\n\n        vui_timing_info_present_flag,\n        vui_num_units_in_tick,\n        vui_time_scale,\n        vui_poc_proportional_to_timing_flag,\n        vui_num_ticks_poc_diff_one_minus1,\n        vui_hrd_parameters_present_flag,\n\n        bitstream_restriction_flag,\n        tiles_fixed_structure_flag,\n        motion_vectors_over_pic_boundaries_flag,\n        restricted_ref_pic_lists_flag,\n        min_spatial_segmentation_idc,\n        max_bytes_per_pic_denom,\n        max_bits_per_min_cu_denom,\n        log2_max_mv_length_horizontal,\n        log2_max_mv_length_vertical,\n    };\n}\n\nexport type H265VuiParameters = ReturnType<typeof h265ParseVuiParameters>;\n\n/**\n * E.2.2 HRD parameters syntax\n */\nexport function h265ParseHrdParameters(\n    reader: NaluSodbBitReader,\n    commonInfPresentFlag: boolean,\n    maxNumSubLayersMinus1: number,\n) {\n    let nal_hrd_parameters_present_flag: boolean | undefined;\n    let vcl_hrd_parameters_present_flag: boolean | undefined;\n    let sub_pic_hrd_params_present_flag: boolean | undefined;\n    let tick_divisor_minus2: number | undefined;\n    let du_cpb_removal_delay_increment_length_minus1: number | undefined;\n    let sub_pic_cpb_params_in_pic_timing_sei_flag: boolean | undefined;\n    let dpb_output_delay_du_length_minus1: number | undefined;\n    let bit_rate_scale: number | undefined;\n    let cpb_size_scale: number | undefined;\n    let cpb_size_du_scale: number | undefined;\n    let initial_cpb_removal_delay_length_minus1: number | undefined;\n    let au_cpb_removal_delay_length_minus1: number | undefined;\n    let dpb_output_delay_length_minus1: number | undefined;\n    if (commonInfPresentFlag) {\n        nal_hrd_parameters_present_flag = !!reader.next();\n        vcl_hrd_parameters_present_flag = !!reader.next();\n        if (\n            nal_hrd_parameters_present_flag ||\n            vcl_hrd_parameters_present_flag\n        ) {\n            sub_pic_hrd_params_present_flag = !!reader.next();\n            if (sub_pic_hrd_params_present_flag) {\n                tick_divisor_minus2 = reader.read(8);\n                du_cpb_removal_delay_increment_length_minus1 = reader.read(5);\n                sub_pic_cpb_params_in_pic_timing_sei_flag = !!reader.next();\n                dpb_output_delay_du_length_minus1 = reader.read(5);\n            }\n            bit_rate_scale = reader.read(4);\n            cpb_size_scale = reader.read(4);\n            if (sub_pic_hrd_params_present_flag) {\n                cpb_size_du_scale = reader.read(4);\n            }\n            initial_cpb_removal_delay_length_minus1 = reader.read(5);\n            au_cpb_removal_delay_length_minus1 = reader.read(5);\n            dpb_output_delay_length_minus1 = reader.read(5);\n        }\n    }\n\n    const fixed_pic_rate_general_flag: boolean[] = [];\n    const fixed_pic_rate_within_cvs_flag: boolean[] = [];\n    const elemental_duration_in_tc_minus1: number[] = [];\n    const low_delay_hrd_flag: boolean[] = [];\n    const cpb_cnt_minus1: number[] = [];\n    const nalHrdParameters: SubLayerHrdParameters[] = [];\n    const vclHrdParameters: SubLayerHrdParameters[] = [];\n    for (let i = 0; i <= maxNumSubLayersMinus1; i += 1) {\n        fixed_pic_rate_general_flag[i] = !!reader.next();\n        if (!fixed_pic_rate_general_flag[i]) {\n            fixed_pic_rate_within_cvs_flag[i] = !!reader.next();\n        }\n        if (fixed_pic_rate_within_cvs_flag[i]) {\n            elemental_duration_in_tc_minus1[i] =\n                reader.decodeExponentialGolombNumber();\n        } else {\n            low_delay_hrd_flag[i] = !!reader.next();\n        }\n\n        if (!low_delay_hrd_flag[i]) {\n            cpb_cnt_minus1[i] = reader.decodeExponentialGolombNumber();\n        }\n\n        if (nal_hrd_parameters_present_flag) {\n            nalHrdParameters[i] = h265ParseSubLayerHrdParameters(\n                reader,\n                i,\n                getCpbCnt(cpb_cnt_minus1[i]!),\n            );\n        }\n        if (vcl_hrd_parameters_present_flag) {\n            vclHrdParameters[i] = h265ParseSubLayerHrdParameters(\n                reader,\n                i,\n                getCpbCnt(cpb_cnt_minus1[i]!),\n            );\n        }\n    }\n\n    return {\n        nal_hrd_parameters_present_flag,\n        vcl_hrd_parameters_present_flag,\n        sub_pic_hrd_params_present_flag,\n        tick_divisor_minus2,\n        du_cpb_removal_delay_increment_length_minus1,\n        sub_pic_cpb_params_in_pic_timing_sei_flag,\n        dpb_output_delay_du_length_minus1,\n        bit_rate_scale,\n        cpb_size_scale,\n        cpb_size_du_scale,\n        initial_cpb_removal_delay_length_minus1,\n        au_cpb_removal_delay_length_minus1,\n        dpb_output_delay_length_minus1,\n        fixed_pic_rate_general_flag,\n        fixed_pic_rate_within_cvs_flag,\n        elemental_duration_in_tc_minus1,\n        low_delay_hrd_flag,\n        cpb_cnt_minus1,\n        nalHrdParameters,\n        vclHrdParameters,\n    };\n}\n\nexport type H265HrdParameters = ReturnType<typeof h265ParseHrdParameters>;\n\n/**\n * E.2.3 Sub-layer HRD parameters syntax\n */\nexport function h265ParseSubLayerHrdParameters(\n    reader: NaluSodbBitReader,\n    subLayerId: number,\n    CpbCnt: number,\n) {\n    const bit_rate_value_minus1: number[] = [];\n    const cpb_size_value_minus1: number[] = [];\n    const cpb_size_du_value_minus1: number[] = [];\n    const bit_rate_du_value_minus1: number[] = [];\n    const cbr_flag: boolean[] = [];\n    for (let i = 0; i < CpbCnt; i += 1) {\n        bit_rate_value_minus1[i] = reader.decodeExponentialGolombNumber();\n        cpb_size_value_minus1[i] = reader.decodeExponentialGolombNumber();\n        if (subLayerId > 0) {\n            cbr_flag[i] = !!reader.next();\n        }\n    }\n    return {\n        bit_rate_value_minus1,\n        cpb_size_value_minus1,\n        cpb_size_du_value_minus1,\n        bit_rate_du_value_minus1,\n        cbr_flag,\n    };\n}\n\n/**\n * E.3.3 Sub-layer HRD parameters semantics\n */\nfunction getCpbCnt(cpb_cnt_minus_1: number) {\n    return cpb_cnt_minus_1 + 1;\n}\n\nexport function h265SearchConfiguration(buffer: Uint8Array) {\n    let videoParameterSet!: H265NaluRaw;\n    let sequenceParameterSet!: H265NaluRaw;\n    let pictureParameterSet!: H265NaluRaw;\n    let count = 0;\n\n    for (const nalu of annexBSplitNalu(buffer)) {\n        const header = h265ParseNaluHeader(nalu);\n        const raw: H265NaluRaw = {\n            ...header,\n            data: nalu,\n            rbsp: nalu.subarray(2),\n        };\n        switch (header.nal_unit_type) {\n            case 32:\n                videoParameterSet = raw;\n                break;\n            case 33:\n                sequenceParameterSet = raw;\n                break;\n            case 34:\n                pictureParameterSet = raw;\n                break;\n            default:\n                continue;\n        }\n\n        count += 1;\n        if (count === 3) {\n            return {\n                videoParameterSet,\n                sequenceParameterSet,\n                pictureParameterSet,\n            };\n        }\n    }\n\n    throw new Error(\"Invalid data\");\n}\n\nexport function h265ParseSpsMultilayerExtension(reader: NaluSodbBitReader) {\n    const inter_view_mv_vert_constraint_flag = !!reader.next();\n    return {\n        inter_view_mv_vert_constraint_flag,\n    };\n}\n\nexport type H265SpsMultilayerExtension = ReturnType<\n    typeof h265ParseSpsMultilayerExtension\n>;\n\nexport function h265ParseSps3dExtension(reader: NaluSodbBitReader) {\n    const iv_di_mc_enabled_flag: boolean[] = [];\n    const iv_mv_scal_enabled_flag: boolean[] = [];\n\n    iv_di_mc_enabled_flag[0] = !!reader.next();\n    iv_mv_scal_enabled_flag[0] = !!reader.next();\n\n    const log2_ivmc_sub_pb_size_minus3 = reader.decodeExponentialGolombNumber();\n    const iv_res_pred_enabled_flag = !!reader.next();\n    const depth_ref_enabled_flag = !!reader.next();\n    const vsp_mc_enabled_flag = !!reader.next();\n    const dbbp_enabled_flag = !!reader.next();\n\n    iv_di_mc_enabled_flag[1] = !!reader.next();\n    iv_mv_scal_enabled_flag[1] = !!reader.next();\n\n    const tex_mc_enabled_flag = !!reader.next();\n    const log2_texmc_sub_pb_size_minus3 =\n        reader.decodeExponentialGolombNumber();\n    const intra_contour_enabled_flag = !!reader.next();\n    const intra_dc_only_wedge_enabled_flag = !!reader.next();\n    const cqt_cu_part_pred_enabled_flag = !!reader.next();\n    const inter_dc_only_enabled_flag = !!reader.next();\n    const skip_intra_enabled_flag = !!reader.next();\n\n    return {\n        iv_di_mc_enabled_flag,\n        iv_mv_scal_enabled_flag,\n        log2_ivmc_sub_pb_size_minus3,\n        iv_res_pred_enabled_flag,\n        depth_ref_enabled_flag,\n        vsp_mc_enabled_flag,\n        dbbp_enabled_flag,\n        tex_mc_enabled_flag,\n        log2_texmc_sub_pb_size_minus3,\n        intra_contour_enabled_flag,\n        intra_dc_only_wedge_enabled_flag,\n        cqt_cu_part_pred_enabled_flag,\n        inter_dc_only_enabled_flag,\n        skip_intra_enabled_flag,\n    };\n}\n\nexport type H265Sps3dExtension = ReturnType<typeof h265ParseSps3dExtension>;\n\nexport interface H265Configuration {\n    videoParameterSet: H265NaluRaw;\n    sequenceParameterSet: H265NaluRaw;\n    pictureParameterSet: H265NaluRaw;\n\n    generalProfileSpace: number;\n    generalProfileIndex: number;\n    generalProfileCompatibilitySet: Uint8Array;\n    generalTierFlag: boolean;\n    generalLevelIndex: number;\n    generalConstraintSet: Uint8Array;\n\n    encodedWidth: number;\n    encodedHeight: number;\n\n    cropLeft: number;\n    cropRight: number;\n    cropTop: number;\n    cropBottom: number;\n    croppedWidth: number;\n    croppedHeight: number;\n}\n\nexport function h265ParseConfiguration(data: Uint8Array): H265Configuration {\n    const { videoParameterSet, sequenceParameterSet, pictureParameterSet } =\n        h265SearchConfiguration(data);\n\n    const {\n        profileTierLevel: {\n            generalProfileTier: {\n                profile_space: generalProfileSpace,\n                tier_flag: generalTierFlag,\n                profile_idc: generalProfileIndex,\n                profileCompatibilitySet: generalProfileCompatibilitySet,\n                constraintSet: generalConstraintSet,\n            },\n            general_level_idc: generalLevelIndex,\n        },\n    } = h265ParseVideoParameterSet(videoParameterSet.rbsp);\n\n    const {\n        chroma_format_idc,\n        pic_width_in_luma_samples: encodedWidth,\n        pic_height_in_luma_samples: encodedHeight,\n        conf_win_left_offset: cropLeft = 0,\n        conf_win_right_offset: cropRight = 0,\n        conf_win_top_offset: cropTop = 0,\n        conf_win_bottom_offset: cropBottom = 0,\n    } = h265ParseSequenceParameterSet(sequenceParameterSet.rbsp);\n\n    const SubWidthC = getSubWidthC(chroma_format_idc);\n    const SubHeightC = getSubHeightC(chroma_format_idc);\n\n    const croppedWidth = encodedWidth - SubWidthC * (cropLeft + cropRight);\n    const croppedHeight = encodedHeight - SubHeightC * (cropTop + cropBottom);\n\n    return {\n        videoParameterSet,\n        sequenceParameterSet,\n        pictureParameterSet,\n\n        generalProfileSpace,\n        generalProfileIndex,\n        generalProfileCompatibilitySet,\n        generalTierFlag,\n        generalLevelIndex,\n        generalConstraintSet,\n\n        encodedWidth,\n        encodedHeight,\n        cropLeft,\n        cropRight,\n        cropTop,\n        cropBottom,\n        croppedWidth,\n        croppedHeight,\n    };\n}\n","export * from \"./av1.js\";\nexport * from \"./h264.js\";\nexport * from \"./h265.js\";\nexport * from \"./nalu.js\";\n","import { Struct } from \"@yume-chan/struct\";\n\nexport const BasicControlMessage = new Struct().uint8(\"type\");\n","import type { ScrcpyInjectTouchControlMessage2_0 } from \"../options/index.js\";\n\n// https://developer.android.com/reference/android/view/MotionEvent#constants_1\nexport enum AndroidMotionEventAction {\n    Down,\n    Up,\n    Move,\n    Cancel,\n    Outside,\n    PointerDown,\n    PointerUp,\n    HoverMove,\n    Scroll,\n    HoverEnter,\n    HoverExit,\n    ButtonPress,\n    ButtonRelease,\n}\n\nexport enum AndroidMotionEventButton {\n    Primary = 0x01,\n    Secondary = 0x02,\n    Tertiary = 0x04,\n    Back = 0x08,\n    Forward = 0x10,\n    StylusPrimary = 0x20,\n    StylusSecondary = 0x40,\n}\n\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport namespace ScrcpyPointerId {\n    export const Mouse = -1n;\n    export const Finger = -2n;\n    export const VirtualMouse = -3n;\n    export const VirtualFinger = -4n;\n}\n\nexport type ScrcpyInjectTouchControlMessage =\n    ScrcpyInjectTouchControlMessage2_0;\n","// https://github.com/Genymobile/scrcpy/blob/fa5b2a29e983a46b49531def9cf3d80c40c3de37/app/src/control_msg.h#L23\n// For their message bodies, see https://github.com/Genymobile/scrcpy/blob/5c62f3419d252d10cd8c9cbb7c918b358b81f2d0/app/src/control_msg.c#L92\n\nimport type { ScrcpyOptions } from \"../options/index.js\";\n\n// Their IDs change between versions, so always use `options.getControlMessageTypes()`\nexport enum ScrcpyControlMessageType {\n    InjectKeyCode,\n    InjectText,\n    InjectTouch,\n    InjectScroll,\n    BackOrScreenOn,\n    ExpandNotificationPanel,\n    ExpandSettingPanel,\n    CollapseNotificationPanel,\n    GetClipboard,\n    SetClipboard,\n    SetScreenPowerMode,\n    RotateDevice,\n}\n\n/**\n * Scrcpy control message types have different values between versions.\n *\n * This class provides a way to get the actual value for a given type.\n */\nexport class ScrcpyControlMessageTypeValue {\n    #types: readonly ScrcpyControlMessageType[];\n\n    constructor(options: ScrcpyOptions<object>) {\n        this.#types = options.controlMessageTypes;\n    }\n\n    get(type: ScrcpyControlMessageType): number {\n        const value = this.#types.indexOf(type);\n        if (value === -1) {\n            throw new Error(\"Not supported\");\n        }\n        return value;\n    }\n\n    fillMessageType<T extends { type: ScrcpyControlMessageType }>(\n        message: Omit<T, \"type\">,\n        type: T[\"type\"],\n    ): T {\n        (message as T).type = this.get(type);\n        return message as T;\n    }\n}\n","import type { ScrcpyInjectTouchControlMessage } from \"./inject-touch.js\";\nimport { AndroidMotionEventAction } from \"./inject-touch.js\";\nimport { ScrcpyControlMessageType } from \"./type.js\";\n\n/**\n * On both Android and Windows, while both mouse and touch are supported input devices,\n * only one of them can be active at a time. Touch the screen with a finger will deactivate mouse,\n * and move the mouse will deactivate touch.\n *\n * On Android, this is achieved by dispatching a `MotionEvent.ACTION_UP` event for the previous input type.\n * But on Chrome, there is no such event, causing both mouse and touch to be active at the same time.\n * This can cause the new input to appear as \"ignored\".\n *\n * This helper class synthesis `ACTION_UP` events when a different pointer type appears,\n * so Scrcpy server can remove the previously hovering pointer.\n */\nexport class ScrcpyHoverHelper {\n    // There can be only one hovering pointer (either mouse or pen,\n    // touch can have multiple pointers but no hovering state).\n    #lastHoverMessage: ScrcpyInjectTouchControlMessage | undefined;\n\n    process(\n        message: Omit<ScrcpyInjectTouchControlMessage, \"type\">,\n    ): ScrcpyInjectTouchControlMessage[] {\n        const result: ScrcpyInjectTouchControlMessage[] = [];\n\n        // A different pointer appeared,\n        // Cancel previously hovering pointer so Scrcpy server can free up the pointer ID.\n        if (\n            this.#lastHoverMessage &&\n            this.#lastHoverMessage.pointerId !== message.pointerId\n        ) {\n            // TODO: Inject MotionEvent.ACTION_HOVER_EXIT\n            // From testing, it seems no App cares about this event.\n            result.push({\n                ...this.#lastHoverMessage,\n                action: AndroidMotionEventAction.Up,\n            });\n            this.#lastHoverMessage = undefined;\n        }\n\n        if (message.action === AndroidMotionEventAction.HoverMove) {\n            // TODO: Inject MotionEvent.ACTION_HOVER_ENTER\n            this.#lastHoverMessage = message as ScrcpyInjectTouchControlMessage;\n        }\n\n        (message as ScrcpyInjectTouchControlMessage).type =\n            ScrcpyControlMessageType.InjectTouch;\n        result.push(message as ScrcpyInjectTouchControlMessage);\n\n        return result;\n    }\n}\n","import Struct, { placeholder } from \"@yume-chan/struct\";\n\nexport enum AndroidKeyEventAction {\n    Down = 0,\n    Up = 1,\n}\n\n// https://cs.android.com/android/platform/superproject/+/master:frameworks/base/core/java/android/view/KeyEvent.java;l=993;drc=95c1165bb895dd844e1793460710f7163dd330a3\nexport enum AndroidKeyEventMeta {\n    AltOn = 0x02,\n    AltLeftOn = 0x10,\n    AltRightOn = 0x20,\n    ShiftOn = 0x01,\n    ShiftLeftOn = 0x40,\n    ShiftRightOn = 0x80,\n    CtrlOn = 0x1000,\n    CtrlLeftOn = 0x2000,\n    CtrlRightOn = 0x4000,\n    MetaOn = 0x10000,\n    MetaLeftOn = 0x20000,\n    MetaRightOn = 0x40000,\n    CapsLockOn = 0x100000,\n    NumLockOn = 0x200000,\n    ScrollLockOn = 0x400000,\n}\n\n// https://cs.android.com/android/platform/superproject/+/master:frameworks/base/core/java/android/view/KeyEvent.java;l=97;drc=95c1165bb895dd844e1793460710f7163dd330a3\n// Most names follow Web API `KeyboardEvent.code`,\n// Android-only (not exist in HID keyboard standard) keys are prefixed by `Android`.\nexport enum AndroidKeyCode {\n    AndroidHome = 3,\n    AndroidBack = 4,\n    AndroidCall,\n    AndroidEndCall,\n\n    Digit0,\n    Digit1,\n    Digit2,\n    Digit3,\n    Digit4,\n    Digit5,\n    Digit6,\n    Digit7,\n    Digit8,\n    Digit9,\n    /**\n     * '*' key.\n     */\n    Star, // Name not verified\n    /**\n     * '#' key.\n     */\n    Pound, // Name not verified\n\n    /**\n     * Directional Pad Up key.\n     */\n    ArrowUp,\n    /**\n     * Directional Pad Down key.\n     */\n    ArrowDown,\n    /**\n     * Directional Pad Left key.\n     */\n    ArrowLeft,\n    /**\n     * Directional Pad Right key.\n     */\n    ArrowRight,\n    /**\n     * Directional Pad Center key.\n     */\n    AndroidDPadCenter,\n\n    VolumeUp, // Name not verified\n    VolumeDown, // Name not verified\n    Power, // Name not verified\n    AndroidCamera,\n    Clear, // Name not verified\n\n    KeyA,\n    KeyB,\n    KeyC,\n    KeyD,\n    KeyE,\n    KeyF,\n    KeyG,\n    KeyH,\n    KeyI,\n    KeyJ,\n    KeyK,\n    KeyL,\n    KeyM,\n    KeyN,\n    KeyO,\n    KeyP,\n    KeyQ,\n    KeyR,\n    KeyS,\n    KeyT,\n    KeyU,\n    KeyV,\n    KeyW,\n    KeyX,\n    KeyY,\n    KeyZ,\n    Comma,\n    Period,\n    AltLeft,\n    AltRight,\n    ShiftLeft,\n    ShiftRight,\n    Tab,\n    Space,\n    AndroidSymbol,\n    AndroidExplorer,\n    AndroidEnvelope,\n    Enter,\n    Backspace,\n    Backquote,\n    Minus,\n    Equal,\n    BracketLeft,\n    BracketRight,\n    Backslash,\n    Semicolon,\n    Quote,\n    Slash,\n    At, // Name not verified\n\n    AndroidNum,\n    AndroidHeadsetHook,\n    /**\n     * Camera Focus key\n     */\n    AndroidFocus,\n\n    Plus, // Name not verified\n    ContextMenu,\n    AndroidNotification,\n    AndroidSearch,\n\n    PageUp = 92,\n    PageDown,\n\n    Escape = 111,\n    Delete,\n    ControlLeft,\n    ControlRight,\n    CapsLock,\n    ScrollLock,\n    MetaLeft,\n    MetaRight,\n    AndroidFunction,\n    PrintScreen,\n    Pause,\n\n    Home,\n    End,\n    Insert,\n    AndroidForward,\n\n    F1 = 131,\n    F2,\n    F3,\n    F4,\n    F5,\n    F6,\n    F7,\n    F8,\n    F9,\n    F10,\n    F11,\n    F12,\n\n    NumLock,\n    Numpad0,\n    Numpad1,\n    Numpad2,\n    Numpad3,\n    Numpad4,\n    Numpad5,\n    Numpad6,\n    Numpad7,\n    Numpad8,\n    Numpad9,\n    NumpadDivide,\n    NumpadMultiply,\n    NumpadSubtract,\n    NumpadAdd,\n    NumpadDecimal,\n    NumpadComma, // Name not verified\n    NumpadEnter,\n    NumpadEquals, // Name not verified\n    NumpadLeftParen, // Name not verified\n    NumpadRightParen, // Name not verified\n\n    VolumeMute = 164, // Name not verified\n    AndroidAppSwitch = 187,\n\n    AndroidCut = 277,\n    AndroidCopy,\n    AndroidPaste,\n}\n\nexport const ScrcpyInjectKeyCodeControlMessage = new Struct()\n    .uint8(\"type\")\n    .uint8(\"action\", placeholder<AndroidKeyEventAction>())\n    .uint32(\"keyCode\")\n    .uint32(\"repeat\")\n    .uint32(\"metaState\");\n\nexport type ScrcpyInjectKeyCodeControlMessage =\n    (typeof ScrcpyInjectKeyCodeControlMessage)[\"TInit\"];\n","import Struct from \"@yume-chan/struct\";\n\nexport const ScrcpyInjectTextControlMessage = new Struct()\n    .uint8(\"type\")\n    .uint32(\"length\")\n    .string(\"text\", { lengthField: \"length\" });\n\nexport type ScrcpyInjectTextControlMessage =\n    (typeof ScrcpyInjectTextControlMessage)[\"TInit\"];\n","import { BasicControlMessage } from \"./basic.js\";\n\nexport const ScrcpyRotateDeviceControlMessage = BasicControlMessage;\n\nexport type ScrcpyRotateDeviceControlMessage =\n    (typeof ScrcpyRotateDeviceControlMessage)[\"TInit\"];\n","import Struct, { placeholder } from \"@yume-chan/struct\";\n\n// https://cs.android.com/android/platform/superproject/+/master:frameworks/base/core/java/android/view/SurfaceControl.java;l=659;drc=20303e05bf73796124ab70a279cf849b61b97905\nexport enum AndroidScreenPowerMode {\n    Off = 0,\n    Normal = 2,\n}\n\nexport const ScrcpySetScreenPowerModeControlMessage = new Struct()\n    .uint8(\"type\")\n    .uint8(\"mode\", placeholder<AndroidScreenPowerMode>());\n\nexport type ScrcpySetScreenPowerModeControlMessage =\n    (typeof ScrcpySetScreenPowerModeControlMessage)[\"TInit\"];\n","import type {\n    ScrcpyOptions,\n    ScrcpyScrollController,\n} from \"../options/index.js\";\n\nimport type { AndroidKeyEventAction } from \"./inject-keycode.js\";\nimport { ScrcpyInjectKeyCodeControlMessage } from \"./inject-keycode.js\";\nimport type { ScrcpyInjectScrollControlMessage } from \"./inject-scroll.js\";\nimport { ScrcpyInjectTextControlMessage } from \"./inject-text.js\";\nimport type { ScrcpyInjectTouchControlMessage } from \"./inject-touch.js\";\nimport { ScrcpyRotateDeviceControlMessage } from \"./rotate-device.js\";\nimport type { AndroidScreenPowerMode } from \"./set-screen-power-mode.js\";\nimport { ScrcpySetScreenPowerModeControlMessage } from \"./set-screen-power-mode.js\";\nimport {\n    ScrcpyControlMessageType,\n    ScrcpyControlMessageTypeValue,\n} from \"./type.js\";\n\nexport class ScrcpyControlMessageSerializer {\n    #options: ScrcpyOptions<object>;\n    #typeValues: ScrcpyControlMessageTypeValue;\n    #scrollController: ScrcpyScrollController;\n\n    constructor(options: ScrcpyOptions<object>) {\n        this.#options = options;\n        this.#typeValues = new ScrcpyControlMessageTypeValue(options);\n        this.#scrollController = options.createScrollController();\n    }\n\n    injectKeyCode(message: Omit<ScrcpyInjectKeyCodeControlMessage, \"type\">) {\n        return ScrcpyInjectKeyCodeControlMessage.serialize(\n            this.#typeValues.fillMessageType(\n                message,\n                ScrcpyControlMessageType.InjectKeyCode,\n            ),\n        );\n    }\n\n    injectText(text: string) {\n        return ScrcpyInjectTextControlMessage.serialize({\n            text,\n            type: this.#typeValues.get(ScrcpyControlMessageType.InjectText),\n        });\n    }\n\n    /**\n     * `pressure` is a float value between 0 and 1.\n     */\n    injectTouch(message: Omit<ScrcpyInjectTouchControlMessage, \"type\">) {\n        return this.#options.serializeInjectTouchControlMessage(\n            this.#typeValues.fillMessageType(\n                message,\n                ScrcpyControlMessageType.InjectTouch,\n            ),\n        );\n    }\n\n    /**\n     * `scrollX` and `scrollY` are float values between 0 and 1.\n     */\n    injectScroll(message: Omit<ScrcpyInjectScrollControlMessage, \"type\">) {\n        return this.#scrollController.serializeScrollMessage(\n            this.#typeValues.fillMessageType(\n                message,\n                ScrcpyControlMessageType.InjectScroll,\n            ),\n        );\n    }\n\n    backOrScreenOn(action: AndroidKeyEventAction) {\n        return this.#options.serializeBackOrScreenOnControlMessage({\n            action,\n            type: this.#typeValues.get(ScrcpyControlMessageType.BackOrScreenOn),\n        });\n    }\n\n    setScreenPowerMode(mode: AndroidScreenPowerMode) {\n        return ScrcpySetScreenPowerModeControlMessage.serialize({\n            mode,\n            type: this.#typeValues.get(\n                ScrcpyControlMessageType.SetScreenPowerMode,\n            ),\n        });\n    }\n\n    rotateDevice() {\n        return ScrcpyRotateDeviceControlMessage.serialize({\n            type: this.#typeValues.get(ScrcpyControlMessageType.RotateDevice),\n        });\n    }\n}\n","import type {\n    Consumable,\n    WritableStreamDefaultWriter,\n} from \"@yume-chan/stream-extra\";\nimport { ConsumableWritableStream } from \"@yume-chan/stream-extra\";\n\nimport type { ScrcpyOptions } from \"../options/index.js\";\n\nimport type {\n    AndroidKeyEventAction,\n    ScrcpyInjectKeyCodeControlMessage,\n} from \"./inject-keycode.js\";\nimport type { ScrcpyInjectScrollControlMessage } from \"./inject-scroll.js\";\nimport type { ScrcpyInjectTouchControlMessage } from \"./inject-touch.js\";\nimport { ScrcpyControlMessageSerializer } from \"./serializer.js\";\nimport type { AndroidScreenPowerMode } from \"./set-screen-power-mode.js\";\n\nexport class ScrcpyControlMessageWriter {\n    #writer: WritableStreamDefaultWriter<Consumable<Uint8Array>>;\n    #serializer: ScrcpyControlMessageSerializer;\n\n    constructor(\n        writer: WritableStreamDefaultWriter<Consumable<Uint8Array>>,\n        options: ScrcpyOptions<object>,\n    ) {\n        this.#writer = writer;\n        this.#serializer = new ScrcpyControlMessageSerializer(options);\n    }\n\n    async #write(message: Uint8Array) {\n        await ConsumableWritableStream.write(this.#writer, message);\n    }\n\n    async injectKeyCode(\n        message: Omit<ScrcpyInjectKeyCodeControlMessage, \"type\">,\n    ) {\n        await this.#write(this.#serializer.injectKeyCode(message));\n    }\n\n    async injectText(text: string) {\n        await this.#write(this.#serializer.injectText(text));\n    }\n\n    /**\n     * `pressure` is a float value between 0 and 1.\n     */\n    async injectTouch(message: Omit<ScrcpyInjectTouchControlMessage, \"type\">) {\n        await this.#write(this.#serializer.injectTouch(message));\n    }\n\n    /**\n     * `scrollX` and `scrollY` are float values between 0 and 1.\n     */\n    async injectScroll(\n        message: Omit<ScrcpyInjectScrollControlMessage, \"type\">,\n    ) {\n        const data = this.#serializer.injectScroll(message);\n        if (data) {\n            await this.#write(data);\n        }\n    }\n\n    async backOrScreenOn(action: AndroidKeyEventAction) {\n        const data = this.#serializer.backOrScreenOn(action);\n        if (data) {\n            await this.#write(data);\n        }\n    }\n\n    async setScreenPowerMode(mode: AndroidScreenPowerMode) {\n        await this.#write(this.#serializer.setScreenPowerMode(mode));\n    }\n\n    async rotateDevice() {\n        await this.#write(this.#serializer.rotateDevice());\n    }\n\n    releaseLock() {\n        this.#writer.releaseLock();\n    }\n\n    async close() {\n        await this.#writer.close();\n    }\n}\n","export * from \"./back-or-screen-on.js\";\nexport * from \"./basic.js\";\nexport * from \"./hover-helper.js\";\nexport * from \"./inject-keycode.js\";\nexport * from \"./inject-scroll.js\";\nexport * from \"./inject-text.js\";\nexport * from \"./inject-touch.js\";\nexport * from \"./rotate-device.js\";\nexport * from \"./serializer.js\";\nexport * from \"./set-clipboard.js\";\nexport * from \"./set-screen-power-mode.js\";\nexport * from \"./type.js\";\nexport * from \"./writer.js\";\n","// https://github.com/Genymobile/scrcpy/blob/41abe021e2a73efd4899b0efcd0b9eef9ec68c9b/server/src/main/java/com/genymobile/scrcpy/DeviceMessage.java#L5\nexport enum ScrcpyDeviceMessageType {\n    Clipboard,\n    AckClipboard,\n}\n","import Struct from \"@yume-chan/struct\";\n\nimport { ScrcpyDeviceMessageType } from \"./type.js\";\n\nexport const ScrcpyAckClipboardDeviceMessage = new Struct()\n    .uint64(\"sequence\")\n    .extra({ type: ScrcpyDeviceMessageType.AckClipboard as const });\n\nexport type ScrcpyAckClipboardDeviceMessage =\n    (typeof ScrcpyAckClipboardDeviceMessage)[\"TDeserializeResult\"];\n","import Struct from \"@yume-chan/struct\";\n\nimport { ScrcpyDeviceMessageType } from \"./type.js\";\n\nexport const ScrcpyClipboardDeviceMessage = new Struct()\n    .uint32(\"length\")\n    .string(\"content\", { lengthField: \"length\" })\n    .extra({ type: ScrcpyDeviceMessageType.Clipboard as const });\n\nexport type ScrcpyClipboardDeviceMessage =\n    (typeof ScrcpyClipboardDeviceMessage)[\"TDeserializeResult\"];\n","import { BufferedTransformStream } from \"@yume-chan/stream-extra\";\nimport {\n    ExactReadableEndedError,\n    StructEmptyError,\n    StructNotEnoughDataError,\n} from \"@yume-chan/struct\";\n\nimport { ScrcpyAckClipboardDeviceMessage } from \"./ack-clipboard.js\";\nimport { ScrcpyClipboardDeviceMessage } from \"./clipboard.js\";\nimport { ScrcpyDeviceMessageType } from \"./type.js\";\n\nexport type ScrcpyDeviceMessage =\n    | ScrcpyClipboardDeviceMessage\n    | ScrcpyAckClipboardDeviceMessage;\n\nexport class ScrcpyDeviceMessageDeserializeStream extends BufferedTransformStream<ScrcpyDeviceMessage> {\n    constructor() {\n        super(async (stream) => {\n            try {\n                const type = await stream.readExactly(1);\n                switch (type[0]) {\n                    case ScrcpyDeviceMessageType.Clipboard:\n                        return await ScrcpyClipboardDeviceMessage.deserialize(\n                            stream,\n                        );\n                    case ScrcpyDeviceMessageType.AckClipboard:\n                        return await ScrcpyAckClipboardDeviceMessage.deserialize(\n                            stream,\n                        );\n                    default:\n                        throw new Error(\"Unsupported control message type\");\n                }\n            } catch (e) {\n                // Can't read the `type` byte\n                if (e instanceof ExactReadableEndedError) {\n                    throw new StructEmptyError();\n                }\n\n                // Can't read struct body,\n                // treat as not enough data because `type` byte is already read\n                if (e instanceof StructEmptyError) {\n                    throw new StructNotEnoughDataError();\n                }\n\n                throw e;\n            }\n        });\n    }\n}\n","export * from \"./ack-clipboard.js\";\nexport * from \"./clipboard.js\";\nexport * from \"./stream.js\";\nexport * from \"./type.js\";\n","import type { ScrcpyOptionValue } from \"../types.js\";\n\n/**\n * If the option you need is not in this type,\n * please file an issue on GitHub.\n */\nexport interface CodecOptionsInit {\n    profile: number;\n    level: number;\n\n    iFrameInterval: number;\n    maxBframes: number;\n    repeatPreviousFrameAfter: number;\n    maxPtsGapToEncoder: number;\n    intraRefreshPeriod: number;\n}\n\nfunction toDashCase(input: string) {\n    return input.replace(/([A-Z])/g, \"-$1\").toLowerCase();\n}\n\nconst CODEC_OPTION_TYPES: Partial<\n    Record<keyof CodecOptionsInit, \"long\" | \"float\" | \"string\">\n> = {\n    repeatPreviousFrameAfter: \"long\",\n    maxPtsGapToEncoder: \"long\",\n};\n\nexport class CodecOptions implements ScrcpyOptionValue {\n    value: Partial<CodecOptionsInit>;\n\n    constructor(value: Partial<CodecOptionsInit> = {}) {\n        this.value = value;\n    }\n\n    toOptionValue(): string | undefined {\n        const entries = Object.entries(this.value).filter(\n            ([, value]) => value !== undefined,\n        );\n\n        if (entries.length === 0) {\n            return undefined;\n        }\n\n        return entries\n            .map(([key, value]) => {\n                const type = CODEC_OPTION_TYPES[key as keyof CodecOptionsInit];\n                return `${toDashCase(key)}${type ? `:${type}` : \"\"}=${value}`;\n            })\n            .join(\",\");\n    }\n}\n","import { NumberFieldDefinition, NumberFieldType } from \"@yume-chan/struct\";\n\nexport function clamp(value: number, min: number, max: number): number {\n    if (value < min) {\n        return min;\n    }\n\n    if (value > max) {\n        return max;\n    }\n\n    return value;\n}\n\nexport const ScrcpyFloatToUint16NumberType: NumberFieldType = {\n    size: 2,\n    signed: false,\n    deserialize(array, littleEndian) {\n        const value = NumberFieldType.Uint16.deserialize(array, littleEndian);\n        // https://github.com/Genymobile/scrcpy/blob/1f138aef41de651668043b32c4effc2d4adbfc44/server/src/main/java/com/genymobile/scrcpy/Binary.java#L22\n        return value === 0xffff ? 1 : value / 0x10000;\n    },\n    serialize(dataView, offset, value, littleEndian) {\n        // https://github.com/Genymobile/scrcpy/blob/1f138aef41de651668043b32c4effc2d4adbfc44/app/src/util/binary.h#L51\n        value = clamp(value, -1, 1);\n        value = value === 1 ? 0xffff : value * 0x10000;\n        NumberFieldType.Uint16.serialize(dataView, offset, value, littleEndian);\n    },\n};\n\nexport const ScrcpyFloatToUint16FieldDefinition = new NumberFieldDefinition(\n    ScrcpyFloatToUint16NumberType,\n);\n","import type { CodecOptions } from \"./codec-options.js\";\n\nexport enum ScrcpyLogLevel1_16 {\n    Debug = \"debug\",\n    Info = \"info\",\n    Warn = \"warn\",\n    Error = \"error\",\n}\n\nexport enum ScrcpyVideoOrientation1_16 {\n    Unlocked = -1,\n    Portrait = 0,\n    Landscape = 1,\n    PortraitFlipped = 2,\n    LandscapeFlipped = 3,\n}\n\nexport interface ScrcpyOptionsInit1_16 {\n    logLevel?: ScrcpyLogLevel1_16;\n\n    /**\n     * The maximum value of both width and height.\n     */\n    maxSize?: number;\n\n    bitRate?: number;\n\n    /**\n     * 0 for unlimited.\n     *\n     * @default 0\n     */\n    maxFps?: number;\n\n    /**\n     * The orientation of the video stream.\n     *\n     * It will not keep the device screen in specific orientation,\n     * only the captured video will in this orientation.\n     */\n    lockVideoOrientation?: ScrcpyVideoOrientation1_16;\n\n    /**\n     * Use ADB forward tunnel instead of reverse tunnel.\n     *\n     * This option is mainly used for working around the bug that on Android <9,\n     * ADB daemon can't create reverse tunnels if connected wirelessly (ADB over WiFi).\n     *\n     * When using `AdbScrcpyClient`, it can detect this situation and enable this option automatically.\n     */\n    tunnelForward?: boolean;\n\n    crop?: string | undefined;\n\n    /**\n     * Send PTS so that the client may record properly\n     *\n     * Note: When `sendFrameMeta: false` is specified,\n     * the video stream will not contain `configuration` typed packets,\n     * which means it can't be decoded by the companion decoders.\n     * It's still possible to record the stream into a file,\n     * or to decode it with a more tolerant decoder like FFMpeg.\n     *\n     * @default true\n     */\n    sendFrameMeta?: boolean;\n\n    /**\n     * @default true\n     */\n    control?: boolean;\n\n    displayId?: number;\n\n    showTouches?: boolean;\n\n    stayAwake?: boolean;\n\n    codecOptions?: CodecOptions;\n}\n","import Struct, { placeholder } from \"@yume-chan/struct\";\n\nimport type { AndroidMotionEventAction } from \"../../control/index.js\";\nimport {\n    BasicControlMessage,\n    ScrcpyControlMessageType,\n} from \"../../control/index.js\";\n\nimport { ScrcpyFloatToUint16FieldDefinition } from \"./float-to-uint16.js\";\n\nexport const SCRCPY_CONTROL_MESSAGE_TYPES_1_16: readonly ScrcpyControlMessageType[] =\n    [\n        /*  0 */ ScrcpyControlMessageType.InjectKeyCode,\n        /*  1 */ ScrcpyControlMessageType.InjectText,\n        /*  2 */ ScrcpyControlMessageType.InjectTouch,\n        /*  3 */ ScrcpyControlMessageType.InjectScroll,\n        /*  4 */ ScrcpyControlMessageType.BackOrScreenOn,\n        /*  5 */ ScrcpyControlMessageType.ExpandNotificationPanel,\n        /*  6 */ ScrcpyControlMessageType.CollapseNotificationPanel,\n        /*  7 */ ScrcpyControlMessageType.GetClipboard,\n        /*  8 */ ScrcpyControlMessageType.SetClipboard,\n        /*  9 */ ScrcpyControlMessageType.SetScreenPowerMode,\n        /* 10 */ ScrcpyControlMessageType.RotateDevice,\n    ];\n\nexport const ScrcpyMediaStreamRawPacket = new Struct()\n    .uint64(\"pts\")\n    .uint32(\"size\")\n    .uint8Array(\"data\", { lengthField: \"size\" });\n\nexport const SCRCPY_MEDIA_PACKET_FLAG_CONFIG = 1n << 63n;\n\nexport const ScrcpyInjectTouchControlMessage1_16 = new Struct()\n    .uint8(\"type\")\n    .uint8(\"action\", placeholder<AndroidMotionEventAction>())\n    .uint64(\"pointerId\")\n    .uint32(\"pointerX\")\n    .uint32(\"pointerY\")\n    .uint16(\"screenWidth\")\n    .uint16(\"screenHeight\")\n    .field(\"pressure\", ScrcpyFloatToUint16FieldDefinition)\n    .uint32(\"buttons\");\n\nexport type ScrcpyInjectTouchControlMessage1_16 =\n    (typeof ScrcpyInjectTouchControlMessage1_16)[\"TInit\"];\n\nexport const ScrcpyBackOrScreenOnControlMessage1_16 = BasicControlMessage;\n\nexport const ScrcpySetClipboardControlMessage1_15 = new Struct()\n    .uint8(\"type\")\n    .uint32(\"length\")\n    .string(\"content\", { lengthField: \"length\" });\n\nexport type ScrcpySetClipboardControlMessage1_15 =\n    (typeof ScrcpySetClipboardControlMessage1_15)[\"TInit\"];\n","import type { ReadableStream } from \"@yume-chan/stream-extra\";\n\nimport type { ScrcpyOptionValue } from \"./types.js\";\n\nexport enum ScrcpyVideoCodecId {\n    H264 = 0x68_32_36_34,\n    H265 = 0x68_32_36_35,\n    AV1 = 0x00_61_76_31,\n}\n\nexport interface ScrcpyVideoStreamMetadata {\n    deviceName?: string | undefined;\n    width?: number | undefined;\n    height?: number | undefined;\n    codec: ScrcpyVideoCodecId;\n}\n\nexport interface ScrcpyVideoStream {\n    readonly stream: ReadableStream<Uint8Array>;\n    readonly metadata: ScrcpyVideoStreamMetadata;\n}\n\nexport class ScrcpyAudioCodec implements ScrcpyOptionValue {\n    static readonly OPUS = new ScrcpyAudioCodec(\n        \"opus\",\n        0x6f_70_75_73,\n        \"audio/opus\",\n        \"opus\",\n    );\n    static readonly AAC = new ScrcpyAudioCodec(\n        \"aac\",\n        0x00_61_61_63,\n        \"audio/aac\",\n        \"mp4a.66\",\n    );\n    static readonly RAW = new ScrcpyAudioCodec(\n        \"raw\",\n        0x00_72_61_77,\n        \"audio/raw\",\n        \"1\",\n    );\n\n    readonly optionValue: string;\n    readonly metadataValue: number;\n    readonly mimeType: string;\n    readonly webCodecId: string;\n\n    constructor(\n        optionValue: string,\n        metadataValue: number,\n        mimeType: string,\n        webCodecId: string,\n    ) {\n        this.optionValue = optionValue;\n        this.metadataValue = metadataValue;\n        this.mimeType = mimeType;\n        this.webCodecId = webCodecId;\n    }\n\n    toOptionValue(): string {\n        return this.optionValue;\n    }\n}\n\nexport interface ScrcpyAudioStreamDisabledMetadata {\n    readonly type: \"disabled\";\n}\n\nexport interface ScrcpyAudioStreamErroredMetadata {\n    readonly type: \"errored\";\n}\n\nexport interface ScrcpyAudioStreamSuccessMetadata {\n    readonly type: \"success\";\n    readonly codec: ScrcpyAudioCodec;\n    readonly stream: ReadableStream<Uint8Array>;\n}\n\nexport type ScrcpyAudioStreamMetadata =\n    | ScrcpyAudioStreamDisabledMetadata\n    | ScrcpyAudioStreamErroredMetadata\n    | ScrcpyAudioStreamSuccessMetadata;\n\nexport interface ScrcpyMediaStreamConfigurationPacket {\n    type: \"configuration\";\n    data: Uint8Array;\n}\n\nexport interface ScrcpyMediaStreamDataPacket {\n    type: \"data\";\n    keyframe?: boolean;\n    pts?: bigint;\n    data: Uint8Array;\n}\n\nexport type ScrcpyMediaStreamPacket =\n    | ScrcpyMediaStreamConfigurationPacket\n    | ScrcpyMediaStreamDataPacket;\n","import type { ReadableStream, TransformStream } from \"@yume-chan/stream-extra\";\nimport type { ValueOrPromise } from \"@yume-chan/struct\";\n\nimport type {\n    ScrcpyBackOrScreenOnControlMessage,\n    ScrcpyControlMessageType,\n    ScrcpyInjectTouchControlMessage,\n    ScrcpySetClipboardControlMessage,\n} from \"../control/index.js\";\n\nimport type { ScrcpyScrollController } from \"./1_16/scroll.js\";\nimport type {\n    ScrcpyAudioStreamMetadata,\n    ScrcpyMediaStreamPacket,\n    ScrcpyVideoStream,\n} from \"./codec.js\";\n\nexport const DEFAULT_SERVER_PATH = \"/data/local/tmp/scrcpy-server.jar\";\n\nexport interface ScrcpyOptionValue {\n    toOptionValue(): string | undefined;\n}\n\nexport function isScrcpyOptionValue(\n    value: unknown,\n): value is ScrcpyOptionValue {\n    return (\n        typeof value === \"object\" &&\n        value !== null &&\n        \"toOptionValue\" in value &&\n        typeof value.toOptionValue === \"function\"\n    );\n}\n\nexport function toScrcpyOptionValue<T>(value: unknown, empty: T): string | T {\n    if (isScrcpyOptionValue(value)) {\n        value = value.toOptionValue();\n    }\n\n    // `value` may become `undefined` after `toOptionValue`\n    if (value === undefined) {\n        return empty;\n    }\n\n    return String(value);\n}\n\nexport interface ScrcpyEncoder {\n    type: \"video\" | \"audio\";\n    codec?: string;\n    name: string;\n}\n\nexport interface ScrcpyDisplay {\n    id: number;\n    resolution?: string;\n}\n\nexport interface ScrcpyOptions<T extends object> {\n    readonly defaults: Required<T>;\n\n    readonly controlMessageTypes: readonly ScrcpyControlMessageType[];\n\n    readonly value: Required<T>;\n\n    serialize(): string[];\n\n    /**\n     * Set the essential options to let Scrcpy server print out available encoders.\n     */\n    setListEncoders(): void;\n\n    /**\n     * Set the essential options to let Scrcpy server print out available displays.\n     */\n    setListDisplays(): void;\n\n    /**\n     * Parse encoder information from Scrcpy server output\n     * @param line One line of Scrcpy server output\n     */\n    parseEncoder(line: string): ScrcpyEncoder | undefined;\n\n    /**\n     * Parse display information from Scrcpy server output\n     * @param line One line of Scrcpy server output\n     */\n    parseDisplay(line: string): ScrcpyDisplay | undefined;\n\n    /**\n     * Parse the device metadata from video stream according to the current version and options.\n     * @param stream The video stream.\n     * @returns\n     * A tuple of the video stream and the metadata.\n     *\n     * The returned video stream may be different from the input stream, and should be used for further processing.\n     */\n    parseVideoStreamMetadata(\n        stream: ReadableStream<Uint8Array>,\n    ): ValueOrPromise<ScrcpyVideoStream>;\n\n    parseAudioStreamMetadata(\n        stream: ReadableStream<Uint8Array>,\n    ): ValueOrPromise<ScrcpyAudioStreamMetadata>;\n\n    createMediaStreamTransformer(): TransformStream<\n        Uint8Array,\n        ScrcpyMediaStreamPacket\n    >;\n\n    serializeInjectTouchControlMessage(\n        message: ScrcpyInjectTouchControlMessage,\n    ): Uint8Array;\n\n    serializeBackOrScreenOnControlMessage(\n        message: ScrcpyBackOrScreenOnControlMessage,\n    ): Uint8Array | undefined;\n\n    serializeSetClipboardControlMessage(\n        message: ScrcpySetClipboardControlMessage,\n    ): Uint8Array;\n\n    createScrollController(): ScrcpyScrollController;\n}\n\nexport abstract class ScrcpyOptionsBase<\n    T extends object,\n    B extends ScrcpyOptions<object>,\n> implements ScrcpyOptions<T>\n{\n    protected _base: B;\n\n    abstract get defaults(): Required<T>;\n\n    get controlMessageTypes(): readonly ScrcpyControlMessageType[] {\n        return this._base.controlMessageTypes;\n    }\n\n    readonly value: Required<T>;\n\n    constructor(base: B, value: Required<T>) {\n        this._base = base;\n        this.value = value;\n        this.#setValue();\n    }\n\n    #setValue() {\n        // Share `value` with `_base` class,\n        // so updating `_base.value` in `_base.setListEncoders()`/\n        // `_base.setListDisplays()` will also update `this.value`.\n        Object.assign(this._base, { value: this.value });\n        if (this._base instanceof ScrcpyOptionsBase) {\n            this._base.#setValue();\n        }\n    }\n\n    abstract serialize(): string[];\n\n    setListEncoders(): void {\n        this._base.setListEncoders();\n    }\n\n    setListDisplays(): void {\n        this._base.setListDisplays();\n    }\n\n    parseEncoder(line: string): ScrcpyEncoder | undefined {\n        return this._base.parseEncoder(line);\n    }\n\n    parseDisplay(line: string): ScrcpyDisplay | undefined {\n        return this._base.parseDisplay(line);\n    }\n\n    /**\n     * Parse the device metadata from video stream according to the current version and options.\n     * @param stream The video stream.\n     * @returns\n     * A tuple of the video stream and the metadata.\n     *\n     * The returned video stream may be different from the input stream, and should be used for further processing.\n     */\n    parseVideoStreamMetadata(\n        stream: ReadableStream<Uint8Array>,\n    ): ValueOrPromise<ScrcpyVideoStream> {\n        return this._base.parseVideoStreamMetadata(stream);\n    }\n\n    parseAudioStreamMetadata(\n        stream: ReadableStream<Uint8Array>,\n    ): ValueOrPromise<ScrcpyAudioStreamMetadata> {\n        return this._base.parseAudioStreamMetadata(stream);\n    }\n\n    createMediaStreamTransformer(): TransformStream<\n        Uint8Array,\n        ScrcpyMediaStreamPacket\n    > {\n        return this._base.createMediaStreamTransformer();\n    }\n\n    serializeInjectTouchControlMessage(\n        message: ScrcpyInjectTouchControlMessage,\n    ): Uint8Array {\n        return this._base.serializeInjectTouchControlMessage(message);\n    }\n\n    serializeBackOrScreenOnControlMessage(\n        message: ScrcpyBackOrScreenOnControlMessage,\n    ): Uint8Array | undefined {\n        return this._base.serializeBackOrScreenOnControlMessage(message);\n    }\n\n    serializeSetClipboardControlMessage(\n        message: ScrcpySetClipboardControlMessage,\n    ): Uint8Array {\n        return this._base.serializeSetClipboardControlMessage(message);\n    }\n\n    createScrollController(): ScrcpyScrollController {\n        return this._base.createScrollController();\n    }\n}\n","import Struct from \"@yume-chan/struct\";\n\nimport type { ScrcpyInjectScrollControlMessage } from \"../../control/index.js\";\n\nexport interface ScrcpyScrollController {\n    serializeScrollMessage(\n        message: ScrcpyInjectScrollControlMessage,\n    ): Uint8Array | undefined;\n}\n\nexport const ScrcpyInjectScrollControlMessage1_16 = new Struct()\n    .uint8(\"type\")\n    .uint32(\"pointerX\")\n    .uint32(\"pointerY\")\n    .uint16(\"screenWidth\")\n    .uint16(\"screenHeight\")\n    .int32(\"scrollX\")\n    .int32(\"scrollY\");\n\n/**\n * Old version of Scrcpy server only supports integer values for scroll.\n *\n * Accumulate scroll values and send scroll message when accumulated value\n * reaches 1 or -1.\n */\nexport class ScrcpyScrollController1_16 implements ScrcpyScrollController {\n    #accumulatedX = 0;\n    #accumulatedY = 0;\n\n    protected processMessage(\n        message: ScrcpyInjectScrollControlMessage,\n    ): ScrcpyInjectScrollControlMessage | undefined {\n        this.#accumulatedX += message.scrollX;\n        this.#accumulatedY += message.scrollY;\n\n        let scrollX = 0;\n        let scrollY = 0;\n        if (this.#accumulatedX >= 1) {\n            scrollX = 1;\n            this.#accumulatedX = 0;\n        } else if (this.#accumulatedX <= -1) {\n            scrollX = -1;\n            this.#accumulatedX = 0;\n        }\n\n        if (this.#accumulatedY >= 1) {\n            scrollY = 1;\n            this.#accumulatedY = 0;\n        } else if (this.#accumulatedY <= -1) {\n            scrollY = -1;\n            this.#accumulatedY = 0;\n        }\n\n        if (scrollX === 0 && scrollY === 0) {\n            return undefined;\n        }\n\n        message.scrollX = scrollX;\n        message.scrollY = scrollY;\n        return message;\n    }\n\n    serializeScrollMessage(\n        message: ScrcpyInjectScrollControlMessage,\n    ): Uint8Array | undefined {\n        const processed = this.processMessage(message);\n        if (!processed) {\n            return undefined;\n        }\n\n        return ScrcpyInjectScrollControlMessage1_16.serialize(processed);\n    }\n}\n","import type { ReadableStream } from \"@yume-chan/stream-extra\";\nimport {\n    BufferedReadableStream,\n    StructDeserializeStream,\n    TransformStream,\n} from \"@yume-chan/stream-extra\";\nimport type { AsyncExactReadable, ValueOrPromise } from \"@yume-chan/struct\";\nimport { NumberFieldType, decodeUtf8 } from \"@yume-chan/struct\";\n\nimport type {\n    ScrcpyBackOrScreenOnControlMessage,\n    ScrcpyControlMessageType,\n    ScrcpyInjectTouchControlMessage,\n    ScrcpySetClipboardControlMessage,\n} from \"../../control/index.js\";\nimport { AndroidKeyEventAction } from \"../../control/index.js\";\nimport type {\n    ScrcpyMediaStreamPacket,\n    ScrcpyVideoStream,\n    ScrcpyVideoStreamMetadata,\n} from \"../codec.js\";\nimport { ScrcpyVideoCodecId } from \"../codec.js\";\nimport type { ScrcpyDisplay, ScrcpyEncoder, ScrcpyOptions } from \"../types.js\";\nimport { toScrcpyOptionValue } from \"../types.js\";\n\nimport { CodecOptions } from \"./codec-options.js\";\nimport type { ScrcpyOptionsInit1_16 } from \"./init.js\";\nimport { ScrcpyLogLevel1_16, ScrcpyVideoOrientation1_16 } from \"./init.js\";\nimport {\n    SCRCPY_CONTROL_MESSAGE_TYPES_1_16,\n    SCRCPY_MEDIA_PACKET_FLAG_CONFIG,\n    ScrcpyBackOrScreenOnControlMessage1_16,\n    ScrcpyInjectTouchControlMessage1_16,\n    ScrcpyMediaStreamRawPacket,\n    ScrcpySetClipboardControlMessage1_15,\n} from \"./message.js\";\nimport type { ScrcpyScrollController } from \"./scroll.js\";\nimport { ScrcpyScrollController1_16 } from \"./scroll.js\";\n\nexport class ScrcpyOptions1_16 implements ScrcpyOptions<ScrcpyOptionsInit1_16> {\n    static readonly DEFAULTS = {\n        logLevel: ScrcpyLogLevel1_16.Debug,\n        maxSize: 0,\n        bitRate: 8_000_000,\n        maxFps: 0,\n        lockVideoOrientation: ScrcpyVideoOrientation1_16.Unlocked,\n        tunnelForward: false,\n        crop: undefined,\n        sendFrameMeta: true,\n        control: true,\n        displayId: 0,\n        showTouches: false,\n        stayAwake: false,\n        codecOptions: new CodecOptions(),\n    } as const satisfies Required<ScrcpyOptionsInit1_16>;\n\n    static readonly SERIALIZE_ORDER = [\n        \"logLevel\",\n        \"maxSize\",\n        \"bitRate\",\n        \"maxFps\",\n        \"lockVideoOrientation\",\n        \"tunnelForward\",\n        \"crop\",\n        \"sendFrameMeta\",\n        \"control\",\n        \"displayId\",\n        \"showTouches\",\n        \"stayAwake\",\n        \"codecOptions\",\n    ] as const satisfies readonly (keyof ScrcpyOptionsInit1_16)[];\n\n    static serialize<T>(options: T, order: readonly (keyof T)[]) {\n        return order.map((key) => toScrcpyOptionValue(options[key], \"-\"));\n    }\n\n    static async parseCString(\n        stream: AsyncExactReadable,\n        maxLength: number,\n    ): Promise<string> {\n        let result = decodeUtf8(await stream.readExactly(maxLength));\n        result = result.substring(0, result.indexOf(\"\\0\"));\n        return result;\n    }\n\n    static async parseUint16BE(stream: AsyncExactReadable): Promise<number> {\n        const buffer = await stream.readExactly(NumberFieldType.Uint16.size);\n        return NumberFieldType.Uint16.deserialize(buffer, false);\n    }\n\n    static async parseUint32BE(stream: AsyncExactReadable): Promise<number> {\n        const buffer = await stream.readExactly(NumberFieldType.Uint32.size);\n        return NumberFieldType.Uint32.deserialize(buffer, false);\n    }\n\n    value: Required<ScrcpyOptionsInit1_16>;\n\n    readonly defaults: Required<ScrcpyOptionsInit1_16> =\n        ScrcpyOptions1_16.DEFAULTS;\n\n    readonly controlMessageTypes: readonly ScrcpyControlMessageType[] =\n        SCRCPY_CONTROL_MESSAGE_TYPES_1_16;\n\n    constructor(init: ScrcpyOptionsInit1_16) {\n        this.value = { ...ScrcpyOptions1_16.DEFAULTS, ...init };\n    }\n\n    serialize(): string[] {\n        return ScrcpyOptions1_16.serialize(\n            this.value,\n            ScrcpyOptions1_16.SERIALIZE_ORDER,\n        );\n    }\n\n    setListEncoders(): void {\n        throw new Error(\"Not supported\");\n    }\n\n    setListDisplays(): void {\n        // Set to an invalid value\n        // Server will print valid values before crashing\n        // (server will crash before opening sockets)\n        this.value.displayId = -1;\n    }\n\n    parseEncoder(): ScrcpyEncoder | undefined {\n        throw new Error(\"Not supported\");\n    }\n\n    parseDisplay(line: string): ScrcpyDisplay | undefined {\n        const displayIdRegex = /\\s+scrcpy --display (\\d+)/;\n        const match = line.match(displayIdRegex);\n        if (match) {\n            return {\n                id: Number.parseInt(match[1]!, 10),\n            };\n        }\n        return undefined;\n    }\n\n    parseVideoStreamMetadata(\n        stream: ReadableStream<Uint8Array>,\n    ): ValueOrPromise<ScrcpyVideoStream> {\n        return (async () => {\n            const buffered = new BufferedReadableStream(stream);\n            const metadata: ScrcpyVideoStreamMetadata = {\n                codec: ScrcpyVideoCodecId.H264,\n            };\n            metadata.deviceName = await ScrcpyOptions1_16.parseCString(\n                buffered,\n                64,\n            );\n            metadata.width = await ScrcpyOptions1_16.parseUint16BE(buffered);\n            metadata.height = await ScrcpyOptions1_16.parseUint16BE(buffered);\n            return { stream: buffered.release(), metadata };\n        })();\n    }\n\n    parseAudioStreamMetadata(): never {\n        throw new Error(\"Not supported\");\n    }\n\n    createMediaStreamTransformer(): TransformStream<\n        Uint8Array,\n        ScrcpyMediaStreamPacket\n    > {\n        // Optimized path for video frames only\n        if (!this.value.sendFrameMeta) {\n            return new TransformStream({\n                transform(chunk, controller) {\n                    controller.enqueue({\n                        type: \"data\",\n                        data: chunk,\n                    });\n                },\n            });\n        }\n\n        const deserializeStream = new StructDeserializeStream(\n            ScrcpyMediaStreamRawPacket,\n        );\n        return {\n            writable: deserializeStream.writable,\n            readable: deserializeStream.readable.pipeThrough(\n                new TransformStream({\n                    transform(packet, controller) {\n                        if (packet.pts === SCRCPY_MEDIA_PACKET_FLAG_CONFIG) {\n                            controller.enqueue({\n                                type: \"configuration\",\n                                data: packet.data,\n                            });\n                            return;\n                        }\n\n                        controller.enqueue({\n                            type: \"data\",\n                            pts: packet.pts,\n                            data: packet.data,\n                        });\n                    },\n                }),\n            ),\n        };\n    }\n\n    serializeInjectTouchControlMessage(\n        message: ScrcpyInjectTouchControlMessage,\n    ): Uint8Array {\n        return ScrcpyInjectTouchControlMessage1_16.serialize(message);\n    }\n\n    serializeBackOrScreenOnControlMessage(\n        message: ScrcpyBackOrScreenOnControlMessage,\n    ) {\n        if (message.action === AndroidKeyEventAction.Down) {\n            return ScrcpyBackOrScreenOnControlMessage1_16.serialize(message);\n        }\n\n        return undefined;\n    }\n\n    serializeSetClipboardControlMessage(\n        message: ScrcpySetClipboardControlMessage,\n    ): Uint8Array {\n        return ScrcpySetClipboardControlMessage1_15.serialize(message);\n    }\n\n    createScrollController(): ScrcpyScrollController {\n        return new ScrcpyScrollController1_16();\n    }\n}\n","export * from \"./codec-options.js\";\nexport * from \"./float-to-uint16.js\";\nexport * from \"./init.js\";\nexport * from \"./message.js\";\nexport * from \"./options.js\";\nexport * from \"./scroll.js\";\n","import type { ScrcpyOptionsInit1_16 } from \"./1_16/index.js\";\nimport { ScrcpyOptions1_16 } from \"./1_16/index.js\";\nimport type { ScrcpyEncoder } from \"./types.js\";\nimport { ScrcpyOptionsBase } from \"./types.js\";\n\nexport interface ScrcpyOptionsInit1_17 extends ScrcpyOptionsInit1_16 {\n    encoderName?: string | undefined;\n}\n\nexport class ScrcpyOptions1_17 extends ScrcpyOptionsBase<\n    ScrcpyOptionsInit1_17,\n    ScrcpyOptions1_16\n> {\n    static readonly DEFAULTS = {\n        ...ScrcpyOptions1_16.DEFAULTS,\n        encoderName: undefined,\n    } as const satisfies Required<ScrcpyOptionsInit1_17>;\n\n    static readonly SERIALIZE_ORDER = [\n        ...ScrcpyOptions1_16.SERIALIZE_ORDER,\n        \"encoderName\",\n    ] as const satisfies readonly (keyof ScrcpyOptionsInit1_17)[];\n\n    static parseEncoder(\n        line: string,\n        encoderNameRegex: RegExp,\n    ): ScrcpyEncoder | undefined {\n        const match = line.match(encoderNameRegex);\n        if (match) {\n            return { type: \"video\", name: match[1]! };\n        }\n        return undefined;\n    }\n\n    override get defaults(): Required<ScrcpyOptionsInit1_17> {\n        return ScrcpyOptions1_17.DEFAULTS;\n    }\n\n    constructor(init: ScrcpyOptionsInit1_17) {\n        super(new ScrcpyOptions1_16(init), {\n            ...ScrcpyOptions1_17.DEFAULTS,\n            ...init,\n        });\n    }\n\n    override serialize(): string[] {\n        return ScrcpyOptions1_16.serialize(\n            this.value,\n            ScrcpyOptions1_17.SERIALIZE_ORDER,\n        );\n    }\n\n    override setListEncoders() {\n        // Set to an invalid value\n        // Server will print valid values before crashing\n        // (server will crash after opening video and control sockets)\n        this.value.encoderName = \"_\";\n    }\n\n    override parseEncoder(line: string): ScrcpyEncoder | undefined {\n        return ScrcpyOptions1_17.parseEncoder(\n            line,\n            /\\s+scrcpy --encoder-name '(.*?)'/,\n        );\n    }\n}\n","import Struct, { placeholder } from \"@yume-chan/struct\";\n\nimport type {\n    AndroidKeyEventAction,\n    ScrcpyBackOrScreenOnControlMessage,\n} from \"../control/index.js\";\nimport { ScrcpyControlMessageType } from \"../control/index.js\";\n\nimport {\n    SCRCPY_CONTROL_MESSAGE_TYPES_1_16,\n    ScrcpyBackOrScreenOnControlMessage1_16,\n    ScrcpyLogLevel1_16,\n    ScrcpyOptions1_16,\n    ScrcpyVideoOrientation1_16,\n} from \"./1_16/index.js\";\nimport type { ScrcpyOptionsInit1_17 } from \"./1_17.js\";\nimport { ScrcpyOptions1_17 } from \"./1_17.js\";\nimport type { ScrcpyEncoder } from \"./types.js\";\nimport { ScrcpyOptionsBase } from \"./types.js\";\n\nexport enum ScrcpyLogLevel1_18 {\n    Verbose = \"verbose\",\n    Debug = \"debug\",\n    Info = \"info\",\n    Warn = \"warn\",\n    Error = \"error\",\n}\n\nexport enum ScrcpyVideoOrientation1_18 {\n    Initial = -2,\n    Unlocked = -1,\n    Portrait = 0,\n    Landscape = 1,\n    PortraitFlipped = 2,\n    LandscapeFlipped = 3,\n}\n\nexport interface ScrcpyOptionsInit1_18\n    extends Omit<ScrcpyOptionsInit1_17, \"logLevel\" | \"lockVideoOrientation\"> {\n    logLevel?: ScrcpyLogLevel1_18;\n\n    lockVideoOrientation?: ScrcpyVideoOrientation1_18;\n\n    powerOffOnClose?: boolean;\n}\n\nexport const ScrcpyBackOrScreenOnControlMessage1_18 = new Struct()\n    .concat(ScrcpyBackOrScreenOnControlMessage1_16)\n    .uint8(\"action\", placeholder<AndroidKeyEventAction>());\n\nexport type ScrcpyBackOrScreenOnControlMessage1_18 =\n    (typeof ScrcpyBackOrScreenOnControlMessage1_18)[\"TInit\"];\n\nexport const SCRCPY_CONTROL_MESSAGE_TYPES_1_18 =\n    SCRCPY_CONTROL_MESSAGE_TYPES_1_16.slice();\nSCRCPY_CONTROL_MESSAGE_TYPES_1_18.splice(\n    6,\n    0,\n    ScrcpyControlMessageType.ExpandSettingPanel,\n);\n\nconst LOG_LEVEL_MAP = {\n    [ScrcpyLogLevel1_18.Verbose]: ScrcpyLogLevel1_16.Debug,\n    [ScrcpyLogLevel1_18.Debug]: ScrcpyLogLevel1_16.Debug,\n    [ScrcpyLogLevel1_18.Info]: ScrcpyLogLevel1_16.Info,\n    [ScrcpyLogLevel1_18.Warn]: ScrcpyLogLevel1_16.Warn,\n    [ScrcpyLogLevel1_18.Error]: ScrcpyLogLevel1_16.Error,\n};\n\nconst VIDEO_ORIENTATION_MAP = {\n    [ScrcpyVideoOrientation1_18.Initial]: ScrcpyVideoOrientation1_16.Unlocked,\n    [ScrcpyVideoOrientation1_18.Unlocked]: ScrcpyVideoOrientation1_16.Unlocked,\n    [ScrcpyVideoOrientation1_18.Portrait]: ScrcpyVideoOrientation1_16.Portrait,\n    [ScrcpyVideoOrientation1_18.Landscape]:\n        ScrcpyVideoOrientation1_16.Landscape,\n    [ScrcpyVideoOrientation1_18.PortraitFlipped]:\n        ScrcpyVideoOrientation1_16.PortraitFlipped,\n    [ScrcpyVideoOrientation1_18.LandscapeFlipped]:\n        ScrcpyVideoOrientation1_16.LandscapeFlipped,\n};\nexport class ScrcpyOptions1_18 extends ScrcpyOptionsBase<\n    ScrcpyOptionsInit1_18,\n    ScrcpyOptions1_17\n> {\n    static readonly DEFAULTS = {\n        ...ScrcpyOptions1_17.DEFAULTS,\n        logLevel: ScrcpyLogLevel1_18.Debug,\n        lockVideoOrientation: ScrcpyVideoOrientation1_18.Unlocked,\n        powerOffOnClose: false,\n    } as const satisfies Required<ScrcpyOptionsInit1_18>;\n\n    static readonly SERIALIZE_ORDER = [\n        ...ScrcpyOptions1_17.SERIALIZE_ORDER,\n        \"powerOffOnClose\",\n    ] as const satisfies readonly (keyof ScrcpyOptionsInit1_18)[];\n\n    override get defaults(): Required<ScrcpyOptionsInit1_18> {\n        return ScrcpyOptions1_18.DEFAULTS;\n    }\n\n    override get controlMessageTypes() {\n        return SCRCPY_CONTROL_MESSAGE_TYPES_1_18;\n    }\n\n    constructor(init: ScrcpyOptionsInit1_18) {\n        const value = { ...ScrcpyOptions1_18.DEFAULTS, ...init };\n        super(\n            new ScrcpyOptions1_17({\n                ...init,\n                logLevel: LOG_LEVEL_MAP[value.logLevel],\n                lockVideoOrientation:\n                    VIDEO_ORIENTATION_MAP[value.lockVideoOrientation],\n            }),\n            value,\n        );\n    }\n\n    override serialize(): string[] {\n        return ScrcpyOptions1_16.serialize(\n            this.value,\n            ScrcpyOptions1_18.SERIALIZE_ORDER,\n        );\n    }\n\n    override parseEncoder(line: string): ScrcpyEncoder | undefined {\n        return ScrcpyOptions1_17.parseEncoder(\n            line,\n            /\\s+scrcpy --encoder '(.*?)'/,\n        );\n    }\n\n    override serializeBackOrScreenOnControlMessage(\n        message: ScrcpyBackOrScreenOnControlMessage,\n    ) {\n        return ScrcpyBackOrScreenOnControlMessage1_18.serialize(message);\n    }\n}\n","// cspell: ignore autosync\n\nimport Struct, { placeholder } from \"@yume-chan/struct\";\n\nimport type { ScrcpySetClipboardControlMessage } from \"../control/index.js\";\n\nimport type { ScrcpyOptionsInit1_18 } from \"./1_18.js\";\nimport { ScrcpyOptions1_18 } from \"./1_18.js\";\nimport { ScrcpyOptionsBase, toScrcpyOptionValue } from \"./types.js\";\n\nexport interface ScrcpyOptionsInit1_21 extends ScrcpyOptionsInit1_18 {\n    clipboardAutosync?: boolean;\n}\n\nfunction toSnakeCase(input: string): string {\n    return input.replace(/([A-Z])/g, \"_$1\").toLowerCase();\n}\n\nexport const ScrcpySetClipboardControlMessage1_21 = new Struct()\n    .uint8(\"type\")\n    .uint64(\"sequence\")\n    .int8(\"paste\", placeholder<boolean>())\n    .uint32(\"length\")\n    .string(\"content\", { lengthField: \"length\" });\n\nexport type ScrcpySetClipboardControlMessage1_21 =\n    (typeof ScrcpySetClipboardControlMessage1_21)[\"TInit\"];\n\nexport class ScrcpyOptions1_21 extends ScrcpyOptionsBase<\n    ScrcpyOptionsInit1_21,\n    ScrcpyOptions1_18\n> {\n    static readonly DEFAULTS = {\n        ...ScrcpyOptions1_18.DEFAULTS,\n        clipboardAutosync: true,\n    } as const satisfies Required<ScrcpyOptionsInit1_21>;\n\n    static serialize<T extends object>(\n        options: T,\n        defaults: Required<T>,\n    ): string[] {\n        // 1.21 changed the format of arguments\n        const result: string[] = [];\n        for (const [key, value] of Object.entries(options)) {\n            const serializedValue = toScrcpyOptionValue(value, undefined);\n            if (!serializedValue) {\n                continue;\n            }\n\n            const defaultValue = toScrcpyOptionValue(\n                defaults[key as keyof T],\n                undefined,\n            );\n            if (serializedValue == defaultValue) {\n                continue;\n            }\n\n            result.push(`${toSnakeCase(key)}=${serializedValue}`);\n        }\n        return result;\n    }\n\n    override get defaults(): Required<ScrcpyOptionsInit1_21> {\n        return ScrcpyOptions1_21.DEFAULTS;\n    }\n\n    constructor(init: ScrcpyOptionsInit1_21) {\n        super(new ScrcpyOptions1_18(init), {\n            ...ScrcpyOptions1_21.DEFAULTS,\n            ...init,\n        });\n    }\n\n    override serialize(): string[] {\n        return ScrcpyOptions1_21.serialize(this.value, this.defaults);\n    }\n\n    override serializeSetClipboardControlMessage(\n        message: ScrcpySetClipboardControlMessage,\n    ): Uint8Array {\n        return ScrcpySetClipboardControlMessage1_21.serialize(message);\n    }\n}\n","import Struct from \"@yume-chan/struct\";\n\nimport {\n    ScrcpyInjectScrollControlMessage1_16,\n    ScrcpyScrollController1_16,\n} from \"../1_16/index.js\";\n\nexport const ScrcpyInjectScrollControlMessage1_22 = new Struct()\n    .concat(ScrcpyInjectScrollControlMessage1_16)\n    .int32(\"buttons\");\n\nexport type ScrcpyInjectScrollControlMessage1_22 =\n    (typeof ScrcpyInjectScrollControlMessage1_22)[\"TInit\"];\n\nexport class ScrcpyScrollController1_22 extends ScrcpyScrollController1_16 {\n    override serializeScrollMessage(\n        message: ScrcpyInjectScrollControlMessage1_22,\n    ): Uint8Array | undefined {\n        const processed = this.processMessage(message);\n        if (!processed) {\n            return undefined;\n        }\n\n        return ScrcpyInjectScrollControlMessage1_22.serialize(processed);\n    }\n}\n","import type { ReadableStream } from \"@yume-chan/stream-extra\";\nimport type { ValueOrPromise } from \"@yume-chan/struct\";\n\nimport type { ScrcpyScrollController } from \"../1_16/index.js\";\nimport { ScrcpyOptions1_21 } from \"../1_21.js\";\nimport type { ScrcpyVideoStream } from \"../codec.js\";\nimport { ScrcpyVideoCodecId } from \"../codec.js\";\nimport { ScrcpyOptionsBase } from \"../types.js\";\n\nimport type { ScrcpyOptionsInit1_22 } from \"./init.js\";\nimport { ScrcpyScrollController1_22 } from \"./scroll.js\";\n\nexport class ScrcpyOptions1_22 extends ScrcpyOptionsBase<\n    ScrcpyOptionsInit1_22,\n    ScrcpyOptions1_21\n> {\n    static readonly DEFAULTS = {\n        ...ScrcpyOptions1_21.DEFAULTS,\n        downsizeOnError: true,\n        sendDeviceMeta: true,\n        sendDummyByte: true,\n    } as const satisfies Required<ScrcpyOptionsInit1_22>;\n\n    override get defaults(): Required<ScrcpyOptionsInit1_22> {\n        return ScrcpyOptions1_22.DEFAULTS;\n    }\n\n    constructor(init: ScrcpyOptionsInit1_22) {\n        super(new ScrcpyOptions1_21(init), {\n            ...ScrcpyOptions1_22.DEFAULTS,\n            ...init,\n        });\n    }\n\n    override parseVideoStreamMetadata(\n        stream: ReadableStream<Uint8Array>,\n    ): ValueOrPromise<ScrcpyVideoStream> {\n        if (!this.value.sendDeviceMeta) {\n            return { stream, metadata: { codec: ScrcpyVideoCodecId.H264 } };\n        } else {\n            return this._base.parseVideoStreamMetadata(stream);\n        }\n    }\n\n    override serialize(): string[] {\n        return ScrcpyOptions1_21.serialize(this.value, this.defaults);\n    }\n\n    override createScrollController(): ScrcpyScrollController {\n        return new ScrcpyScrollController1_22();\n    }\n}\n","export * from \"./init.js\";\nexport * from \"./options.js\";\nexport * from \"./scroll.js\";\n","import { TransformStream } from \"@yume-chan/stream-extra\";\n\nimport { ScrcpyOptions1_21 } from \"./1_21.js\";\nimport type { ScrcpyOptionsInit1_22 } from \"./1_22/index.js\";\nimport { ScrcpyOptions1_22 } from \"./1_22/index.js\";\nimport type { ScrcpyMediaStreamPacket } from \"./codec.js\";\nimport { ScrcpyOptionsBase } from \"./types.js\";\n\nexport interface ScrcpyOptionsInit1_23 extends ScrcpyOptionsInit1_22 {\n    cleanup?: boolean;\n}\n\nconst KEYFRAME_PTS = 1n << 62n;\n\nexport class ScrcpyOptions1_23 extends ScrcpyOptionsBase<\n    ScrcpyOptionsInit1_23,\n    ScrcpyOptions1_22\n> {\n    static readonly DEFAULTS = {\n        ...ScrcpyOptions1_22.DEFAULTS,\n        cleanup: true,\n    } as const satisfies Required<ScrcpyOptionsInit1_23>;\n\n    override get defaults(): Required<ScrcpyOptionsInit1_23> {\n        return ScrcpyOptions1_23.DEFAULTS;\n    }\n\n    constructor(init: ScrcpyOptionsInit1_22) {\n        super(new ScrcpyOptions1_22(init), {\n            ...ScrcpyOptions1_23.DEFAULTS,\n            ...init,\n        });\n    }\n\n    override serialize(): string[] {\n        return ScrcpyOptions1_21.serialize(this.value, this.defaults);\n    }\n\n    override createMediaStreamTransformer(): TransformStream<\n        Uint8Array,\n        ScrcpyMediaStreamPacket\n    > {\n        const stream = this._base.createMediaStreamTransformer();\n        return {\n            writable: stream.writable,\n            readable: stream.readable.pipeThrough(\n                new TransformStream({\n                    transform(packet, controller): void {\n                        if (packet.type !== \"data\") {\n                            controller.enqueue(packet);\n                            return;\n                        }\n\n                        if (\n                            packet.pts !== undefined &&\n                            packet.pts & KEYFRAME_PTS\n                        ) {\n                            packet.keyframe = true;\n                            packet.pts &= ~KEYFRAME_PTS;\n                        }\n\n                        controller.enqueue(packet);\n                    },\n                }),\n            ),\n        };\n    }\n}\n","import { ScrcpyOptions1_21 } from \"./1_21.js\";\nimport type { ScrcpyOptionsInit1_23 } from \"./1_23.js\";\nimport { ScrcpyOptions1_23 } from \"./1_23.js\";\nimport { ScrcpyOptionsBase } from \"./types.js\";\n\nexport interface ScrcpyOptionsInit1_24 extends ScrcpyOptionsInit1_23 {\n    powerOn?: boolean;\n}\n\nexport class ScrcpyOptions1_24 extends ScrcpyOptionsBase<\n    ScrcpyOptionsInit1_24,\n    ScrcpyOptions1_23\n> {\n    static readonly DEFAULTS = {\n        ...ScrcpyOptions1_23.DEFAULTS,\n        powerOn: true,\n    } as const satisfies Required<ScrcpyOptionsInit1_24>;\n\n    override get defaults(): Required<ScrcpyOptionsInit1_24> {\n        return ScrcpyOptions1_24.DEFAULTS;\n    }\n\n    constructor(init: ScrcpyOptionsInit1_24) {\n        super(new ScrcpyOptions1_23(init), {\n            ...ScrcpyOptions1_24.DEFAULTS,\n            ...init,\n        });\n    }\n\n    override serialize(): string[] {\n        return ScrcpyOptions1_21.serialize(this.value, this.defaults);\n    }\n}\n","import Struct, {\n    NumberFieldDefinition,\n    NumberFieldType,\n} from \"@yume-chan/struct\";\n\nimport type { ScrcpyInjectScrollControlMessage } from \"../../control/index.js\";\nimport { ScrcpyControlMessageType } from \"../../control/index.js\";\nimport type { ScrcpyScrollController } from \"../1_16/index.js\";\nimport { clamp } from \"../1_16/index.js\";\n\nexport const ScrcpyFloatToInt16NumberType: NumberFieldType = {\n    size: 2,\n    signed: true,\n    deserialize(array, littleEndian) {\n        const value = NumberFieldType.Int16.deserialize(array, littleEndian);\n        // https://github.com/Genymobile/scrcpy/blob/1f138aef41de651668043b32c4effc2d4adbfc44/server/src/main/java/com/genymobile/scrcpy/Binary.java#L34\n        return value === 0x7fff ? 1 : value / 0x8000;\n    },\n    serialize(dataView, offset, value, littleEndian) {\n        // https://github.com/Genymobile/scrcpy/blob/1f138aef41de651668043b32c4effc2d4adbfc44/app/src/util/binary.h#L65\n        value = clamp(value, -1, 1);\n        value = value === 1 ? 0x7fff : value * 0x8000;\n        NumberFieldType.Int16.serialize(dataView, offset, value, littleEndian);\n    },\n};\n\nconst ScrcpyFloatToInt16FieldDefinition = new NumberFieldDefinition(\n    ScrcpyFloatToInt16NumberType,\n);\n\nexport const ScrcpyInjectScrollControlMessage1_25 = new Struct()\n    .uint8(\"type\", ScrcpyControlMessageType.InjectScroll as const)\n    .uint32(\"pointerX\")\n    .uint32(\"pointerY\")\n    .uint16(\"screenWidth\")\n    .uint16(\"screenHeight\")\n    .field(\"scrollX\", ScrcpyFloatToInt16FieldDefinition)\n    .field(\"scrollY\", ScrcpyFloatToInt16FieldDefinition)\n    .int32(\"buttons\");\n\nexport type ScrcpyInjectScrollControlMessage1_25 =\n    (typeof ScrcpyInjectScrollControlMessage1_25)[\"TInit\"];\n\nexport class ScrcpyScrollController1_25 implements ScrcpyScrollController {\n    serializeScrollMessage(\n        message: ScrcpyInjectScrollControlMessage,\n    ): Uint8Array | undefined {\n        return ScrcpyInjectScrollControlMessage1_25.serialize(message);\n    }\n}\n","import type { ScrcpyScrollController } from \"../1_16/index.js\";\nimport { ScrcpyOptions1_21 } from \"../1_21.js\";\nimport type { ScrcpyOptionsInit1_24 } from \"../1_24.js\";\nimport { ScrcpyOptions1_24 } from \"../1_24.js\";\nimport { ScrcpyOptionsBase } from \"../types.js\";\n\nimport { ScrcpyScrollController1_25 } from \"./scroll.js\";\n\nexport class ScrcpyOptions1_25 extends ScrcpyOptionsBase<\n    ScrcpyOptionsInit1_24,\n    ScrcpyOptions1_24\n> {\n    override get defaults(): Required<ScrcpyOptionsInit1_24> {\n        return ScrcpyOptions1_24.DEFAULTS;\n    }\n\n    constructor(init: ScrcpyOptionsInit1_24) {\n        super(new ScrcpyOptions1_24(init), {\n            ...ScrcpyOptions1_24.DEFAULTS,\n            ...init,\n        });\n    }\n\n    override serialize(): string[] {\n        return ScrcpyOptions1_21.serialize(this.value, this.defaults);\n    }\n\n    override createScrollController(): ScrcpyScrollController {\n        return new ScrcpyScrollController1_25();\n    }\n}\n","export * from \"./options.js\";\nexport * from \"./scroll.js\";\n","import type { ReadableStream } from \"@yume-chan/stream-extra\";\nimport {\n    BufferedReadableStream,\n    PushReadableStream,\n} from \"@yume-chan/stream-extra\";\nimport type { ValueOrPromise } from \"@yume-chan/struct\";\nimport Struct, { NumberFieldType, placeholder } from \"@yume-chan/struct\";\n\nimport type {\n    AndroidMotionEventAction,\n    ScrcpyInjectTouchControlMessage,\n} from \"../control/index.js\";\n\nimport {\n    CodecOptions,\n    ScrcpyFloatToUint16FieldDefinition,\n    ScrcpyOptions1_16,\n} from \"./1_16/index.js\";\nimport { ScrcpyOptions1_21 } from \"./1_21.js\";\nimport type { ScrcpyOptionsInit1_24 } from \"./1_24.js\";\nimport { ScrcpyOptions1_24 } from \"./1_24.js\";\nimport { ScrcpyOptions1_25 } from \"./1_25/index.js\";\nimport type { ScrcpyAudioStreamMetadata, ScrcpyVideoStream } from \"./codec.js\";\nimport { ScrcpyAudioCodec, ScrcpyVideoCodecId } from \"./codec.js\";\nimport type {\n    ScrcpyDisplay,\n    ScrcpyEncoder,\n    ScrcpyOptionValue,\n} from \"./types.js\";\nimport { ScrcpyOptionsBase } from \"./types.js\";\n\nexport const ScrcpyInjectTouchControlMessage2_0 = new Struct()\n    .uint8(\"type\")\n    .uint8(\"action\", placeholder<AndroidMotionEventAction>())\n    .uint64(\"pointerId\")\n    .uint32(\"pointerX\")\n    .uint32(\"pointerY\")\n    .uint16(\"screenWidth\")\n    .uint16(\"screenHeight\")\n    .field(\"pressure\", ScrcpyFloatToUint16FieldDefinition)\n    .uint32(\"actionButton\")\n    .uint32(\"buttons\");\n\nexport type ScrcpyInjectTouchControlMessage2_0 =\n    (typeof ScrcpyInjectTouchControlMessage2_0)[\"TInit\"];\n\nexport class ScrcpyInstanceId implements ScrcpyOptionValue {\n    static readonly NONE = new ScrcpyInstanceId(-1);\n\n    static random(): ScrcpyInstanceId {\n        // A random 31-bit unsigned integer\n        return new ScrcpyInstanceId((Math.random() * 0x80000000) | 0);\n    }\n\n    value: number;\n\n    constructor(value: number) {\n        this.value = value;\n    }\n\n    toOptionValue(): string | undefined {\n        if (this.value < 0) {\n            return undefined;\n        }\n        return this.value.toString(16);\n    }\n}\n\nexport interface ScrcpyOptionsInit2_0\n    extends Omit<\n        ScrcpyOptionsInit1_24,\n        \"bitRate\" | \"codecOptions\" | \"encoderName\"\n    > {\n    scid?: ScrcpyInstanceId;\n\n    videoCodec?: \"h264\" | \"h265\" | \"av1\";\n    videoBitRate?: number;\n    videoCodecOptions?: CodecOptions;\n    videoEncoder?: string;\n\n    audio?: boolean;\n    audioCodec?: \"opus\" | \"aac\" | \"raw\";\n    audioBitRate?: number;\n    audioCodecOptions?: CodecOptions;\n    audioEncoder?: string;\n\n    listEncoders?: boolean;\n    listDisplays?: boolean;\n    sendCodecMeta?: boolean;\n}\n\nfunction omit<T extends object, K extends keyof T>(\n    obj: T,\n    keys: K[],\n): Omit<T, K> {\n    const result: Record<PropertyKey, unknown> = {};\n    for (const key in obj) {\n        if (!keys.includes(key as keyof T as K)) {\n            result[key] = obj[key];\n        }\n    }\n    return result as Omit<T, K>;\n}\n\nexport class ScrcpyOptions2_0 extends ScrcpyOptionsBase<\n    ScrcpyOptionsInit2_0,\n    ScrcpyOptions1_25\n> {\n    static readonly DEFAULTS = {\n        ...omit(ScrcpyOptions1_24.DEFAULTS, [\n            \"bitRate\",\n            \"codecOptions\",\n            \"encoderName\",\n        ]),\n        scid: ScrcpyInstanceId.NONE,\n\n        videoCodec: \"h264\",\n        videoBitRate: 8000000,\n        videoCodecOptions: new CodecOptions(),\n        videoEncoder: \"\",\n\n        audio: true,\n        audioCodec: \"opus\",\n        audioBitRate: 128000,\n        audioCodecOptions: new CodecOptions(),\n        audioEncoder: \"\",\n\n        listEncoders: false,\n        listDisplays: false,\n        sendCodecMeta: true,\n    } as const satisfies Required<ScrcpyOptionsInit2_0>;\n\n    override get defaults(): Required<ScrcpyOptionsInit2_0> {\n        return ScrcpyOptions2_0.DEFAULTS;\n    }\n\n    constructor(init: ScrcpyOptionsInit2_0) {\n        super(new ScrcpyOptions1_25(init), {\n            ...ScrcpyOptions2_0.DEFAULTS,\n            ...init,\n        });\n    }\n\n    override serialize(): string[] {\n        return ScrcpyOptions1_21.serialize(this.value, this.defaults);\n    }\n\n    override setListEncoders(): void {\n        this.value.listEncoders = true;\n    }\n\n    override setListDisplays(): void {\n        this.value.listDisplays = true;\n    }\n\n    override parseEncoder(line: string): ScrcpyEncoder | undefined {\n        let match = line.match(\n            /\\s+--video-codec=(.*)\\s+--video-encoder='(.*)'/,\n        );\n        if (match) {\n            return {\n                type: \"video\",\n                codec: match[1]!,\n                name: match[2]!,\n            };\n        }\n\n        match = line.match(/\\s+--audio-codec=(.*)\\s+--audio-encoder='(.*)'/);\n        if (match) {\n            return {\n                type: \"audio\",\n                codec: match[1]!,\n                name: match[2]!,\n            };\n        }\n\n        return undefined;\n    }\n\n    override parseDisplay(line: string): ScrcpyDisplay | undefined {\n        const match = line.match(/\\s+--display=(\\d+)\\s+\\((.*?)\\)/);\n        if (match) {\n            const display: ScrcpyDisplay = {\n                id: Number.parseInt(match[1]!, 10),\n            };\n            if (match[2] !== \"size unknown\") {\n                display.resolution = match[2]!;\n            }\n            return display;\n        }\n        return undefined;\n    }\n\n    override parseVideoStreamMetadata(\n        stream: ReadableStream<Uint8Array>,\n    ): ValueOrPromise<ScrcpyVideoStream> {\n        const { sendDeviceMeta, sendCodecMeta } = this.value;\n        if (!sendDeviceMeta && !sendCodecMeta) {\n            let codec: ScrcpyVideoCodecId;\n            switch (this.value.videoCodec) {\n                case \"h264\":\n                    codec = ScrcpyVideoCodecId.H264;\n                    break;\n                case \"h265\":\n                    codec = ScrcpyVideoCodecId.H265;\n                    break;\n                case \"av1\":\n                    codec = ScrcpyVideoCodecId.AV1;\n                    break;\n            }\n            return { stream, metadata: { codec } };\n        }\n\n        return (async () => {\n            const buffered = new BufferedReadableStream(stream);\n\n            // `sendDeviceMeta` now only contains device name,\n            // can't use `super.parseVideoStreamMetadata` here\n            let deviceName: string | undefined;\n            if (sendDeviceMeta) {\n                deviceName = await ScrcpyOptions1_16.parseCString(buffered, 64);\n            }\n\n            let codec: ScrcpyVideoCodecId;\n            let width: number | undefined;\n            let height: number | undefined;\n            if (sendCodecMeta) {\n                codec = await ScrcpyOptions1_16.parseUint32BE(buffered);\n                width = await ScrcpyOptions1_16.parseUint32BE(buffered);\n                height = await ScrcpyOptions1_16.parseUint32BE(buffered);\n            } else {\n                switch (this.value.videoCodec) {\n                    case \"h264\":\n                        codec = ScrcpyVideoCodecId.H264;\n                        break;\n                    case \"h265\":\n                        codec = ScrcpyVideoCodecId.H265;\n                        break;\n                    case \"av1\":\n                        codec = ScrcpyVideoCodecId.AV1;\n                        break;\n                }\n            }\n\n            return {\n                stream: buffered.release(),\n                metadata: { deviceName, codec, width, height },\n            };\n        })();\n    }\n\n    override parseAudioStreamMetadata(\n        stream: ReadableStream<Uint8Array>,\n    ): ValueOrPromise<ScrcpyAudioStreamMetadata> {\n        return (async (): Promise<ScrcpyAudioStreamMetadata> => {\n            const buffered = new BufferedReadableStream(stream);\n            const buffer = await buffered.readExactly(\n                NumberFieldType.Uint32.size,\n            );\n\n            const codecMetadataValue = NumberFieldType.Uint32.deserialize(\n                buffer,\n                false,\n            );\n            // Server will send `0x00_00_00_00` and `0x00_00_00_01` even if `sendCodecMeta` is false\n            switch (codecMetadataValue) {\n                case 0x00_00_00_00:\n                    return {\n                        type: \"disabled\",\n                    };\n                case 0x00_00_00_01:\n                    return {\n                        type: \"errored\",\n                    };\n            }\n\n            if (this.value.sendCodecMeta) {\n                let codec: ScrcpyAudioCodec;\n                switch (codecMetadataValue) {\n                    case ScrcpyAudioCodec.OPUS.metadataValue:\n                        codec = ScrcpyAudioCodec.OPUS;\n                        break;\n                    case ScrcpyAudioCodec.AAC.metadataValue:\n                        codec = ScrcpyAudioCodec.AAC;\n                        break;\n                    case ScrcpyAudioCodec.RAW.metadataValue:\n                        codec = ScrcpyAudioCodec.RAW;\n                        break;\n                    default:\n                        throw new Error(\n                            `Unknown audio codec metadata value: ${codecMetadataValue}`,\n                        );\n                }\n                return {\n                    type: \"success\",\n                    codec,\n                    stream: buffered.release(),\n                };\n            }\n\n            // Infer codec from `audioCodec` option\n            let codec: ScrcpyAudioCodec;\n            switch (this.value.audioCodec) {\n                case \"opus\":\n                    codec = ScrcpyAudioCodec.OPUS;\n                    break;\n                case \"aac\":\n                    codec = ScrcpyAudioCodec.AAC;\n                    break;\n                case \"raw\":\n                    codec = ScrcpyAudioCodec.RAW;\n                    break;\n            }\n            return {\n                type: \"success\",\n                codec,\n                stream: new PushReadableStream<Uint8Array>(\n                    async (controller) => {\n                        // Put the first 4 bytes back\n                        await controller.enqueue(buffer);\n\n                        const stream = buffered.release();\n                        const reader = stream.getReader();\n                        while (true) {\n                            const { done, value } = await reader.read();\n                            if (done) {\n                                break;\n                            }\n                            await controller.enqueue(value);\n                        }\n                    },\n                ),\n            };\n        })();\n    }\n\n    override serializeInjectTouchControlMessage(\n        message: ScrcpyInjectTouchControlMessage,\n    ): Uint8Array {\n        return ScrcpyInjectTouchControlMessage2_0.serialize(message);\n    }\n}\n","import { ScrcpyOptions1_21 } from \"./1_21.js\";\nimport type { ScrcpyOptionsInit2_0 } from \"./2_0.js\";\nimport { ScrcpyOptions2_0 } from \"./2_0.js\";\nimport { ScrcpyOptionsBase } from \"./types.js\";\n\nexport interface ScrcpyOptionsInit2_1 extends ScrcpyOptionsInit2_0 {\n    video?: boolean;\n    audioSource?: \"output\" | \"mic\";\n}\n\nexport class ScrcpyOptions2_1 extends ScrcpyOptionsBase<\n    ScrcpyOptionsInit2_1,\n    ScrcpyOptions2_0\n> {\n    static readonly DEFAULTS = {\n        ...ScrcpyOptions2_0.DEFAULTS,\n        video: true,\n        audioSource: \"output\",\n    } as const satisfies Required<ScrcpyOptionsInit2_1>;\n\n    override get defaults(): Required<ScrcpyOptionsInit2_1> {\n        return ScrcpyOptions2_1.DEFAULTS;\n    }\n\n    constructor(init: ScrcpyOptionsInit2_1) {\n        super(new ScrcpyOptions2_0(init), {\n            ...ScrcpyOptions2_1.DEFAULTS,\n            ...init,\n        });\n    }\n\n    override serialize(): string[] {\n        return ScrcpyOptions1_21.serialize(this.value, this.defaults);\n    }\n}\n","import { ScrcpyLogLevel1_18, ScrcpyVideoOrientation1_18 } from \"./1_18.js\";\nimport type { ScrcpyOptionsInit2_1 } from \"./2_1.js\";\nimport { ScrcpyOptions2_1 } from \"./2_1.js\";\n\nexport const ScrcpyLogLevel = ScrcpyLogLevel1_18;\nexport type ScrcpyLogLevel = ScrcpyLogLevel1_18;\n\nexport const ScrcpyVideoOrientation = ScrcpyVideoOrientation1_18;\nexport type ScrcpyVideoOrientation = ScrcpyVideoOrientation1_18;\n\nexport type ScrcpyOptionsInitLatest = ScrcpyOptionsInit2_1;\nexport class ScrcpyOptionsLatest extends ScrcpyOptions2_1 {}\n\nexport const ScrcpyLatestVersion = \"2.1\";\n","export * from \"./1_16/index.js\";\nexport * from \"./1_17.js\";\nexport * from \"./1_18.js\";\nexport * from \"./1_21.js\";\nexport * from \"./1_22/index.js\";\nexport * from \"./1_23.js\";\nexport * from \"./1_24.js\";\nexport * from \"./1_25/index.js\";\nexport * from \"./2_0.js\";\nexport * from \"./2_1.js\";\nexport * from \"./codec.js\";\nexport * from \"./latest.js\";\nexport * from \"./types.js\";\n","export * from \"./codec/index.js\";\nexport * from \"./control/index.js\";\nexport * from \"./device-message/index.js\";\nexport * from \"./options/index.js\";\n","import type {\n    ScrcpyMediaStreamDataPacket,\n    ScrcpyMediaStreamPacket,\n} from \"@yume-chan/scrcpy\";\nimport {\n    ScrcpyVideoCodecId,\n    h264ParseConfiguration,\n    h265ParseConfiguration,\n} from \"@yume-chan/scrcpy\";\nimport type {\n    ScrcpyVideoDecoder,\n    ScrcpyVideoDecoderCapability,\n} from \"@yume-chan/scrcpy-decoder-tinyh264\";\nimport { WritableStream } from \"@yume-chan/stream-extra\";\n\nfunction toHex(value: number) {\n    return value.toString(16).padStart(2, \"0\").toUpperCase();\n}\n\nfunction toUint32Le(data: Uint8Array, offset: number) {\n    return (\n        data[offset]! |\n        (data[offset + 1]! << 8) |\n        (data[offset + 2]! << 16) |\n        (data[offset + 3]! << 24)\n    );\n}\n\nexport class WebCodecsDecoder implements ScrcpyVideoDecoder {\n    static isSupported() {\n        return typeof globalThis.VideoDecoder !== \"undefined\";\n    }\n\n    static readonly capabilities: Record<string, ScrcpyVideoDecoderCapability> =\n        {\n            h264: {},\n            h265: {},\n        };\n\n    #codec: ScrcpyVideoCodecId;\n    get codec() {\n        return this.#codec;\n    }\n\n    #writable: WritableStream<ScrcpyMediaStreamPacket>;\n    get writable() {\n        return this.#writable;\n    }\n\n    #renderer: HTMLCanvasElement;\n    get renderer() {\n        return this.#renderer;\n    }\n\n    #frameRendered = 0;\n    get frameRendered() {\n        return this.#frameRendered;\n    }\n\n    #frameSkipped = 0;\n    get frameSkipped() {\n        return this.#frameSkipped;\n    }\n\n    #context: CanvasRenderingContext2D;\n    #decoder: VideoDecoder;\n    #config: Uint8Array | undefined;\n\n    #currentFrameRendered = false;\n    #animationFrameId = 0;\n\n    constructor(codec: ScrcpyVideoCodecId) {\n        this.#codec = codec;\n\n        this.#renderer = document.createElement(\"canvas\");\n\n        this.#context = this.#renderer.getContext(\"2d\")!;\n        this.#decoder = new VideoDecoder({\n            output: (frame) => {\n                if (this.#currentFrameRendered) {\n                    this.#frameSkipped += 1;\n                } else {\n                    this.#currentFrameRendered = true;\n                    this.#frameRendered += 1;\n                }\n\n                // PERF: H.264 renderer may draw multiple frames in one vertical sync interval to minimize latency.\n                // When multiple frames are drawn in one vertical sync interval,\n                // only the last one is visible to users.\n                // But this ensures users can always see the most up-to-date screen.\n                // This is also the behavior of official Scrcpy client.\n                // https://github.com/Genymobile/scrcpy/issues/3679\n                this.#context.drawImage(frame, 0, 0);\n                frame.close();\n            },\n            error(e) {\n                void e;\n            },\n        });\n\n        this.#writable = new WritableStream<ScrcpyMediaStreamPacket>({\n            write: (packet) => {\n                switch (packet.type) {\n                    case \"configuration\":\n                        this.#configure(packet.data);\n                        break;\n                    case \"data\":\n                        this.#decode(packet);\n                        break;\n                }\n            },\n        });\n\n        this.#onFramePresented();\n    }\n\n    #onFramePresented = () => {\n        this.#currentFrameRendered = false;\n        this.#animationFrameId = requestAnimationFrame(this.#onFramePresented);\n    };\n\n    #configure(data: Uint8Array) {\n        switch (this.#codec) {\n            case ScrcpyVideoCodecId.H264: {\n                const {\n                    profileIndex,\n                    constraintSet,\n                    levelIndex,\n                    croppedWidth,\n                    croppedHeight,\n                } = h264ParseConfiguration(data);\n\n                this.#renderer.width = croppedWidth;\n                this.#renderer.height = croppedHeight;\n\n                // https://www.rfc-editor.org/rfc/rfc6381#section-3.3\n                // ISO Base Media File Format Name Space\n                const codec = `avc1.${[profileIndex, constraintSet, levelIndex]\n                    .map(toHex)\n                    .join(\"\")}`;\n                this.#decoder.configure({\n                    codec: codec,\n                    optimizeForLatency: true,\n                });\n                break;\n            }\n            case ScrcpyVideoCodecId.H265: {\n                const {\n                    generalProfileSpace,\n                    generalProfileIndex,\n                    generalProfileCompatibilitySet,\n                    generalTierFlag,\n                    generalLevelIndex,\n                    generalConstraintSet,\n                    croppedWidth,\n                    croppedHeight,\n                } = h265ParseConfiguration(data);\n\n                this.#renderer.width = croppedWidth;\n                this.#renderer.height = croppedHeight;\n\n                const codec = [\n                    \"hev1\",\n                    [\"\", \"A\", \"B\", \"C\"][generalProfileSpace]! +\n                        generalProfileIndex.toString(),\n                    toUint32Le(generalProfileCompatibilitySet, 0).toString(16),\n                    (generalTierFlag ? \"H\" : \"L\") +\n                        generalLevelIndex.toString(),\n                    toUint32Le(generalConstraintSet, 0)\n                        .toString(16)\n                        .toUpperCase(),\n                    toUint32Le(generalConstraintSet, 4)\n                        .toString(16)\n                        .toUpperCase(),\n                ].join(\".\");\n                this.#decoder.configure({\n                    codec,\n                    optimizeForLatency: true,\n                });\n                break;\n            }\n        }\n        this.#config = data;\n    }\n\n    #decode(packet: ScrcpyMediaStreamDataPacket) {\n        if (this.#decoder.state !== \"configured\") {\n            return;\n        }\n\n        // WebCodecs requires configuration data to be with the first frame.\n        // https://www.w3.org/TR/webcodecs-avc-codec-registration/#encodedvideochunk-type\n        let data: Uint8Array;\n        if (this.#config !== undefined) {\n            data = new Uint8Array(\n                this.#config.byteLength + packet.data.byteLength,\n            );\n            data.set(this.#config, 0);\n            data.set(packet.data, this.#config.byteLength);\n            this.#config = undefined;\n        } else {\n            data = packet.data;\n        }\n\n        this.#decoder.decode(\n            new EncodedVideoChunk({\n                // Treat `undefined` as `key`, otherwise won't decode.\n                type: packet.keyframe === false ? \"delta\" : \"key\",\n                timestamp: 0,\n                data,\n            }),\n        );\n    }\n\n    dispose() {\n        cancelAnimationFrame(this.#animationFrameId);\n        if (this.#decoder.state !== \"closed\") {\n            this.#decoder.close();\n        }\n    }\n}\n","// cspell: ignore MPEGH\n// cspell: ignore rbsp\n// cspell: ignore Nalus\n\nimport {\n    H265NaluRaw,\n    ScrcpyAudioCodec,\n    ScrcpyMediaStreamDataPacket,\n    ScrcpyMediaStreamPacket,\n    ScrcpyVideoCodecId,\n    ScrcpyVideoStreamMetadata,\n    annexBSplitNalu,\n    h264SearchConfiguration,\n    h265ParseSequenceParameterSet,\n    h265ParseVideoParameterSet,\n    h265SearchConfiguration,\n} from \"@yume-chan/scrcpy\";\nimport { action, makeAutoObservable, reaction } from \"mobx\";\nimport { ArrayBufferTarget, Muxer as WebMMuxer } from \"webm-muxer\";\nimport { saveFile } from \"../../utils\";\n\n// https://ffmpeg.org/doxygen/0.11/avc_8c-source.html#l00106\nfunction h264ConfigurationToAvcDecoderConfigurationRecord(\n    sequenceParameterSet: Uint8Array,\n    pictureParameterSet: Uint8Array\n) {\n    const buffer = new Uint8Array(\n        11 + sequenceParameterSet.byteLength + pictureParameterSet.byteLength\n    );\n    buffer[0] = 1;\n    buffer[1] = sequenceParameterSet[1];\n    buffer[2] = sequenceParameterSet[2];\n    buffer[3] = sequenceParameterSet[3];\n    buffer[4] = 0xff;\n    buffer[5] = 0xe1;\n    buffer[6] = sequenceParameterSet.byteLength >> 8;\n    buffer[7] = sequenceParameterSet.byteLength & 0xff;\n    buffer.set(sequenceParameterSet, 8);\n    buffer[8 + sequenceParameterSet.byteLength] = 1;\n    buffer[9 + sequenceParameterSet.byteLength] =\n        pictureParameterSet.byteLength >> 8;\n    buffer[10 + sequenceParameterSet.byteLength] =\n        pictureParameterSet.byteLength & 0xff;\n    buffer.set(pictureParameterSet, 11 + sequenceParameterSet.byteLength);\n    return buffer;\n}\n\nfunction h265ConfigurationToHevcDecoderConfigurationRecord(\n    videoParameterSet: H265NaluRaw,\n    sequenceParameterSet: H265NaluRaw,\n    pictureParameterSet: H265NaluRaw\n) {\n    const {\n        profileTierLevel: {\n            generalProfileTier: {\n                profile_space: general_profile_space,\n                tier_flag: general_tier_flag,\n                profile_idc: general_profile_idc,\n                profileCompatibilitySet: generalProfileCompatibilitySet,\n                constraintSet: generalConstraintSet,\n            },\n            general_level_idc,\n        },\n        vps_max_layers_minus1,\n        vps_temporal_id_nesting_flag,\n    } = h265ParseVideoParameterSet(videoParameterSet.rbsp);\n\n    const {\n        chroma_format_idc,\n        bit_depth_luma_minus8,\n        bit_depth_chroma_minus8,\n        vuiParameters: { min_spatial_segmentation_idc = 0 } = {},\n    } = h265ParseSequenceParameterSet(sequenceParameterSet.rbsp);\n\n    const buffer = new Uint8Array(\n        23 +\n            5 * 3 +\n            videoParameterSet.data.length +\n            sequenceParameterSet.data.length +\n            pictureParameterSet.data.length\n    );\n\n    /* unsigned int(8) configurationVersion = 1; */\n    buffer[0] = 1;\n\n    /*\n     * unsigned int(2) general_profile_space;\n     * unsigned int(1) general_tier_flag;\n     * unsigned int(5) general_profile_idc;\n     */\n    buffer[1] =\n        (general_profile_space << 6) |\n        (Number(general_tier_flag) << 5) |\n        general_profile_idc;\n\n    /* unsigned int(32) general_profile_compatibility_flags; */\n    buffer[2] = generalProfileCompatibilitySet[0];\n    buffer[3] = generalProfileCompatibilitySet[1];\n    buffer[4] = generalProfileCompatibilitySet[2];\n    buffer[5] = generalProfileCompatibilitySet[3];\n\n    /* unsigned int(48) general_constraint_indicator_flags; */\n    buffer[6] = generalConstraintSet[0];\n    buffer[7] = generalConstraintSet[1];\n    buffer[8] = generalConstraintSet[2];\n    buffer[9] = generalConstraintSet[3];\n    buffer[10] = generalConstraintSet[4];\n    buffer[11] = generalConstraintSet[5];\n\n    /* unsigned int(8) general_level_idc; */\n    buffer[12] = general_level_idc;\n\n    /*\n     * bit(4) reserved = '1111'b;\n     * unsigned int(12) min_spatial_segmentation_idc;\n     */\n    buffer[13] = 0xf0 | (min_spatial_segmentation_idc >> 8);\n    buffer[14] = min_spatial_segmentation_idc;\n\n    /*\n     * bit(6) reserved = '111111'b;\n     * unsigned int(2) parallelismType;\n     */\n    buffer[15] = 0xfc;\n\n    /*\n     * bit(6) reserved = '111111'b;\n     * unsigned int(2) chromaFormat;\n     */\n    buffer[16] = 0xfc | chroma_format_idc;\n\n    /*\n     * bit(5) reserved = '11111'b;\n     * unsigned int(3) bitDepthLumaMinus8;\n     */\n    buffer[17] = 0xf8 | bit_depth_luma_minus8;\n\n    /*\n     * bit(5) reserved = '11111'b;\n     * unsigned int(3) bitDepthChromaMinus8;\n     */\n    buffer[18] = 0xf8 | bit_depth_chroma_minus8;\n\n    /* bit(16) avgFrameRate; */\n    buffer[19] = 0;\n    buffer[20] = 0;\n\n    /*\n     * bit(2) constantFrameRate;\n     * bit(3) numTemporalLayers;\n     * bit(1) temporalIdNested;\n     * unsigned int(2) lengthSizeMinusOne;\n     */\n    buffer[21] =\n        ((vps_max_layers_minus1 + 1) << 3) |\n        (Number(vps_temporal_id_nesting_flag) << 2) |\n        3;\n\n    /* unsigned int(8) numOfArrays; */\n    buffer[22] = 3;\n\n    let i = 23;\n\n    for (const nalu of [\n        videoParameterSet,\n        sequenceParameterSet,\n        pictureParameterSet,\n    ]) {\n        /*\n         * bit(1) array_completeness;\n         * unsigned int(1) reserved = 0;\n         * unsigned int(6) NAL_unit_type;\n         */\n        buffer[i] = nalu.nal_unit_type;\n        i += 1;\n\n        /* unsigned int(16) numNalus; */\n        buffer[i] = 0;\n        i += 1;\n        buffer[i] = 1;\n        i += 1;\n\n        /* unsigned int(16) nalUnitLength; */\n        buffer[i] = nalu.data.length >> 8;\n        i += 1;\n        buffer[i] = nalu.data.length;\n        i += 1;\n\n        buffer.set(nalu.data, i);\n        i += nalu.data.length;\n    }\n\n    return buffer;\n}\n\nfunction h264StreamToAvcSample(buffer: Uint8Array) {\n    const nalUnits: Uint8Array[] = [];\n    let totalLength = 0;\n\n    for (const unit of annexBSplitNalu(buffer)) {\n        nalUnits.push(unit);\n        totalLength += unit.byteLength + 4;\n    }\n\n    const sample = new Uint8Array(totalLength);\n    let offset = 0;\n    for (const nalu of nalUnits) {\n        sample[offset] = nalu.byteLength >> 24;\n        sample[offset + 1] = nalu.byteLength >> 16;\n        sample[offset + 2] = nalu.byteLength >> 8;\n        sample[offset + 3] = nalu.byteLength & 0xff;\n        sample.set(nalu, offset + 4);\n        offset += 4 + nalu.byteLength;\n    }\n    return sample;\n}\n\n// https://github.com/FFmpeg/FFmpeg/blob/adb5f7b41faf354a3e0bf722f44aeb230aefa310/libavformat/matroska.c\nconst MatroskaVideoCodecNameMap: Record<ScrcpyVideoCodecId, string> = {\n    [ScrcpyVideoCodecId.H264]: \"V_MPEG4/ISO/AVC\",\n    [ScrcpyVideoCodecId.H265]: \"V_MPEGH/ISO/HEVC\",\n    [ScrcpyVideoCodecId.AV1]: \"V_AV1\",\n};\n\nconst MatroskaAudioCodecNameMap: Record<string, string> = {\n    [ScrcpyAudioCodec.RAW.mimeType]: \"A_PCM/INT/LIT\",\n    [ScrcpyAudioCodec.AAC.mimeType]: \"A_AAC\",\n    [ScrcpyAudioCodec.OPUS.mimeType]: \"A_OPUS\",\n};\n\nexport class MatroskaMuxingRecorder {\n    public running = false;\n\n    public videoMetadata: ScrcpyVideoStreamMetadata | undefined;\n    public audioCodec: ScrcpyAudioCodec | undefined;\n\n    private muxer: WebMMuxer<ArrayBufferTarget> | undefined;\n    private videoCodecDescription: Uint8Array | undefined;\n    private configurationWritten = false;\n    private _firstTimestamp = -1;\n    private _packetsFromLastKeyframe: {\n        type: \"video\" | \"audio\";\n        packet: ScrcpyMediaStreamDataPacket;\n    }[] = [];\n\n    private addVideoChunk(packet: ScrcpyMediaStreamDataPacket) {\n        if (this._firstTimestamp === -1) {\n            this._firstTimestamp = Number(packet.pts!);\n        }\n\n        const sample = h264StreamToAvcSample(packet.data);\n        this.muxer!.addVideoChunkRaw(\n            sample,\n            packet.keyframe ? \"key\" : \"delta\",\n            Number(packet.pts) - this._firstTimestamp,\n            this.configurationWritten\n                ? undefined\n                : {\n                      decoderConfig: {\n                          // Not used\n                          codec: \"\",\n                          description: this.videoCodecDescription,\n                      },\n                  }\n        );\n        this.configurationWritten = true;\n    }\n\n    public addVideoPacket(packet: ScrcpyMediaStreamPacket) {\n        if (!this.videoMetadata) {\n            throw new Error(\"videoMetadata must be set\");\n        }\n\n        try {\n            if (packet.type === \"configuration\") {\n                switch (this.videoMetadata.codec) {\n                    case ScrcpyVideoCodecId.H264: {\n                        const { sequenceParameterSet, pictureParameterSet } =\n                            h264SearchConfiguration(packet.data);\n                        this.videoCodecDescription =\n                            h264ConfigurationToAvcDecoderConfigurationRecord(\n                                sequenceParameterSet,\n                                pictureParameterSet\n                            );\n                        this.configurationWritten = false;\n                        break;\n                    }\n                    case ScrcpyVideoCodecId.H265: {\n                        const {\n                            videoParameterSet,\n                            sequenceParameterSet,\n                            pictureParameterSet,\n                        } = h265SearchConfiguration(packet.data);\n                        this.videoCodecDescription =\n                            h265ConfigurationToHevcDecoderConfigurationRecord(\n                                videoParameterSet,\n                                sequenceParameterSet,\n                                pictureParameterSet\n                            );\n                        this.configurationWritten = false;\n                        break;\n                    }\n                }\n                return;\n            }\n\n            // To ensure the first frame is a keyframe\n            // save the last keyframe and the following frames\n            if (packet.keyframe === true) {\n                this._packetsFromLastKeyframe.length = 0;\n            }\n            this._packetsFromLastKeyframe.push({ type: \"video\", packet });\n\n            if (!this.muxer) {\n                return;\n            }\n\n            this.addVideoChunk(packet);\n        } catch (e) {\n            console.error(e);\n        }\n    }\n\n    private addAudioChunk(chunk: ScrcpyMediaStreamDataPacket) {\n        if (this._firstTimestamp === -1) {\n            return;\n        }\n\n        const timestamp = Number(chunk.pts) - this._firstTimestamp;\n        if (timestamp < 0) {\n            return;\n        }\n\n        if (!this.muxer) {\n            return;\n        }\n\n        this.muxer.addAudioChunkRaw(chunk.data, \"key\", timestamp);\n    }\n\n    public addAudioPacket(packet: ScrcpyMediaStreamDataPacket) {\n        this._packetsFromLastKeyframe.push({ type: \"audio\", packet });\n        this.addAudioChunk(packet);\n    }\n\n    public start() {\n        if (!this.videoMetadata) {\n            throw new Error(\"videoMetadata must be set\");\n        }\n\n        this.running = true;\n\n        const options: ConstructorParameters<typeof WebMMuxer>[0] = {\n            target: new ArrayBufferTarget(),\n            type: \"matroska\",\n            firstTimestampBehavior: \"permissive\",\n            video: {\n                codec: MatroskaVideoCodecNameMap[this.videoMetadata.codec!],\n                width: this.videoMetadata.width ?? 0,\n                height: this.videoMetadata.height ?? 0,\n            },\n        };\n\n        if (this.audioCodec) {\n            options.audio = {\n                codec: MatroskaAudioCodecNameMap[this.audioCodec.mimeType!],\n                sampleRate: 48000,\n                numberOfChannels: 2,\n                bitDepth:\n                    this.audioCodec === ScrcpyAudioCodec.RAW ? 16 : undefined,\n            };\n        }\n\n        this.muxer = new WebMMuxer(options as any);\n\n        if (this._packetsFromLastKeyframe.length > 0) {\n            for (const { type, packet } of this._packetsFromLastKeyframe) {\n                if (type === \"video\") {\n                    this.addVideoChunk(packet);\n                } else {\n                    this.addAudioChunk(packet);\n                }\n            }\n        }\n    }\n\n    public stop() {\n        if (!this.muxer) {\n            return;\n        }\n\n        this.muxer.finalize()!;\n        const buffer = this.muxer.target.buffer;\n        const now = new Date();\n        const stream = saveFile(\n            // prettier-ignore\n            `Recording ${\n                now.getFullYear()\n            }-${\n                (now.getMonth() + 1).toString().padStart(2, '0')\n            }-${\n                now.getDate().toString().padStart(2, '0')\n            } ${\n                now.getHours().toString().padStart(2, '0')\n            }-${\n                now.getMinutes().toString().padStart(2, '0')\n            }-${\n                now.getSeconds().toString().padStart(2, '0')\n            }.mkv`\n        );\n        const writer = stream.getWriter();\n        writer.write(new Uint8Array(buffer));\n        writer.close();\n\n        this.muxer = undefined;\n        this.configurationWritten = false;\n        this.running = false;\n    }\n}\n\nexport const RECORD_STATE = makeAutoObservable({\n    recorder: new MatroskaMuxingRecorder(),\n    recording: false,\n    intervalId: -1,\n    hours: 0,\n    minutes: 0,\n    seconds: 0,\n});\n\nreaction(\n    () => RECORD_STATE.recording,\n    (recording) => {\n        if (recording) {\n            RECORD_STATE.intervalId = globalThis.setInterval(\n                action(() => {\n                    RECORD_STATE.seconds += 1;\n                    if (RECORD_STATE.seconds >= 60) {\n                        RECORD_STATE.seconds = 0;\n                        RECORD_STATE.minutes += 1;\n                    }\n                    if (RECORD_STATE.minutes >= 60) {\n                        RECORD_STATE.minutes = 0;\n                        RECORD_STATE.hours += 1;\n                    }\n                }),\n                1000\n            ) as unknown as number;\n        } else {\n            globalThis.clearInterval(RECORD_STATE.intervalId);\n            RECORD_STATE.intervalId = -1;\n            RECORD_STATE.hours = 0;\n            RECORD_STATE.minutes = 0;\n            RECORD_STATE.seconds = 0;\n        }\n    }\n);\n","import type { Adb, AdbSubprocessProtocol } from \"@yume-chan/adb\";\nimport {\n    AdbReverseNotSupportedError,\n    AdbSubprocessNoneProtocol,\n} from \"@yume-chan/adb\";\nimport type {\n    ScrcpyAudioStreamDisabledMetadata,\n    ScrcpyAudioStreamErroredMetadata,\n    ScrcpyAudioStreamSuccessMetadata,\n    ScrcpyDeviceMessage,\n    ScrcpyDisplay,\n    ScrcpyEncoder,\n    ScrcpyMediaStreamPacket,\n    ScrcpyVideoStreamMetadata,\n} from \"@yume-chan/scrcpy\";\nimport {\n    DEFAULT_SERVER_PATH,\n    ScrcpyControlMessageWriter,\n    ScrcpyDeviceMessageDeserializeStream,\n    ScrcpyVideoCodecId,\n    h264ParseConfiguration,\n    h265ParseConfiguration,\n} from \"@yume-chan/scrcpy\";\nimport type {\n    Consumable,\n    ReadableStream,\n    ReadableWritablePair,\n} from \"@yume-chan/stream-extra\";\nimport {\n    AbortController,\n    DecodeUtf8Stream,\n    InspectStream,\n    PushReadableStream,\n    SplitStringStream,\n    WritableStream,\n} from \"@yume-chan/stream-extra\";\n\nimport type { AdbScrcpyConnection } from \"./connection.js\";\nimport type { AdbScrcpyOptions } from \"./options/index.js\";\n\nfunction arrayToStream<T>(array: T[]): ReadableStream<T> {\n    return new PushReadableStream(async (controller) => {\n        for (const item of array) {\n            await controller.enqueue(item);\n        }\n    });\n}\n\nfunction concatStreams<T>(...streams: ReadableStream<T>[]): ReadableStream<T> {\n    return new PushReadableStream(async (controller) => {\n        for (const stream of streams) {\n            const reader = stream.getReader();\n            while (true) {\n                const { done, value } = await reader.read();\n                if (done) {\n                    break;\n                }\n                await controller.enqueue(value);\n            }\n        }\n    });\n}\n\nexport class AdbScrcpyExitedError extends Error {\n    output: string[];\n\n    constructor(output: string[]) {\n        super(\"scrcpy server exited prematurely\");\n        this.output = output;\n    }\n}\n\ninterface AdbScrcpyClientInit {\n    options: AdbScrcpyOptions<object>;\n    process: AdbSubprocessProtocol;\n    stdout: ReadableStream<string>;\n\n    videoStream: ReadableStream<Uint8Array> | undefined;\n    audioStream: ReadableStream<Uint8Array> | undefined;\n    controlStream:\n        | ReadableWritablePair<Uint8Array, Consumable<Uint8Array>>\n        | undefined;\n}\n\nexport interface AdbScrcpyVideoStream {\n    stream: ReadableStream<ScrcpyMediaStreamPacket>;\n    metadata: ScrcpyVideoStreamMetadata;\n}\n\nexport interface AdbScrcpyAudioStreamSuccessMetadata\n    extends Omit<ScrcpyAudioStreamSuccessMetadata, \"stream\"> {\n    readonly stream: ReadableStream<ScrcpyMediaStreamPacket>;\n}\n\nexport type AdbScrcpyAudioStreamMetadata =\n    | ScrcpyAudioStreamDisabledMetadata\n    | ScrcpyAudioStreamErroredMetadata\n    | AdbScrcpyAudioStreamSuccessMetadata;\n\nexport class AdbScrcpyClient {\n    static async pushServer(\n        adb: Adb,\n        file: ReadableStream<Consumable<Uint8Array>>,\n        filename = DEFAULT_SERVER_PATH,\n    ) {\n        const sync = await adb.sync();\n        try {\n            await sync.write({\n                filename,\n                file,\n            });\n        } finally {\n            await sync.dispose();\n        }\n    }\n\n    static async start(\n        adb: Adb,\n        path: string,\n        version: string,\n        options: AdbScrcpyOptions<object>,\n    ) {\n        let connection: AdbScrcpyConnection | undefined;\n        let process: AdbSubprocessProtocol | undefined;\n\n        try {\n            try {\n                connection = options.createConnection(adb);\n                await connection.initialize();\n            } catch (e) {\n                if (e instanceof AdbReverseNotSupportedError) {\n                    // When reverse tunnel is not supported, try forward tunnel.\n                    options.tunnelForwardOverride = true;\n                    connection = options.createConnection(adb);\n                    await connection.initialize();\n                } else {\n                    connection = undefined;\n                    throw e;\n                }\n            }\n\n            process = await adb.subprocess.spawn(\n                [\n                    // cspell: disable-next-line\n                    `CLASSPATH=${path}`,\n                    \"app_process\",\n                    /* unused */ \"/\",\n                    \"com.genymobile.scrcpy.Server\",\n                    version,\n                    ...options.serialize(),\n                ],\n                {\n                    // Scrcpy server doesn't use stderr,\n                    // so disable Shell Protocol to simplify processing\n                    protocols: [AdbSubprocessNoneProtocol],\n                },\n            );\n\n            const stdout = process.stdout\n                .pipeThrough(new DecodeUtf8Stream())\n                .pipeThrough(new SplitStringStream(\"\\n\"));\n\n            // Must read all streams, otherwise the whole connection will be blocked.\n            const output: string[] = [];\n            const abortController = new AbortController();\n            const pipe = stdout\n                .pipeTo(\n                    new WritableStream({\n                        write(chunk) {\n                            output.push(chunk);\n                        },\n                    }),\n                    {\n                        signal: abortController.signal,\n                        preventCancel: true,\n                    },\n                )\n                .catch((e) => {\n                    if (abortController.signal.aborted) {\n                        return;\n                    }\n\n                    throw e;\n                });\n\n            const streams = await Promise.race([\n                process.exit.then(() => {\n                    throw new AdbScrcpyExitedError(output);\n                }),\n                connection.getStreams(),\n            ]);\n\n            abortController.abort();\n            await pipe;\n\n            return new AdbScrcpyClient({\n                options,\n                process,\n                stdout: concatStreams(arrayToStream(output), stdout),\n                videoStream: streams.video,\n                audioStream: streams.audio,\n                controlStream: streams.control,\n            });\n        } catch (e) {\n            await process?.kill();\n            throw e;\n        } finally {\n            connection?.dispose();\n        }\n    }\n\n    /**\n     * This method will modify the given `options`,\n     * so don't reuse it elsewhere.\n     */\n    static async getEncoders(\n        adb: Adb,\n        path: string,\n        version: string,\n        options: AdbScrcpyOptions<object>,\n    ): Promise<ScrcpyEncoder[]> {\n        options.setListEncoders();\n        return await options.getEncoders(adb, path, version);\n    }\n\n    /**\n     * This method will modify the given `options`,\n     * so don't reuse it elsewhere.\n     */\n    static async getDisplays(\n        adb: Adb,\n        path: string,\n        version: string,\n        options: AdbScrcpyOptions<object>,\n    ): Promise<ScrcpyDisplay[]> {\n        options.setListDisplays();\n        return await options.getDisplays(adb, path, version);\n    }\n\n    #options: AdbScrcpyOptions<object>;\n    #process: AdbSubprocessProtocol;\n\n    #stdout: ReadableStream<string>;\n    get stdout() {\n        return this.#stdout;\n    }\n\n    get exit() {\n        return this.#process.exit;\n    }\n\n    #screenWidth: number | undefined;\n    get screenWidth() {\n        return this.#screenWidth;\n    }\n\n    #screenHeight: number | undefined;\n    get screenHeight() {\n        return this.#screenHeight;\n    }\n\n    #videoStream: Promise<AdbScrcpyVideoStream> | undefined;\n    get videoStream() {\n        return this.#videoStream;\n    }\n\n    #audioStream: Promise<AdbScrcpyAudioStreamMetadata> | undefined;\n    get audioStream() {\n        return this.#audioStream;\n    }\n\n    #controlMessageWriter: ScrcpyControlMessageWriter | undefined;\n    get controlMessageWriter() {\n        return this.#controlMessageWriter;\n    }\n\n    #deviceMessageStream: ReadableStream<ScrcpyDeviceMessage> | undefined;\n    get deviceMessageStream() {\n        return this.#deviceMessageStream;\n    }\n\n    constructor({\n        options,\n        process,\n        stdout,\n        videoStream,\n        audioStream,\n        controlStream,\n    }: AdbScrcpyClientInit) {\n        this.#options = options;\n        this.#process = process;\n        this.#stdout = stdout;\n\n        this.#videoStream = videoStream\n            ? this.#createVideoStream(videoStream)\n            : undefined;\n\n        this.#audioStream = audioStream\n            ? this.#createAudioStream(audioStream)\n            : undefined;\n\n        if (controlStream) {\n            this.#controlMessageWriter = new ScrcpyControlMessageWriter(\n                controlStream.writable.getWriter(),\n                options,\n            );\n            this.#deviceMessageStream = controlStream.readable.pipeThrough(\n                new ScrcpyDeviceMessageDeserializeStream(),\n            );\n        }\n    }\n\n    async #createVideoStream(initialStream: ReadableStream<Uint8Array>) {\n        const { stream, metadata } =\n            await this.#options.parseVideoStreamMetadata(initialStream);\n\n        return {\n            stream: stream\n                .pipeThrough(this.#options.createMediaStreamTransformer())\n                .pipeThrough(\n                    new InspectStream((packet) => {\n                        if (packet.type === \"configuration\") {\n                            switch (metadata.codec) {\n                                case ScrcpyVideoCodecId.H264: {\n                                    const { croppedWidth, croppedHeight } =\n                                        h264ParseConfiguration(packet.data);\n\n                                    this.#screenWidth = croppedWidth;\n                                    this.#screenHeight = croppedHeight;\n                                    break;\n                                }\n                                case ScrcpyVideoCodecId.H265: {\n                                    const { croppedWidth, croppedHeight } =\n                                        h265ParseConfiguration(packet.data);\n\n                                    this.#screenWidth = croppedWidth;\n                                    this.#screenHeight = croppedHeight;\n                                    break;\n                                }\n                            }\n                        }\n                    }),\n                ),\n            metadata,\n        };\n    }\n\n    async #createAudioStream(\n        initialStream: ReadableStream<Uint8Array>,\n    ): Promise<AdbScrcpyAudioStreamMetadata> {\n        const metadata = await this.#options.parseAudioStreamMetadata(\n            initialStream,\n        );\n\n        switch (metadata.type) {\n            case \"disabled\":\n            case \"errored\":\n                return metadata;\n            case \"success\":\n                return {\n                    ...metadata,\n                    stream: metadata.stream.pipeThrough(\n                        this.#options.createMediaStreamTransformer(),\n                    ),\n                };\n            default:\n                throw new Error(\n                    `Unexpected audio metadata type ${\n                        metadata[\"type\"] as unknown as string\n                    }`,\n                );\n        }\n    }\n\n    async close() {\n        await this.#process.kill();\n    }\n}\n","import type { Adb } from \"@yume-chan/adb\";\nimport { AdbReverseNotSupportedError, NOOP } from \"@yume-chan/adb\";\nimport { delay } from \"@yume-chan/async\";\nimport type { Disposable } from \"@yume-chan/event\";\nimport type {\n    Consumable,\n    ReadableStream,\n    ReadableStreamDefaultReader,\n    ReadableWritablePair,\n} from \"@yume-chan/stream-extra\";\nimport {\n    BufferedReadableStream,\n    TransformStream,\n} from \"@yume-chan/stream-extra\";\nimport type { ValueOrPromise } from \"@yume-chan/struct\";\n\nexport interface AdbScrcpyConnectionOptions {\n    scid: number;\n\n    video: boolean;\n\n    audio: boolean;\n\n    /**\n     * Whether to create a control stream\n     */\n    control: boolean;\n\n    /**\n     * In forward tunnel mode, read a byte from video socket on start to detect connection issues\n     */\n    sendDummyByte: boolean;\n}\n\nexport const SCRCPY_SOCKET_NAME_PREFIX = \"scrcpy\";\n\nexport interface AdbScrcpyConnectionStreams {\n    video?: ReadableStream<Uint8Array>;\n    audio?: ReadableStream<Uint8Array>;\n    control?: ReadableWritablePair<Uint8Array, Consumable<Uint8Array>>;\n}\n\nexport abstract class AdbScrcpyConnection implements Disposable {\n    protected adb: Adb;\n\n    protected options: AdbScrcpyConnectionOptions;\n\n    protected socketName: string;\n\n    constructor(adb: Adb, options: AdbScrcpyConnectionOptions) {\n        this.adb = adb;\n        this.options = options;\n        this.socketName = this.getSocketName();\n    }\n\n    initialize(): ValueOrPromise<void> {\n        // pure virtual method\n    }\n\n    protected getSocketName(): string {\n        let socketName = \"localabstract:\" + SCRCPY_SOCKET_NAME_PREFIX;\n        if (this.options.scid !== undefined && this.options.scid >= 0) {\n            socketName += \"_\" + this.options.scid.toString(16).padStart(8, \"0\");\n        }\n        return socketName;\n    }\n\n    abstract getStreams(): ValueOrPromise<AdbScrcpyConnectionStreams>;\n\n    dispose(): void {\n        // pure virtual method\n    }\n}\n\nexport class AdbScrcpyForwardConnection extends AdbScrcpyConnection {\n    #disposed = false;\n\n    #connect(): Promise<\n        ReadableWritablePair<Uint8Array, Consumable<Uint8Array>>\n    > {\n        return this.adb.createSocket(this.socketName);\n    }\n\n    async #connectAndRetry(\n        sendDummyByte: boolean,\n    ): Promise<ReadableWritablePair<Uint8Array, Consumable<Uint8Array>>> {\n        for (let i = 0; !this.#disposed && i < 100; i += 1) {\n            try {\n                const stream = await this.#connect();\n                if (sendDummyByte) {\n                    // Can't guarantee the stream will preserve message boundaries,\n                    // so buffer the stream\n                    const buffered = new BufferedReadableStream(\n                        stream.readable,\n                    );\n                    await buffered.readExactly(1);\n                    return {\n                        readable: buffered.release(),\n                        writable: stream.writable,\n                    };\n                }\n                return stream;\n            } catch (e) {\n                // Maybe the server is still starting\n                await delay(100);\n            }\n        }\n        throw new Error(`Can't connect to server after 100 retries`);\n    }\n\n    override async getStreams(): Promise<AdbScrcpyConnectionStreams> {\n        let { sendDummyByte } = this.options;\n\n        const streams: AdbScrcpyConnectionStreams = {};\n\n        if (this.options.video) {\n            const video = await this.#connectAndRetry(sendDummyByte);\n            streams.video = video.readable;\n            sendDummyByte = false;\n        }\n\n        if (this.options.audio) {\n            const audio = await this.#connectAndRetry(sendDummyByte);\n            streams.audio = audio.readable;\n            sendDummyByte = false;\n        }\n\n        if (this.options.control) {\n            const control = await this.#connectAndRetry(sendDummyByte);\n            sendDummyByte = false;\n            streams.control = control;\n        }\n\n        return streams;\n    }\n\n    override dispose(): void {\n        this.#disposed = true;\n    }\n}\n\nexport class AdbScrcpyReverseConnection extends AdbScrcpyConnection {\n    #streams!: ReadableStreamDefaultReader<\n        ReadableWritablePair<Uint8Array, Consumable<Uint8Array>>\n    >;\n\n    #address!: string;\n\n    override async initialize(): Promise<void> {\n        // try to unbind first\n        await this.adb.reverse.remove(this.socketName).catch((e) => {\n            if (e instanceof AdbReverseNotSupportedError) {\n                throw e;\n            }\n\n            // Ignore other errors when unbinding\n        });\n\n        const queue = new TransformStream<\n            ReadableWritablePair<Uint8Array, Consumable<Uint8Array>>,\n            ReadableWritablePair<Uint8Array, Consumable<Uint8Array>>\n        >();\n        this.#streams = queue.readable.getReader();\n        const writer = queue.writable.getWriter();\n        this.#address = await this.adb.reverse.add(\n            this.socketName,\n            (socket) => {\n                void writer.write(socket);\n            },\n        );\n    }\n\n    async #accept(): Promise<\n        ReadableWritablePair<Uint8Array, Consumable<Uint8Array>>\n    > {\n        return (await this.#streams.read()).value!;\n    }\n\n    async getStreams(): Promise<AdbScrcpyConnectionStreams> {\n        const streams: AdbScrcpyConnectionStreams = {};\n\n        if (this.options.video) {\n            const video = await this.#accept();\n            streams.video = video.readable;\n        }\n\n        if (this.options.audio) {\n            const audio = await this.#accept();\n            streams.audio = audio.readable;\n        }\n\n        if (this.options.control) {\n            const control = await this.#accept();\n            streams.control = control;\n        }\n\n        return streams;\n    }\n\n    override dispose() {\n        // Don't await this!\n        // `reverse.remove`'s response will never arrive\n        // before we read all pending data from Scrcpy streams\n        // NOOP: failed to remove reverse tunnel is not a big deal\n        this.adb.reverse.remove(this.#address).catch(NOOP);\n    }\n}\n","import type { Adb } from \"@yume-chan/adb\";\nimport type {\n    ScrcpyDisplay,\n    ScrcpyEncoder,\n    ScrcpyOptions,\n} from \"@yume-chan/scrcpy\";\nimport { ScrcpyOptionsBase } from \"@yume-chan/scrcpy\";\n\nimport type { AdbScrcpyConnection } from \"../connection.js\";\n\nexport interface AdbScrcpyOptions<T extends object> extends ScrcpyOptions<T> {\n    /**\n     * Allows the client to forcefully enable forward tunnel mode\n     * when reverse tunnel fails.\n     */\n    tunnelForwardOverride: boolean;\n\n    getEncoders(\n        adb: Adb,\n        path: string,\n        version: string,\n    ): Promise<ScrcpyEncoder[]>;\n\n    getDisplays(\n        adb: Adb,\n        path: string,\n        version: string,\n    ): Promise<ScrcpyDisplay[]>;\n\n    createConnection(adb: Adb): AdbScrcpyConnection;\n}\n\nexport abstract class AdbScrcpyOptionsBase<T extends object>\n    extends ScrcpyOptionsBase<T, ScrcpyOptions<T>>\n    implements AdbScrcpyOptions<T>\n{\n    override get defaults(): Required<T> {\n        return this._base.defaults;\n    }\n\n    tunnelForwardOverride = false;\n\n    constructor(base: ScrcpyOptions<T>) {\n        super(base, base.value);\n    }\n\n    serialize(): string[] {\n        return this._base.serialize();\n    }\n\n    abstract getEncoders(\n        adb: Adb,\n        path: string,\n        version: string,\n    ): Promise<ScrcpyEncoder[]>;\n\n    abstract getDisplays(\n        adb: Adb,\n        path: string,\n        version: string,\n    ): Promise<ScrcpyDisplay[]>;\n\n    abstract createConnection(adb: Adb): AdbScrcpyConnection;\n}\n","import type { Adb } from \"@yume-chan/adb\";\nimport type {\n    ScrcpyDisplay,\n    ScrcpyEncoder,\n    ScrcpyOptionsInit1_16,\n} from \"@yume-chan/scrcpy\";\nimport { WritableStream } from \"@yume-chan/stream-extra\";\n\nimport { AdbScrcpyClient, AdbScrcpyExitedError } from \"../client.js\";\nimport type {\n    AdbScrcpyConnection,\n    AdbScrcpyConnectionOptions,\n} from \"../connection.js\";\nimport {\n    AdbScrcpyForwardConnection,\n    AdbScrcpyReverseConnection,\n} from \"../connection.js\";\n\nimport type { AdbScrcpyOptions } from \"./types.js\";\nimport { AdbScrcpyOptionsBase } from \"./types.js\";\n\nexport class AdbScrcpyOptions1_16 extends AdbScrcpyOptionsBase<ScrcpyOptionsInit1_16> {\n    static createConnection(\n        adb: Adb,\n        connectionOptions: AdbScrcpyConnectionOptions,\n        tunnelForward: boolean,\n    ): AdbScrcpyConnection {\n        if (tunnelForward) {\n            return new AdbScrcpyForwardConnection(adb, connectionOptions);\n        } else {\n            return new AdbScrcpyReverseConnection(adb, connectionOptions);\n        }\n    }\n\n    static async getEncoders(\n        adb: Adb,\n        path: string,\n        version: string,\n        options: AdbScrcpyOptions<object>,\n    ): Promise<ScrcpyEncoder[]> {\n        const client = await AdbScrcpyClient.start(adb, path, version, options);\n\n        const encoders: ScrcpyEncoder[] = [];\n        await client.stdout.pipeTo(\n            new WritableStream({\n                write: (line) => {\n                    const encoder = options.parseEncoder(line);\n                    if (encoder) {\n                        encoders.push(encoder);\n                    }\n                },\n            }),\n        );\n\n        return encoders;\n    }\n\n    static async getDisplays(\n        adb: Adb,\n        path: string,\n        version: string,\n        options: AdbScrcpyOptions<object>,\n    ): Promise<ScrcpyDisplay[]> {\n        try {\n            // Server will exit before opening connections when an invalid display id was given\n            // so `start` will throw an `AdbScrcpyExitedError`\n            const client = await AdbScrcpyClient.start(\n                adb,\n                path,\n                version,\n                options,\n            );\n\n            // If the server didn't exit, manually stop it and throw an error\n            await client.close();\n            throw new Error(\"Unexpected server output\");\n        } catch (e) {\n            if (e instanceof AdbScrcpyExitedError) {\n                const displays: ScrcpyDisplay[] = [];\n                for (const line of e.output) {\n                    const display = options.parseDisplay(line);\n                    if (display) {\n                        displays.push(display);\n                    }\n                }\n                return displays;\n            }\n\n            throw e;\n        }\n    }\n\n    override getEncoders(\n        adb: Adb,\n        path: string,\n        version: string,\n    ): Promise<ScrcpyEncoder[]> {\n        return AdbScrcpyOptions1_16.getEncoders(adb, path, version, this);\n    }\n\n    override getDisplays(\n        adb: Adb,\n        path: string,\n        version: string,\n    ): Promise<ScrcpyDisplay[]> {\n        return AdbScrcpyOptions1_16.getDisplays(adb, path, version, this);\n    }\n\n    override createConnection(adb: Adb): AdbScrcpyConnection {\n        return AdbScrcpyOptions1_16.createConnection(\n            adb,\n            {\n                scid: -1,\n                video: true,\n                audio: false,\n                // Old versions always have control stream no matter what the option is\n                // Pass `control: false` to `Connection` will disable the control stream\n                control: true,\n                sendDummyByte: true,\n            },\n            this.tunnelForwardOverride || this.value.tunnelForward,\n        );\n    }\n}\n","import type { Adb } from \"@yume-chan/adb\";\nimport type {\n    ScrcpyDisplay,\n    ScrcpyEncoder,\n    ScrcpyOptionsInit1_22,\n} from \"@yume-chan/scrcpy\";\n\nimport type { AdbScrcpyConnection } from \"../connection.js\";\n\nimport { AdbScrcpyOptions1_16 } from \"./1_16.js\";\nimport { AdbScrcpyOptionsBase } from \"./types.js\";\n\nexport class AdbScrcpyOptions1_22 extends AdbScrcpyOptionsBase<ScrcpyOptionsInit1_22> {\n    override getEncoders(\n        adb: Adb,\n        path: string,\n        version: string,\n    ): Promise<ScrcpyEncoder[]> {\n        return AdbScrcpyOptions1_16.getEncoders(adb, path, version, this);\n    }\n\n    override getDisplays(\n        adb: Adb,\n        path: string,\n        version: string,\n    ): Promise<ScrcpyDisplay[]> {\n        return AdbScrcpyOptions1_16.getDisplays(adb, path, version, this);\n    }\n\n    override createConnection(adb: Adb): AdbScrcpyConnection {\n        return AdbScrcpyOptions1_16.createConnection(\n            adb,\n            {\n                scid: -1,\n                video: true,\n                audio: false,\n                control: this.value.control,\n                sendDummyByte: this.value.sendDummyByte,\n            },\n            this.tunnelForwardOverride || this.value.tunnelForward,\n        );\n    }\n}\n","import type { Adb } from \"@yume-chan/adb\";\nimport type {\n    ScrcpyDisplay,\n    ScrcpyEncoder,\n    ScrcpyOptionsInit2_0,\n} from \"@yume-chan/scrcpy\";\n\nimport { AdbScrcpyClient, AdbScrcpyExitedError } from \"../client.js\";\nimport type { AdbScrcpyConnection } from \"../connection.js\";\n\nimport { AdbScrcpyOptions1_16 } from \"./1_16.js\";\nimport type { AdbScrcpyOptions } from \"./types.js\";\nimport { AdbScrcpyOptionsBase } from \"./types.js\";\n\nexport class AdbScrcpyOptions2_0 extends AdbScrcpyOptionsBase<ScrcpyOptionsInit2_0> {\n    static async getEncoders(\n        adb: Adb,\n        path: string,\n        version: string,\n        options: AdbScrcpyOptions<object>,\n    ): Promise<ScrcpyEncoder[]> {\n        try {\n            // Similar to `AdbScrcpyOptions1_16.getDisplays`,\n            // server start process won't complete and `start `will throw\n            const client = await AdbScrcpyClient.start(\n                adb,\n                path,\n                version,\n                options,\n            );\n\n            // If the server didn't exit, manually stop it and throw an error\n            await client.close();\n            throw new Error(\"Unexpected server output\");\n        } catch (e) {\n            if (e instanceof AdbScrcpyExitedError) {\n                const encoders: ScrcpyEncoder[] = [];\n                for (const line of e.output) {\n                    const encoder = options.parseEncoder(line);\n                    if (encoder) {\n                        encoders.push(encoder);\n                    }\n                }\n                return encoders;\n            }\n\n            throw e;\n        }\n    }\n\n    override async getEncoders(\n        adb: Adb,\n        path: string,\n        version: string,\n    ): Promise<ScrcpyEncoder[]> {\n        return AdbScrcpyOptions2_0.getEncoders(adb, path, version, this);\n    }\n\n    override getDisplays(\n        adb: Adb,\n        path: string,\n        version: string,\n    ): Promise<ScrcpyDisplay[]> {\n        return AdbScrcpyOptions1_16.getDisplays(adb, path, version, this);\n    }\n\n    override createConnection(adb: Adb): AdbScrcpyConnection {\n        return AdbScrcpyOptions1_16.createConnection(\n            adb,\n            {\n                scid: this.value.scid.value,\n                video: true,\n                audio: this.value.audio,\n                control: this.value.control,\n                sendDummyByte: this.value.sendDummyByte,\n            },\n            this.tunnelForwardOverride || this.value.tunnelForward,\n        );\n    }\n}\n","import type { Adb } from \"@yume-chan/adb\";\nimport type {\n    ScrcpyDisplay,\n    ScrcpyEncoder,\n    ScrcpyOptionsInit2_1,\n} from \"@yume-chan/scrcpy\";\n\nimport type { AdbScrcpyConnection } from \"../connection.js\";\n\nimport { AdbScrcpyOptions1_16 } from \"./1_16.js\";\nimport { AdbScrcpyOptions2_0 } from \"./2_0.js\";\nimport { AdbScrcpyOptionsBase } from \"./types.js\";\n\nexport class AdbScrcpyOptions2_1 extends AdbScrcpyOptionsBase<ScrcpyOptionsInit2_1> {\n    override async getEncoders(\n        adb: Adb,\n        path: string,\n        version: string,\n    ): Promise<ScrcpyEncoder[]> {\n        return AdbScrcpyOptions2_0.getEncoders(adb, path, version, this);\n    }\n\n    override getDisplays(\n        adb: Adb,\n        path: string,\n        version: string,\n    ): Promise<ScrcpyDisplay[]> {\n        return AdbScrcpyOptions1_16.getDisplays(adb, path, version, this);\n    }\n\n    override createConnection(adb: Adb): AdbScrcpyConnection {\n        return AdbScrcpyOptions1_16.createConnection(\n            adb,\n            {\n                scid: this.value.scid.value,\n                video: this.value.video,\n                audio: this.value.audio,\n                control: this.value.control,\n                sendDummyByte: this.value.sendDummyByte,\n            },\n            this.tunnelForwardOverride || this.value.tunnelForward,\n        );\n    }\n}\n","import { AdbScrcpyOptions2_1 } from \"./2_1.js\";\n\nexport class AdbScrcpyOptionsLatest extends AdbScrcpyOptions2_1 {}\n","export * from \"./1_16.js\";\nexport * from \"./1_22.js\";\nexport * from \"./2_0.js\";\nexport * from \"./2_1.js\";\nexport * from \"./latest.js\";\nexport * from \"./types.js\";\n","export * from \"./client.js\";\nexport * from \"./connection.js\";\nexport * from \"./options/index.js\";\n","\nexport const VERSION ='2.1.1';\nexport const BIN = new URL('./server.bin', import.meta.url);\n","export abstract class PcmPlayer<T> {\n    protected abstract sourceName: string;\n\n    #context: AudioContext;\n    #worklet: AudioWorkletNode | undefined;\n    #buffers: T[] = [];\n\n    constructor(sampleRate: number) {\n        this.#context = new AudioContext({\n            latencyHint: \"interactive\",\n            sampleRate,\n        });\n    }\n\n    protected abstract feedCore(worklet: AudioWorkletNode, source: T): void;\n\n    feed(source: T) {\n        if (this.#worklet === undefined) {\n            this.#buffers.push(source);\n            return;\n        }\n\n        this.feedCore(this.#worklet, source);\n    }\n\n    async start() {\n        await this.#context.audioWorklet.addModule(\n            new URL(\"./worker.js\", import.meta.url),\n        );\n\n        this.#worklet = new AudioWorkletNode(this.#context, this.sourceName, {\n            numberOfInputs: 0,\n            numberOfOutputs: 1,\n            outputChannelCount: [2],\n        });\n        this.#worklet.connect(this.#context.destination);\n\n        for (const source of this.#buffers) {\n            this.feedCore(this.#worklet, source);\n        }\n        this.#buffers.length = 0;\n    }\n\n    async stop() {\n        this.#worklet?.disconnect();\n        this.#worklet = undefined;\n\n        await this.#context.close();\n    }\n}\n\nexport class Int16PcmPlayer extends PcmPlayer<Int16Array> {\n    protected override sourceName = \"int16-source-processor\";\n\n    protected override feedCore(worklet: AudioWorkletNode, source: Int16Array) {\n        if (\n            source.byteOffset !== 0 ||\n            source.byteLength !== source.buffer.byteLength\n        ) {\n            source = source.slice();\n        }\n\n        const { buffer } = source;\n        worklet.port.postMessage([buffer], [buffer]);\n    }\n}\n\nexport class Float32PcmPlayer extends PcmPlayer<Float32Array> {\n    protected override sourceName = \"float32-source-processor\";\n\n    protected override feedCore(\n        worklet: AudioWorkletNode,\n        source: Float32Array,\n    ) {\n        if (\n            source.byteOffset !== 0 ||\n            source.byteLength !== source.buffer.byteLength\n        ) {\n            source = source.slice();\n        }\n\n        const { buffer } = source;\n        worklet.port.postMessage([buffer], [buffer]);\n    }\n}\n\nexport class Float32PlanerPcmPlayer extends PcmPlayer<Float32Array[]> {\n    protected override sourceName = \"float32-planer-source-processor\";\n\n    protected override feedCore(\n        worklet: AudioWorkletNode,\n        source: Float32Array[],\n    ) {\n        const buffers = source.map((channel) => {\n            if (\n                channel.byteOffset !== 0 ||\n                channel.byteLength !== channel.buffer.byteLength\n            ) {\n                channel = channel.slice();\n            }\n            return channel.buffer;\n        });\n        worklet.port.postMessage(buffers, buffers);\n    }\n}\n","import { ScrcpyMediaStreamPacket } from \"@yume-chan/scrcpy\";\nimport { TransformStream } from \"@yume-chan/stream-extra\";\n\nexport class AacDecodeStream extends TransformStream<\n    ScrcpyMediaStreamPacket,\n    Float32Array[]\n> {\n    constructor(config: AudioDecoderConfig) {\n        let decoder: AudioDecoder;\n        super({\n            start(controller) {\n                decoder = new AudioDecoder({\n                    error(error) {\n                        console.log(\"audio decoder error: \", error);\n                        controller.error(error);\n                    },\n                    output(output) {\n                        controller.enqueue(\n                            Array.from({ length: 2 }, (_, i) => {\n                                const options: AudioDataCopyToOptions = {\n                                    // AAC decodes to \"f32-planar\",\n                                    // converting to another format may cause audio glitches on Chrome.\n                                    format: \"f32-planar\",\n                                    planeIndex: i,\n                                };\n                                const buffer = new Float32Array(\n                                    output.allocationSize(options) /\n                                        Float32Array.BYTES_PER_ELEMENT\n                                );\n                                output.copyTo(buffer, options);\n                                return buffer;\n                            })\n                        );\n                    },\n                });\n            },\n            transform(chunk) {\n                switch (chunk.type) {\n                    case \"configuration\":\n                        // https://www.w3.org/TR/webcodecs-aac-codec-registration/#audiodecoderconfig-description\n                        // Raw AAC stream needs `description` to be set.\n                        decoder.configure({\n                            ...config,\n                            description: chunk.data,\n                        });\n                        break;\n                    case \"data\":\n                        decoder.decode(\n                            new EncodedAudioChunk({\n                                data: chunk.data,\n                                type: \"key\",\n                                timestamp: 0,\n                            })\n                        );\n                }\n            },\n            async flush() {\n                await decoder!.flush();\n            },\n        });\n    }\n}\n\nexport class OpusDecodeStream extends TransformStream<\n    ScrcpyMediaStreamPacket,\n    Float32Array\n> {\n    constructor(config: AudioDecoderConfig) {\n        let decoder: AudioDecoder;\n        super({\n            start(controller) {\n                decoder = new AudioDecoder({\n                    error(error) {\n                        console.log(\"audio decoder error: \", error);\n                        controller.error(error);\n                    },\n                    output(output) {\n                        // Opus decodes to \"f32\",\n                        // converting to another format may cause audio glitches on Chrome.\n                        const options: AudioDataCopyToOptions = {\n                            format: \"f32\",\n                            planeIndex: 0,\n                        };\n                        const buffer = new Float32Array(\n                            output.allocationSize(options) /\n                                Float32Array.BYTES_PER_ELEMENT\n                        );\n                        output.copyTo(buffer, options);\n                        controller.enqueue(buffer);\n                    },\n                });\n                decoder.configure(config);\n            },\n            transform(chunk) {\n                switch (chunk.type) {\n                    case \"configuration\":\n                        // configuration data is a opus-in-ogg identification header,\n                        // but stream data is raw opus,\n                        // so it has no use here.\n                        break;\n                    case \"data\":\n                        if (chunk.data.length === 0) {\n                            break;\n                        }\n                        decoder.decode(\n                            new EncodedAudioChunk({\n                                type: \"key\",\n                                timestamp: 0,\n                                data: chunk.data,\n                            })\n                        );\n                }\n            },\n            async flush() {\n                await decoder!.flush();\n            },\n        });\n    }\n}\n","import { EventEmitter } from \"@yume-chan/event\";\nimport { BIN } from \"@yume-chan/fetch-scrcpy-server\";\n\nclass FetchWithProgress {\n    public readonly promise: Promise<Uint8Array>;\n\n    private _downloaded = 0;\n    public get downloaded() {\n        return this._downloaded;\n    }\n\n    private _total = 0;\n    public get total() {\n        return this._total;\n    }\n\n    private progressEvent = new EventEmitter<\n        [download: number, total: number]\n    >();\n    public get onProgress() {\n        return this.progressEvent.event;\n    }\n\n    public constructor(url: string | URL) {\n        this.promise = this.fetch(url);\n    }\n\n    private async fetch(url: string | URL) {\n        const response = await globalThis.fetch(url);\n        this._total = Number.parseInt(\n            response.headers.get(\"Content-Length\") ?? \"0\",\n            10\n        );\n        this.progressEvent.fire([this._downloaded, this._total]);\n\n        const reader = response.body!.getReader();\n        const chunks: Uint8Array[] = [];\n        while (true) {\n            const result = await reader.read();\n            if (result.done) {\n                break;\n            }\n            chunks.push(result.value);\n            this._downloaded += result.value.byteLength;\n            this.progressEvent.fire([this._downloaded, this._total]);\n        }\n\n        this._total = chunks.reduce(\n            (result, item) => result + item.byteLength,\n            0\n        );\n        const result = new Uint8Array(this._total);\n        let position = 0;\n        for (const chunk of chunks) {\n            result.set(chunk, position);\n            position += chunk.byteLength;\n        }\n        return result;\n    }\n}\n\nlet cachedValue: FetchWithProgress | undefined;\nexport function fetchServer(\n    onProgress?: (e: [downloaded: number, total: number]) => void\n) {\n    if (!cachedValue) {\n        cachedValue = new FetchWithProgress(BIN);\n        cachedValue.promise.catch(() => {\n            cachedValue = undefined;\n        });\n    }\n\n    if (onProgress) {\n        cachedValue.onProgress(onProgress);\n        onProgress([cachedValue.downloaded, cachedValue.total]);\n    }\n\n    return cachedValue.promise;\n}\n","import { AdbScrcpyClient } from \"@yume-chan/adb-scrcpy\";\nimport { AoaHidDevice, HidKeyCode, HidKeyboard } from \"@yume-chan/aoa\";\nimport { Disposable } from \"@yume-chan/event\";\nimport {\n    AndroidKeyCode,\n    AndroidKeyEventAction,\n    AndroidKeyEventMeta,\n} from \"@yume-chan/scrcpy\";\n\nexport interface KeyboardInjector extends Disposable {\n    down(key: string): Promise<void>;\n    up(key: string): Promise<void>;\n    reset(): Promise<void>;\n}\n\nexport class ScrcpyKeyboardInjector implements KeyboardInjector {\n    private readonly client: AdbScrcpyClient;\n\n    private _controlLeft = false;\n    private _controlRight = false;\n    private _shiftLeft = false;\n    private _shiftRight = false;\n    private _altLeft = false;\n    private _altRight = false;\n    private _metaLeft = false;\n    private _metaRight = false;\n\n    private _capsLock = false;\n    private _numLock = true;\n\n    private _keys: Set<AndroidKeyCode> = new Set();\n\n    public constructor(client: AdbScrcpyClient) {\n        this.client = client;\n    }\n\n    private setModifier(keyCode: AndroidKeyCode, value: boolean) {\n        switch (keyCode) {\n            case AndroidKeyCode.ControlLeft:\n                this._controlLeft = value;\n                break;\n            case AndroidKeyCode.ControlRight:\n                this._controlRight = value;\n                break;\n            case AndroidKeyCode.ShiftLeft:\n                this._shiftLeft = value;\n                break;\n            case AndroidKeyCode.ShiftRight:\n                this._shiftRight = value;\n                break;\n            case AndroidKeyCode.AltLeft:\n                this._altLeft = value;\n                break;\n            case AndroidKeyCode.AltRight:\n                this._altRight = value;\n                break;\n            case AndroidKeyCode.MetaLeft:\n                this._metaLeft = value;\n                break;\n            case AndroidKeyCode.MetaRight:\n                this._metaRight = value;\n                break;\n            case AndroidKeyCode.CapsLock:\n                if (value) {\n                    this._capsLock = !this._capsLock;\n                }\n                break;\n            case AndroidKeyCode.NumLock:\n                if (value) {\n                    this._numLock = !this._numLock;\n                }\n                break;\n        }\n    }\n\n    private getMetaState(): AndroidKeyEventMeta {\n        let metaState = 0;\n        if (this._altLeft) {\n            metaState |=\n                AndroidKeyEventMeta.AltOn | AndroidKeyEventMeta.AltLeftOn;\n        }\n        if (this._altRight) {\n            metaState |=\n                AndroidKeyEventMeta.AltOn | AndroidKeyEventMeta.AltRightOn;\n        }\n        if (this._shiftLeft) {\n            metaState |=\n                AndroidKeyEventMeta.ShiftOn | AndroidKeyEventMeta.ShiftLeftOn;\n        }\n        if (this._shiftRight) {\n            metaState |=\n                AndroidKeyEventMeta.ShiftOn | AndroidKeyEventMeta.ShiftRightOn;\n        }\n        if (this._controlLeft) {\n            metaState |=\n                AndroidKeyEventMeta.CtrlOn | AndroidKeyEventMeta.CtrlLeftOn;\n        }\n        if (this._controlRight) {\n            metaState |=\n                AndroidKeyEventMeta.CtrlOn | AndroidKeyEventMeta.CtrlRightOn;\n        }\n        if (this._metaLeft) {\n            metaState |=\n                AndroidKeyEventMeta.MetaOn | AndroidKeyEventMeta.MetaLeftOn;\n        }\n        if (this._metaRight) {\n            metaState |=\n                AndroidKeyEventMeta.MetaOn | AndroidKeyEventMeta.MetaRightOn;\n        }\n        if (this._capsLock) {\n            metaState |= AndroidKeyEventMeta.CapsLockOn;\n        }\n        if (this._numLock) {\n            metaState |= AndroidKeyEventMeta.NumLockOn;\n        }\n        return metaState;\n    }\n\n    public async down(key: string): Promise<void> {\n        const keyCode = AndroidKeyCode[key as keyof typeof AndroidKeyCode];\n        if (!keyCode) {\n            return;\n        }\n\n        this.setModifier(keyCode, true);\n        this._keys.add(keyCode);\n        await this.client.controlMessageWriter?.injectKeyCode({\n            action: AndroidKeyEventAction.Down,\n            keyCode,\n            metaState: this.getMetaState(),\n            repeat: 0,\n        });\n    }\n\n    public async up(key: string): Promise<void> {\n        const keyCode = AndroidKeyCode[key as keyof typeof AndroidKeyCode];\n        if (!keyCode) {\n            return;\n        }\n\n        this.setModifier(keyCode, false);\n        this._keys.delete(keyCode);\n        await this.client.controlMessageWriter?.injectKeyCode({\n            action: AndroidKeyEventAction.Up,\n            keyCode,\n            metaState: this.getMetaState(),\n            repeat: 0,\n        });\n    }\n\n    public async reset(): Promise<void> {\n        this._controlLeft = false;\n        this._controlRight = false;\n        this._shiftLeft = false;\n        this._shiftRight = false;\n        this._altLeft = false;\n        this._altRight = false;\n        this._metaLeft = false;\n        this._metaRight = false;\n        for (const key of this._keys) {\n            this.up(AndroidKeyCode[key]);\n        }\n        this._keys.clear();\n    }\n\n    public dispose(): void {\n        // do nothing\n    }\n}\n\nexport class AoaKeyboardInjector implements KeyboardInjector {\n    public static async register(\n        device: USBDevice\n    ): Promise<AoaKeyboardInjector> {\n        const keyboard = await AoaHidDevice.register(\n            device,\n            0,\n            HidKeyboard.DESCRIPTOR\n        );\n        return new AoaKeyboardInjector(keyboard);\n    }\n\n    private readonly aoaKeyboard: AoaHidDevice;\n    private readonly hidKeyboard = new HidKeyboard();\n\n    public constructor(aoaKeyboard: AoaHidDevice) {\n        this.aoaKeyboard = aoaKeyboard;\n    }\n\n    public async down(key: string): Promise<void> {\n        const keyCode = HidKeyCode[key as keyof typeof HidKeyCode];\n        if (!keyCode) {\n            return;\n        }\n\n        this.hidKeyboard.down(keyCode);\n        await this.aoaKeyboard.sendInputReport(\n            this.hidKeyboard.serializeInputReport()\n        );\n    }\n\n    public async up(key: string): Promise<void> {\n        const keyCode = HidKeyCode[key as keyof typeof HidKeyCode];\n        if (!keyCode) {\n            return;\n        }\n\n        this.hidKeyboard.up(keyCode);\n        await this.aoaKeyboard.sendInputReport(\n            this.hidKeyboard.serializeInputReport()\n        );\n    }\n\n    public async reset(): Promise<void> {\n        this.hidKeyboard.reset();\n        await this.aoaKeyboard.sendInputReport(\n            this.hidKeyboard.serializeInputReport()\n        );\n    }\n\n    public async dispose(): Promise<void> {\n        await this.aoaKeyboard.unregister();\n    }\n}\n","import { PromiseResolver } from \"@yume-chan/async\";\nimport type { Disposable } from \"@yume-chan/event\";\nimport { AutoDisposable, EventEmitter } from \"@yume-chan/event\";\n\nlet worker: Worker | undefined;\nlet workerReady = false;\nconst pendingResolvers: PromiseResolver<TinyH264Wrapper>[] = [];\nlet streamId = 0;\n\nexport interface PictureReadyEventArgs {\n    renderStateId: number;\n\n    width: number;\n\n    height: number;\n\n    data: ArrayBuffer;\n}\n\nconst PICTURE_READY_SUBSCRIPTIONS = new Map<\n    number,\n    (e: PictureReadyEventArgs) => void\n>();\n\nfunction subscribePictureReady(\n    streamId: number,\n    handler: (e: PictureReadyEventArgs) => void,\n): Disposable {\n    PICTURE_READY_SUBSCRIPTIONS.set(streamId, handler);\n\n    return {\n        dispose() {\n            PICTURE_READY_SUBSCRIPTIONS.delete(streamId);\n        },\n    };\n}\n\nexport class TinyH264Wrapper extends AutoDisposable {\n    readonly streamId: number;\n\n    readonly #pictureReadyEvent = new EventEmitter<PictureReadyEventArgs>();\n    get onPictureReady() {\n        return this.#pictureReadyEvent.event;\n    }\n\n    constructor(streamId: number) {\n        super();\n\n        this.streamId = streamId;\n        this.addDisposable(\n            subscribePictureReady(streamId, this.#handlePictureReady),\n        );\n    }\n\n    #handlePictureReady = (e: PictureReadyEventArgs) => {\n        this.#pictureReadyEvent.fire(e);\n    };\n\n    feed(data: ArrayBuffer) {\n        worker!.postMessage(\n            {\n                type: \"decode\",\n                data: data,\n                offset: 0,\n                length: data.byteLength,\n                renderStateId: this.streamId,\n            },\n            [data],\n        );\n    }\n\n    override dispose() {\n        super.dispose();\n        worker!.postMessage({\n            type: \"release\",\n            renderStateId: this.streamId,\n        });\n    }\n}\n\ninterface TinyH264MessageBase {\n    type: string;\n}\n\ninterface TinyH264DecoderReadyMessage extends TinyH264MessageBase {\n    type: \"decoderReady\";\n}\n\ninterface TinyH264PictureReadyMessage\n    extends TinyH264MessageBase,\n        PictureReadyEventArgs {\n    type: \"pictureReady\";\n}\n\ntype TinyH264Message =\n    | TinyH264DecoderReadyMessage\n    | TinyH264PictureReadyMessage;\n\nexport function createTinyH264Wrapper(): Promise<TinyH264Wrapper> {\n    if (!worker) {\n        worker = new Worker(new URL(\"./worker.js\", import.meta.url));\n        worker.addEventListener(\n            \"message\",\n            ({ data }: MessageEvent<TinyH264Message>) => {\n                switch (data.type) {\n                    case \"decoderReady\":\n                        workerReady = true;\n                        for (const resolver of pendingResolvers) {\n                            resolver.resolve(new TinyH264Wrapper(streamId));\n                            streamId += 1;\n                        }\n                        pendingResolvers.length = 0;\n                        break;\n                    case \"pictureReady\":\n                        PICTURE_READY_SUBSCRIPTIONS.get(data.renderStateId)?.(\n                            data,\n                        );\n                        break;\n                }\n            },\n        );\n    }\n\n    if (!workerReady) {\n        const resolver = new PromiseResolver<TinyH264Wrapper>();\n        pendingResolvers.push(resolver);\n        return resolver.promise;\n    }\n\n    const decoder = new TinyH264Wrapper(streamId);\n    streamId += 1;\n    return Promise.resolve(decoder);\n}\n","import { PromiseResolver } from \"@yume-chan/async\";\nimport type { ScrcpyMediaStreamPacket } from \"@yume-chan/scrcpy\";\nimport {\n    AndroidAvcLevel,\n    AndroidAvcProfile,\n    h264ParseConfiguration,\n} from \"@yume-chan/scrcpy\";\nimport { WritableStream } from \"@yume-chan/stream-extra\";\nimport type { default as YuvBuffer } from \"yuv-buffer\";\nimport type { default as YuvCanvas } from \"yuv-canvas\";\n\nimport type {\n    ScrcpyVideoDecoder,\n    ScrcpyVideoDecoderCapability,\n} from \"./types.js\";\nimport type { TinyH264Wrapper } from \"./wrapper.js\";\nimport { createTinyH264Wrapper } from \"./wrapper.js\";\n\nconst NOOP = () => {\n    // no-op\n};\n\nlet cachedInitializePromise:\n    | Promise<{ YuvBuffer: typeof YuvBuffer; YuvCanvas: typeof YuvCanvas }>\n    | undefined;\nfunction initialize() {\n    if (!cachedInitializePromise) {\n        cachedInitializePromise = Promise.all([\n            import(\"yuv-buffer\"),\n            import(\"yuv-canvas\"),\n        ]).then(([YuvBuffer, { default: YuvCanvas }]) => ({\n            YuvBuffer,\n            YuvCanvas,\n        }));\n    }\n\n    return cachedInitializePromise;\n}\n\nexport class TinyH264Decoder implements ScrcpyVideoDecoder {\n    static readonly capabilities: Record<string, ScrcpyVideoDecoderCapability> =\n        {\n            h264: {\n                maxProfile: AndroidAvcProfile.Baseline,\n                maxLevel: AndroidAvcLevel.Level4,\n            },\n        };\n\n    #renderer: HTMLCanvasElement;\n    get renderer() {\n        return this.#renderer;\n    }\n\n    #frameRendered = 0;\n    get frameRendered() {\n        return this.#frameRendered;\n    }\n\n    #frameSkipped = 0;\n    get frameSkipped() {\n        return this.#frameSkipped;\n    }\n\n    #writable: WritableStream<ScrcpyMediaStreamPacket>;\n    get writable() {\n        return this.#writable;\n    }\n\n    #yuvCanvas: YuvCanvas | undefined;\n    #initializer: PromiseResolver<TinyH264Wrapper> | undefined;\n\n    constructor() {\n        void initialize();\n\n        this.#renderer = document.createElement(\"canvas\");\n\n        this.#writable = new WritableStream<ScrcpyMediaStreamPacket>({\n            write: async (packet) => {\n                switch (packet.type) {\n                    case \"configuration\":\n                        await this.#configure(packet.data);\n                        break;\n                    case \"data\": {\n                        if (!this.#initializer) {\n                            throw new Error(\"Decoder not configured\");\n                        }\n\n                        const wrapper = await this.#initializer.promise;\n                        wrapper.feed(packet.data.slice().buffer);\n                        break;\n                    }\n                }\n            },\n        });\n    }\n\n    async #configure(data: Uint8Array) {\n        this.dispose();\n\n        this.#initializer = new PromiseResolver<TinyH264Wrapper>();\n        const { YuvBuffer, YuvCanvas } = await initialize();\n\n        if (!this.#yuvCanvas) {\n            this.#yuvCanvas = YuvCanvas.attach(this.#renderer);\n        }\n\n        const {\n            encodedWidth,\n            encodedHeight,\n            croppedWidth,\n            croppedHeight,\n            cropLeft,\n            cropTop,\n        } = h264ParseConfiguration(data);\n\n        // H.264 Baseline profile only supports YUV 420 pixel format\n        const chromaWidth = encodedWidth / 2;\n        const chromaHeight = encodedHeight / 2;\n\n        // YUVCanvas will set canvas size when format changes\n        const format = YuvBuffer.format({\n            width: encodedWidth,\n            height: encodedHeight,\n            chromaWidth,\n            chromaHeight,\n            cropLeft: cropLeft,\n            cropTop: cropTop,\n            cropWidth: croppedWidth,\n            cropHeight: croppedHeight,\n            displayWidth: croppedWidth,\n            displayHeight: croppedHeight,\n        });\n\n        const wrapper = await createTinyH264Wrapper();\n        this.#initializer.resolve(wrapper);\n\n        const uPlaneOffset = encodedWidth * encodedHeight;\n        const vPlaneOffset = uPlaneOffset + chromaWidth * chromaHeight;\n        wrapper.onPictureReady(({ data }) => {\n            this.#frameRendered += 1;\n            const array = new Uint8Array(data);\n            const frame = YuvBuffer.frame(\n                format,\n                YuvBuffer.lumaPlane(format, array, encodedWidth, 0),\n                YuvBuffer.chromaPlane(format, array, chromaWidth, uPlaneOffset),\n                YuvBuffer.chromaPlane(format, array, chromaWidth, vPlaneOffset),\n            );\n            this.#yuvCanvas!.drawFrame(frame);\n        });\n\n        wrapper.feed(data.slice().buffer);\n    }\n\n    dispose(): void {\n        this.#initializer?.promise\n            .then((wrapper) => wrapper.dispose())\n            // NOOP: It's disposed so nobody cares about the error\n            .catch(NOOP);\n        this.#initializer = undefined;\n    }\n}\n","export * from \"./decoder.js\";\nexport * from \"./types.js\";\nexport * from \"./wrapper.js\";\n","import {\n    Dropdown,\n    IDropdownOption,\n    Icon,\n    IconButton,\n    Position,\n    SpinButton,\n    Stack,\n    TextField,\n    Toggle,\n    TooltipHost,\n} from \"@fluentui/react\";\nimport { makeStyles } from \"@griffel/react\";\nimport { AdbSyncError } from \"@yume-chan/adb\";\nimport { AdbScrcpyClient, AdbScrcpyOptionsLatest } from \"@yume-chan/adb-scrcpy\";\nimport { VERSION } from \"@yume-chan/fetch-scrcpy-server\";\nimport {\n    DEFAULT_SERVER_PATH,\n    ScrcpyDisplay,\n    ScrcpyEncoder,\n    ScrcpyLogLevel,\n    ScrcpyOptionsInitLatest,\n    ScrcpyOptionsLatest,\n    ScrcpyVideoOrientation,\n} from \"@yume-chan/scrcpy\";\nimport {\n    ScrcpyVideoDecoderConstructor,\n    TinyH264Decoder,\n} from \"@yume-chan/scrcpy-decoder-tinyh264\";\nimport { ConcatStringStream, DecodeUtf8Stream } from \"@yume-chan/stream-extra\";\nimport {\n    autorun,\n    computed,\n    makeAutoObservable,\n    observable,\n    runInAction,\n} from \"mobx\";\nimport { observer } from \"mobx-react-lite\";\nimport { GLOBAL_STATE } from \"../../state\";\nimport { Icons } from \"../../utils\";\nimport { STATE } from \"./state\";\n\nexport type Settings = ScrcpyOptionsInitLatest;\n\nexport interface ClientSettings {\n    turnScreenOff?: boolean;\n    decoder?: string;\n    ignoreDecoderCodecArgs?: boolean;\n}\n\nexport type SettingKeys = keyof (Settings & ClientSettings);\n\nexport interface SettingDefinitionBase {\n    group: \"settings\" | \"clientSettings\";\n    key: SettingKeys;\n    type: string;\n    label: string;\n    labelExtra?: JSX.Element;\n    description?: string;\n}\n\nexport interface TextSettingDefinition extends SettingDefinitionBase {\n    type: \"text\";\n    placeholder?: string;\n}\n\nexport interface DropdownSettingDefinition extends SettingDefinitionBase {\n    type: \"dropdown\";\n    placeholder?: string;\n    options: IDropdownOption[];\n}\n\nexport interface ToggleSettingDefinition extends SettingDefinitionBase {\n    type: \"toggle\";\n    disabled?: boolean;\n}\n\nexport interface NumberSettingDefinition extends SettingDefinitionBase {\n    type: \"number\";\n    min?: number;\n    max?: number;\n    step?: number;\n}\n\nexport type SettingDefinition =\n    | TextSettingDefinition\n    | DropdownSettingDefinition\n    | ToggleSettingDefinition\n    | NumberSettingDefinition;\n\ninterface SettingItemProps {\n    definition: SettingDefinition;\n    value: any;\n    onChange: (definition: SettingDefinition, value: any) => void;\n}\n\nconst useClasses = makeStyles({\n    labelRight: {\n        marginLeft: \"4px\",\n    },\n    item: {\n        width: \"100%\",\n        maxWidth: \"300px\",\n    },\n});\n\nexport const SettingItem = observer(function SettingItem({\n    definition,\n    value,\n    onChange,\n}: SettingItemProps) {\n    const classes = useClasses();\n\n    let label: JSX.Element = (\n        <Stack horizontal verticalAlign=\"center\">\n            <span>{definition.label}</span>\n            {!!definition.description && (\n                <TooltipHost content={definition.description}>\n                    <Icon\n                        className={classes.labelRight}\n                        iconName={Icons.Info}\n                    />\n                </TooltipHost>\n            )}\n            {definition.labelExtra}\n        </Stack>\n    );\n\n    switch (definition.type) {\n        case \"text\":\n            return (\n                <TextField\n                    className={classes.item}\n                    label={label as any}\n                    placeholder={definition.placeholder}\n                    value={value}\n                    onChange={(e, value) => onChange(definition, value)}\n                />\n            );\n        case \"dropdown\":\n            return (\n                <Dropdown\n                    className={classes.item}\n                    label={label as any}\n                    options={definition.options}\n                    placeholder={definition.placeholder}\n                    selectedKey={value}\n                    onChange={(e, option) => onChange(definition, option!.key)}\n                />\n            );\n        case \"toggle\":\n            return (\n                <Toggle\n                    label={label}\n                    checked={value}\n                    disabled={definition.disabled}\n                    onChange={(e, checked) => onChange(definition, checked)}\n                />\n            );\n        case \"number\":\n            return (\n                <SpinButton\n                    className={classes.item}\n                    label={definition.label}\n                    labelPosition={Position.top}\n                    min={definition.min}\n                    max={definition.max}\n                    step={definition.step}\n                    value={value.toString()}\n                    onChange={(e, value) =>\n                        onChange(definition, Number.parseInt(value!, 10))\n                    }\n                />\n            );\n    }\n});\n\nexport interface DecoderDefinition {\n    key: string;\n    name: string;\n    Constructor: ScrcpyVideoDecoderConstructor;\n}\n\nconst DEFAULT_SETTINGS = {\n    maxSize: 1080,\n    videoBitRate: 4_000_000,\n    videoCodec: \"h264\",\n    lockVideoOrientation: ScrcpyVideoOrientation.Unlocked,\n    displayId: 0,\n    crop: \"\",\n    powerOn: true,\n    audio: true,\n    audioCodec: \"aac\",\n} as Settings;\n\nexport const SETTING_STATE = makeAutoObservable(\n    {\n        displays: [] as ScrcpyDisplay[],\n        encoders: [] as ScrcpyEncoder[],\n        decoders: [\n            {\n                key: \"tinyh264\",\n                name: \"TinyH264 (Software)\",\n                Constructor: TinyH264Decoder,\n            },\n        ] as DecoderDefinition[],\n\n        settings: DEFAULT_SETTINGS,\n\n        clientSettings: {} as ClientSettings,\n    },\n    {\n        decoders: observable.shallow,\n        settings: observable.deep,\n        clientSettings: observable.deep,\n    }\n);\n\nexport const SCRCPY_SETTINGS_FILENAME = \"/data/local/tmp/.tango.json\";\n\nautorun(() => {\n    if (GLOBAL_STATE.adb) {\n        (async () => {\n            const sync = await GLOBAL_STATE.adb!.sync();\n            try {\n                const settings = JSON.parse(\n                    await sync\n                        .read(SCRCPY_SETTINGS_FILENAME)\n                        .pipeThrough(new DecodeUtf8Stream())\n                        .pipeThrough(new ConcatStringStream())\n                );\n                runInAction(() => {\n                    SETTING_STATE.settings = {\n                        ...DEFAULT_SETTINGS,\n                        ...settings.settings,\n                    };\n                    SETTING_STATE.clientSettings = settings.clientSettings;\n                });\n            } catch (e) {\n                if (!(e instanceof AdbSyncError)) {\n                    throw e;\n                }\n            } finally {\n                await sync.dispose();\n            }\n        })();\n\n        runInAction(() => {\n            SETTING_STATE.encoders = [];\n            SETTING_STATE.displays = [];\n            SETTING_STATE.settings.displayId = undefined;\n        });\n    }\n});\n\nautorun(() => {\n    SETTING_STATE.clientSettings.decoder = SETTING_STATE.decoders[0].key;\n});\n\nexport const SETTING_DEFINITIONS = computed(() => {\n    const result: SettingDefinition[] = [];\n\n    result.push(\n        {\n            group: \"settings\",\n            key: \"powerOn\",\n            type: \"toggle\",\n            label: \"Wake device up on start\",\n        },\n        {\n            group: \"clientSettings\",\n            key: \"turnScreenOff\",\n            type: \"toggle\",\n            label: \"Turn screen off during mirroring\",\n        },\n        {\n            group: \"settings\",\n            key: \"stayAwake\",\n            type: \"toggle\",\n            label: \"Stay awake during mirroring (if plugged in)\",\n        },\n        {\n            group: \"settings\",\n            key: \"powerOffOnClose\",\n            type: \"toggle\",\n            label: \"Turn device off on stop\",\n        }\n    );\n\n    result.push({\n        group: \"settings\",\n        key: \"displayId\",\n        type: \"dropdown\",\n        label: \"Display\",\n        placeholder: \"Press refresh to update available displays\",\n        labelExtra: (\n            <IconButton\n                iconProps={{ iconName: Icons.ArrowClockwise }}\n                disabled={!GLOBAL_STATE.adb}\n                text=\"Refresh\"\n                onClick={async () => {\n                    try {\n                        await STATE.pushServer();\n\n                        const displays = await AdbScrcpyClient.getDisplays(\n                            GLOBAL_STATE.adb!,\n                            DEFAULT_SERVER_PATH,\n                            VERSION,\n                            new AdbScrcpyOptionsLatest(\n                                new ScrcpyOptionsLatest({\n                                    logLevel: ScrcpyLogLevel.Debug,\n                                })\n                            )\n                        );\n\n                        runInAction(() => {\n                            SETTING_STATE.displays = displays;\n                            if (\n                                !SETTING_STATE.settings.displayId ||\n                                !SETTING_STATE.displays.some(\n                                    (x) =>\n                                        x.id ===\n                                        SETTING_STATE.settings.displayId\n                                )\n                            ) {\n                                SETTING_STATE.settings.displayId =\n                                    SETTING_STATE.displays[0]?.id;\n                            }\n                        });\n                    } catch (e: any) {\n                        GLOBAL_STATE.showErrorDialog(e);\n                    }\n                }}\n            />\n        ),\n        options: SETTING_STATE.displays.map((item) => ({\n            key: item.id,\n            text: `${item.id}${item.resolution ? ` (${item.resolution})` : \"\"}`,\n        })),\n    });\n\n    result.push({\n        group: \"settings\",\n        key: \"crop\",\n        type: \"text\",\n        label: \"Crop\",\n        placeholder: \"W:H:X:Y\",\n    });\n\n    result.push(\n        {\n            group: \"settings\",\n            key: \"maxSize\",\n            type: \"number\",\n            label: \"Max Resolution (longer side, 0 = unlimited)\",\n            min: 0,\n            max: 2560,\n            step: 50,\n        },\n        {\n            group: \"settings\",\n            key: \"videoBitRate\",\n            type: \"number\",\n            label: \"Max Video Bitrate (bps)\",\n            min: 100,\n            max: 100_000_000,\n            step: 100,\n        },\n        {\n            group: \"settings\",\n            key: \"videoCodec\",\n            type: \"dropdown\",\n            label: \"Video Codec\",\n            options: [\n                {\n                    key: \"h264\",\n                    text: \"H.264\",\n                },\n                {\n                    key: \"h265\",\n                    text: \"H.265\",\n                },\n            ],\n        },\n        {\n            group: \"settings\",\n            key: \"videoEncoder\",\n            type: \"dropdown\",\n            label: \"Video Encoder\",\n            placeholder:\n                SETTING_STATE.encoders.length === 0\n                    ? \"Press refresh button to update encoder list\"\n                    : \"(default)\",\n            labelExtra: (\n                <IconButton\n                    iconProps={{ iconName: Icons.ArrowClockwise }}\n                    disabled={!GLOBAL_STATE.adb}\n                    text=\"Refresh\"\n                    onClick={async () => {\n                        try {\n                            await STATE.pushServer();\n\n                            const encoders = await AdbScrcpyClient.getEncoders(\n                                GLOBAL_STATE.adb!,\n                                DEFAULT_SERVER_PATH,\n                                VERSION,\n                                new AdbScrcpyOptionsLatest(\n                                    new ScrcpyOptionsLatest({\n                                        logLevel: ScrcpyLogLevel.Debug,\n                                    })\n                                )\n                            );\n\n                            runInAction(() => {\n                                SETTING_STATE.encoders = encoders;\n                            });\n                        } catch (e: any) {\n                            GLOBAL_STATE.showErrorDialog(e);\n                        }\n                    }}\n                />\n            ),\n            options: SETTING_STATE.encoders\n                .filter(\n                    (item) =>\n                        item.type === \"video\" &&\n                        (!item.codec ||\n                            item.codec === SETTING_STATE.settings.videoCodec!)\n                )\n                .map((item) => ({\n                    key: item.name,\n                    text: item.name,\n                })),\n        }\n    );\n\n    result.push({\n        group: \"settings\",\n        key: \"lockVideoOrientation\",\n        type: \"dropdown\",\n        label: \"Lock Video Orientation\",\n        options: [\n            {\n                key: ScrcpyVideoOrientation.Unlocked,\n                text: \"Unlocked\",\n            },\n            {\n                key: ScrcpyVideoOrientation.Initial,\n                text: \"Current\",\n            },\n            {\n                key: ScrcpyVideoOrientation.Portrait,\n                text: \"Portrait\",\n            },\n            {\n                key: ScrcpyVideoOrientation.Landscape,\n                text: \"Landscape\",\n            },\n            {\n                key: ScrcpyVideoOrientation.PortraitFlipped,\n                text: \"Portrait (Flipped)\",\n            },\n            {\n                key: ScrcpyVideoOrientation.LandscapeFlipped,\n                text: \"Landscape (Flipped)\",\n            },\n        ],\n    });\n\n    if (SETTING_STATE.decoders.length > 1) {\n        result.push({\n            group: \"clientSettings\",\n            key: \"decoder\",\n            type: \"dropdown\",\n            label: \"Video Decoder\",\n            options: SETTING_STATE.decoders.map((item) => ({\n                key: item.key,\n                text: item.name,\n                data: item,\n            })),\n        });\n    }\n\n    result.push({\n        group: \"clientSettings\",\n        key: \"ignoreDecoderCodecArgs\",\n        type: \"toggle\",\n        label: `Ignore video decoder's codec options`,\n        description: `Some decoders don't support all H.264 profile/levels, so they request the device to encode at their highest-supported codec. However, some super old devices may not support that codec so their encoders will fail to start. Use this option to let device choose the codec to be used.`,\n    });\n\n    result.push(\n        {\n            group: \"settings\",\n            key: \"audio\",\n            type: \"toggle\",\n            label: \"Forward Audio (Requires Android 11)\",\n        },\n        {\n            group: \"settings\",\n            key: \"audioCodec\",\n            type: \"dropdown\",\n            label: \"Audio Codec\",\n            options: [\n                {\n                    key: \"raw\",\n                    text: \"Raw\",\n                },\n                {\n                    key: \"aac\",\n                    text: \"AAC\",\n                },\n                {\n                    key: \"opus\",\n                    text: \"Opus\",\n                },\n            ],\n        },\n        {\n            group: \"settings\",\n            key: \"audioEncoder\",\n            type: \"dropdown\",\n            placeholder:\n                SETTING_STATE.encoders.length === 0\n                    ? \"Press refresh button to update encoder list\"\n                    : \"(default)\",\n            label: \"Audio Encoder\",\n            labelExtra: (\n                <IconButton\n                    iconProps={{ iconName: Icons.ArrowClockwise }}\n                    disabled={!GLOBAL_STATE.adb}\n                    text=\"Refresh\"\n                    onClick={async () => {\n                        try {\n                            await STATE.pushServer();\n\n                            const encoders = await AdbScrcpyClient.getEncoders(\n                                GLOBAL_STATE.adb!,\n                                DEFAULT_SERVER_PATH,\n                                VERSION,\n                                new AdbScrcpyOptionsLatest(\n                                    new ScrcpyOptionsLatest({\n                                        logLevel: ScrcpyLogLevel.Debug,\n                                    })\n                                )\n                            );\n\n                            runInAction(() => {\n                                SETTING_STATE.encoders = encoders;\n                            });\n                        } catch (e: any) {\n                            GLOBAL_STATE.showErrorDialog(e);\n                        }\n                    }}\n                />\n            ),\n            options: SETTING_STATE.encoders\n                .filter(\n                    (x) =>\n                        x.type === \"audio\" &&\n                        x.codec === SETTING_STATE.settings.audioCodec\n                )\n                .map((item) => ({\n                    key: item.name,\n                    text: item.name,\n                })),\n        }\n    );\n\n    return result;\n});\n\nautorun(() => {\n    if (SETTING_STATE.encoders.length === 0) {\n        SETTING_STATE.settings.videoEncoder = \"\";\n        SETTING_STATE.settings.audioEncoder = \"\";\n        return;\n    }\n\n    const encodersForCurrentVideoCodec = SETTING_STATE.encoders.filter(\n        (item) =>\n            item.type === \"video\" &&\n            item.codec === SETTING_STATE.settings.videoCodec\n    );\n    if (\n        SETTING_STATE.settings.videoEncoder &&\n        encodersForCurrentVideoCodec.every(\n            (item) => item.name !== SETTING_STATE.settings.videoEncoder\n        )\n    ) {\n        SETTING_STATE.settings.videoEncoder = \"\";\n    }\n\n    const encodersForCurrentAudioCodec = SETTING_STATE.encoders.filter(\n        (item) =>\n            item.type === \"audio\" &&\n            item.codec === SETTING_STATE.settings.audioCodec\n    );\n    if (\n        SETTING_STATE.settings.audioEncoder &&\n        encodersForCurrentAudioCodec.every(\n            (item) => item.name !== SETTING_STATE.settings.audioEncoder\n        )\n    ) {\n        SETTING_STATE.settings.audioEncoder = \"\";\n    }\n});\n","import { ADB_SYNC_MAX_PACKET_SIZE, encodeUtf8 } from \"@yume-chan/adb\";\nimport { AdbDaemonWebUsbDevice } from \"@yume-chan/adb-daemon-webusb\";\nimport { AdbScrcpyClient, AdbScrcpyOptionsLatest } from \"@yume-chan/adb-scrcpy\";\nimport { VERSION } from \"@yume-chan/fetch-scrcpy-server\";\nimport {\n    Float32PcmPlayer,\n    Float32PlanerPcmPlayer,\n    Int16PcmPlayer,\n    PcmPlayer,\n} from \"@yume-chan/pcm-player\";\nimport {\n    AndroidScreenPowerMode,\n    CodecOptions,\n    DEFAULT_SERVER_PATH,\n    ScrcpyAudioCodec,\n    ScrcpyDeviceMessageType,\n    ScrcpyHoverHelper,\n    ScrcpyInstanceId,\n    ScrcpyLogLevel,\n    ScrcpyMediaStreamPacket,\n    ScrcpyOptionsLatest,\n    ScrcpyVideoCodecId,\n    clamp,\n    h264ParseConfiguration,\n    h265ParseConfiguration,\n} from \"@yume-chan/scrcpy\";\nimport { ScrcpyVideoDecoder } from \"@yume-chan/scrcpy-decoder-tinyh264\";\nimport {\n    Consumable,\n    DistributionStream,\n    InspectStream,\n    ReadableStream,\n    WritableStream,\n} from \"@yume-chan/stream-extra\";\nimport { action, autorun, makeAutoObservable, runInAction } from \"mobx\";\nimport { GLOBAL_STATE } from \"../../state\";\nimport { ProgressStream } from \"../../utils\";\nimport { AacDecodeStream, OpusDecodeStream } from \"./audio-decode-stream\";\nimport { fetchServer } from \"./fetch-server\";\nimport {\n    AoaKeyboardInjector,\n    KeyboardInjector,\n    ScrcpyKeyboardInjector,\n} from \"./input\";\nimport { MatroskaMuxingRecorder, RECORD_STATE } from \"./recorder\";\nimport { SCRCPY_SETTINGS_FILENAME, SETTING_STATE } from \"./settings\";\n\nconst NOOP = () => {\n    // no-op\n};\n\nexport class ScrcpyPageState {\n    running = false;\n\n    fullScreenContainer: HTMLDivElement | null = null;\n    rendererContainer: HTMLDivElement | null = null;\n\n    isFullScreen = false;\n\n    logVisible = false;\n    log: string[] = [];\n    demoModeVisible = false;\n    navigationBarVisible = true;\n\n    width = 0;\n    height = 0;\n    rotation = 0;\n\n    get rotatedWidth() {\n        return STATE.rotation & 1 ? STATE.height : STATE.width;\n    }\n    get rotatedHeight() {\n        return STATE.rotation & 1 ? STATE.width : STATE.height;\n    }\n\n    client: AdbScrcpyClient | undefined = undefined;\n    hoverHelper: ScrcpyHoverHelper | undefined = undefined;\n    keyboard: KeyboardInjector | undefined = undefined;\n    audioPlayer: PcmPlayer<unknown> | undefined = undefined;\n\n    async pushServer() {\n        const serverBuffer = await fetchServer();\n        await AdbScrcpyClient.pushServer(\n            GLOBAL_STATE.adb!,\n            new ReadableStream<Consumable<Uint8Array>>({\n                start(controller) {\n                    controller.enqueue(new Consumable(serverBuffer));\n                    controller.close();\n                },\n            })\n        );\n    }\n\n    decoder: ScrcpyVideoDecoder | undefined = undefined;\n    fpsCounterIntervalId: any = undefined;\n    fps = \"0\";\n\n    connecting = false;\n    serverTotalSize = 0;\n    serverDownloadedSize = 0;\n    debouncedServerDownloadedSize = 0;\n    serverDownloadSpeed = 0;\n    serverUploadedSize = 0;\n    debouncedServerUploadedSize = 0;\n    serverUploadSpeed = 0;\n\n    constructor() {\n        makeAutoObservable(this, {\n            start: false,\n            stop: action.bound,\n            dispose: action.bound,\n            setFullScreenContainer: action.bound,\n            setRendererContainer: action.bound,\n            clientPositionToDevicePosition: false,\n        });\n\n        autorun(() => {\n            if (!GLOBAL_STATE.adb) {\n                this.dispose();\n            }\n        });\n\n        if (typeof document === \"object\") {\n            document.addEventListener(\"fullscreenchange\", () => {\n                if (!document.fullscreenElement) {\n                    runInAction(() => {\n                        this.isFullScreen = false;\n                    });\n                }\n            });\n        }\n\n        autorun(() => {\n            if (this.rendererContainer && this.decoder) {\n                while (this.rendererContainer.firstChild) {\n                    this.rendererContainer.firstChild.remove();\n                }\n                this.rendererContainer.appendChild(this.decoder.renderer);\n            }\n        });\n    }\n\n    start = async () => {\n        if (!GLOBAL_STATE.adb) {\n            return;\n        }\n\n        try {\n            if (!SETTING_STATE.clientSettings.decoder) {\n                throw new Error(\"No available decoder\");\n            }\n\n            runInAction(() => {\n                this.serverTotalSize = 0;\n                this.serverDownloadedSize = 0;\n                this.debouncedServerDownloadedSize = 0;\n                this.serverUploadedSize = 0;\n                this.debouncedServerUploadedSize = 0;\n                this.connecting = true;\n            });\n\n            let intervalId = setInterval(\n                action(() => {\n                    this.serverDownloadSpeed =\n                        this.serverDownloadedSize -\n                        this.debouncedServerDownloadedSize;\n                    this.debouncedServerDownloadedSize =\n                        this.serverDownloadedSize;\n                }),\n                1000\n            );\n\n            let serverBuffer: Uint8Array;\n            try {\n                serverBuffer = await fetchServer(\n                    action(([downloaded, total]) => {\n                        this.serverDownloadedSize = downloaded;\n                        this.serverTotalSize = total;\n                    })\n                );\n                runInAction(() => {\n                    this.serverDownloadSpeed =\n                        this.serverDownloadedSize -\n                        this.debouncedServerDownloadedSize;\n                    this.debouncedServerDownloadedSize =\n                        this.serverDownloadedSize;\n                });\n            } finally {\n                clearInterval(intervalId);\n            }\n\n            intervalId = setInterval(\n                action(() => {\n                    this.serverUploadSpeed =\n                        this.serverUploadedSize -\n                        this.debouncedServerUploadedSize;\n                    this.debouncedServerUploadedSize = this.serverUploadedSize;\n                }),\n                1000\n            );\n\n            try {\n                await AdbScrcpyClient.pushServer(\n                    GLOBAL_STATE.adb!,\n                    new ReadableStream<Consumable<Uint8Array>>({\n                        start(controller) {\n                            controller.enqueue(new Consumable(serverBuffer));\n                            controller.close();\n                        },\n                    })\n                        // In fact `pushServer` will pipe the stream through a DistributionStream,\n                        // but without this pipeThrough, the progress will not be updated.\n                        .pipeThrough(\n                            new DistributionStream(ADB_SYNC_MAX_PACKET_SIZE)\n                        )\n                        .pipeThrough(\n                            new ProgressStream(\n                                action((progress) => {\n                                    this.serverUploadedSize = progress;\n                                })\n                            )\n                        )\n                );\n\n                runInAction(() => {\n                    this.serverUploadSpeed =\n                        this.serverUploadedSize -\n                        this.debouncedServerUploadedSize;\n                    this.debouncedServerUploadedSize = this.serverUploadedSize;\n                });\n            } finally {\n                clearInterval(intervalId);\n            }\n\n            const decoderDefinition =\n                SETTING_STATE.decoders.find(\n                    (x) => x.key === SETTING_STATE.clientSettings.decoder\n                ) ?? SETTING_STATE.decoders[0];\n\n            const videoCodecOptions = new CodecOptions();\n            if (!SETTING_STATE.clientSettings.ignoreDecoderCodecArgs) {\n                const capability =\n                    decoderDefinition.Constructor.capabilities[\n                        SETTING_STATE.settings.videoCodec!\n                    ];\n                if (capability) {\n                    videoCodecOptions.value.profile = capability.maxProfile;\n                    videoCodecOptions.value.level = capability.maxLevel;\n                }\n            }\n\n            // Disabled due to https://github.com/Genymobile/scrcpy/issues/2841\n            // Less recording delay\n            // codecOptions.value.iFrameInterval = 1;\n            // Less latency\n            // codecOptions.value.intraRefreshPeriod = 10000;\n\n            const options = new AdbScrcpyOptionsLatest(\n                new ScrcpyOptionsLatest({\n                    ...SETTING_STATE.settings,\n                    logLevel: ScrcpyLogLevel.Debug,\n                    scid: ScrcpyInstanceId.random(),\n                    sendDeviceMeta: false,\n                    sendDummyByte: false,\n                    videoCodecOptions,\n                })\n            );\n\n            runInAction(() => {\n                this.log = [];\n                this.log.push(`[client] Server version: ${VERSION}`);\n                this.log.push(\n                    `[client] Server arguments: ${options\n                        .serialize()\n                        .join(\" \")}`\n                );\n            });\n\n            const client = await AdbScrcpyClient.start(\n                GLOBAL_STATE.adb!,\n                DEFAULT_SERVER_PATH,\n                VERSION,\n                options\n            );\n\n            client.stdout.pipeTo(\n                new WritableStream<string>({\n                    write: action((line) => {\n                        this.log.push(line);\n                    }),\n                })\n            );\n\n            const sync = await GLOBAL_STATE.adb!.sync();\n            try {\n                await sync.write({\n                    filename: SCRCPY_SETTINGS_FILENAME,\n                    file: new ReadableStream<Consumable<Uint8Array>>({\n                        start(controller) {\n                            controller.enqueue(\n                                new Consumable(\n                                    encodeUtf8(\n                                        JSON.stringify({\n                                            settings: SETTING_STATE.settings,\n                                            clientSettings:\n                                                SETTING_STATE.clientSettings,\n                                        })\n                                    )\n                                )\n                            );\n                            controller.close();\n                        },\n                    }),\n                });\n            } finally {\n                sync.dispose();\n            }\n\n            RECORD_STATE.recorder = new MatroskaMuxingRecorder();\n\n            client.videoStream!.then(({ stream, metadata }) => {\n                runInAction(() => {\n                    RECORD_STATE.recorder.videoMetadata = metadata;\n                });\n\n                const decoder = new decoderDefinition.Constructor(\n                    metadata.codec\n                );\n\n                runInAction(() => {\n                    this.decoder = decoder;\n\n                    let lastFrameRendered = 0;\n                    let lastFrameSkipped = 0;\n                    this.fpsCounterIntervalId = setInterval(\n                        action(() => {\n                            const deltaRendered =\n                                decoder.frameRendered - lastFrameRendered;\n                            const deltaSkipped =\n                                decoder.frameSkipped - lastFrameSkipped;\n                            // prettier-ignore\n                            this.fps = `${\n                            deltaRendered\n                        }${\n                            deltaSkipped ? `+${deltaSkipped} skipped` : \"\"\n                        }`;\n                            lastFrameRendered = decoder.frameRendered;\n                            lastFrameSkipped = decoder.frameSkipped;\n                        }),\n                        1000\n                    );\n                });\n\n                let lastKeyframe = 0n;\n                const handler = new InspectStream<ScrcpyMediaStreamPacket>(\n                    (packet) => {\n                        RECORD_STATE.recorder.addVideoPacket(packet);\n\n                        if (packet.type === \"configuration\") {\n                            let croppedWidth: number;\n                            let croppedHeight: number;\n                            switch (metadata.codec) {\n                                case ScrcpyVideoCodecId.H264:\n                                    ({ croppedWidth, croppedHeight } =\n                                        h264ParseConfiguration(packet.data));\n                                    break;\n                                case ScrcpyVideoCodecId.H265:\n                                    ({ croppedWidth, croppedHeight } =\n                                        h265ParseConfiguration(packet.data));\n                                    break;\n                                default:\n                                    throw new Error(\"Codec not supported\");\n                            }\n\n                            runInAction(() => {\n                                this.log.push(\n                                    `[client] Video size changed: ${croppedWidth}x${croppedHeight}`\n                                );\n                                this.width = croppedWidth;\n                                this.height = croppedHeight;\n                            });\n                        } else if (\n                            packet.keyframe &&\n                            packet.pts !== undefined\n                        ) {\n                            if (lastKeyframe) {\n                                const interval =\n                                    (Number(packet.pts - lastKeyframe) / 1000) |\n                                    0;\n                                runInAction(() => {\n                                    this.log.push(\n                                        `[client] Keyframe interval: ${interval}ms`\n                                    );\n                                });\n                            }\n                            lastKeyframe = packet.pts!;\n                        }\n                    }\n                );\n\n                stream.pipeThrough(handler).pipeTo(decoder.writable);\n            });\n\n            client.audioStream?.then(async (metadata) => {\n                switch (metadata.type) {\n                    case \"disabled\":\n                        runInAction(() =>\n                            this.log.push(\n                                `[client] Demuxer audio: stream explicitly disabled by the device`\n                            )\n                        );\n                        return;\n                    case \"errored\":\n                        runInAction(() =>\n                            this.log.push(\n                                `[client] Demuxer audio: stream configuration error on the device`\n                            )\n                        );\n                        return;\n                    case \"success\":\n                        // Code is after this `switch`\n                        break;\n                    default:\n                        throw new Error(\n                            `Unexpected audio metadata type ${\n                                metadata[\"type\"] as unknown as string\n                            }`\n                        );\n                }\n\n                const [recordStream, playbackStream] = metadata.stream.tee();\n                switch (metadata.codec) {\n                    case ScrcpyAudioCodec.RAW: {\n                        const audioPlayer = new Int16PcmPlayer(48000);\n                        this.audioPlayer = audioPlayer;\n\n                        playbackStream.pipeTo(\n                            new WritableStream({\n                                write: (chunk) => {\n                                    audioPlayer.feed(\n                                        new Int16Array(\n                                            chunk.data.buffer,\n                                            chunk.data.byteOffset,\n                                            chunk.data.byteLength /\n                                                Int16Array.BYTES_PER_ELEMENT\n                                        )\n                                    );\n                                },\n                            })\n                        );\n\n                        await this.audioPlayer.start();\n                        break;\n                    }\n                    case ScrcpyAudioCodec.OPUS: {\n                        const audioPlayer = new Float32PcmPlayer(48000);\n                        this.audioPlayer = audioPlayer;\n\n                        playbackStream\n                            .pipeThrough(\n                                new OpusDecodeStream({\n                                    codec: metadata.codec.webCodecId,\n                                    numberOfChannels: 2,\n                                    sampleRate: 48000,\n                                })\n                            )\n                            .pipeTo(\n                                new WritableStream({\n                                    write: (chunk) => {\n                                        audioPlayer.feed(chunk);\n                                    },\n                                })\n                            );\n                        await audioPlayer.start();\n                        break;\n                    }\n                    case ScrcpyAudioCodec.AAC: {\n                        const audioPlayer = new Float32PlanerPcmPlayer(48000);\n                        this.audioPlayer = audioPlayer;\n\n                        playbackStream\n                            .pipeThrough(\n                                new AacDecodeStream({\n                                    codec: metadata.codec.webCodecId,\n                                    numberOfChannels: 2,\n                                    sampleRate: 48000,\n                                })\n                            )\n                            .pipeTo(\n                                new WritableStream({\n                                    write: (chunk) => {\n                                        audioPlayer.feed(chunk);\n                                    },\n                                })\n                            );\n                        await audioPlayer.start();\n                        break;\n                    }\n                    default:\n                        throw new Error(\n                            `Unsupported audio codec ${metadata.codec.optionValue}`\n                        );\n                }\n\n                runInAction(() => {\n                    RECORD_STATE.recorder.audioCodec = metadata.codec;\n                });\n\n                recordStream.pipeTo(\n                    new WritableStream({\n                        write: (packet) => {\n                            if (packet.type === \"data\") {\n                                RECORD_STATE.recorder.addAudioPacket(packet);\n                            }\n                        },\n                    })\n                );\n            });\n\n            client.exit.then(this.dispose);\n\n            client.deviceMessageStream!.pipeTo(\n                new WritableStream({\n                    write(message) {\n                        switch (message.type) {\n                            case ScrcpyDeviceMessageType.Clipboard:\n                                globalThis.navigator.clipboard.writeText(\n                                    message.content\n                                );\n                                break;\n                        }\n                    },\n                })\n            );\n\n            if (SETTING_STATE.clientSettings.turnScreenOff) {\n                await client.controlMessageWriter!.setScreenPowerMode(\n                    AndroidScreenPowerMode.Off\n                );\n            }\n\n            runInAction(() => {\n                this.client = client;\n                this.hoverHelper = new ScrcpyHoverHelper();\n                this.running = true;\n            });\n\n            const device = GLOBAL_STATE.device!;\n            if (device instanceof AdbDaemonWebUsbDevice) {\n                this.keyboard = await AoaKeyboardInjector.register(device.raw);\n            } else {\n                this.keyboard = new ScrcpyKeyboardInjector(client);\n            }\n        } catch (e: any) {\n            GLOBAL_STATE.showErrorDialog(e);\n        } finally {\n            runInAction(() => {\n                this.connecting = false;\n            });\n        }\n    };\n\n    async stop() {\n        // Request to close client first\n        await this.client?.close();\n        this.dispose();\n    }\n\n    dispose() {\n        // Otherwise some packets may still arrive at decoder\n        this.decoder?.dispose();\n        this.decoder = undefined;\n\n        if (RECORD_STATE.recording) {\n            RECORD_STATE.recorder.stop();\n            RECORD_STATE.recording = false;\n        }\n\n        this.keyboard?.dispose();\n        this.keyboard = undefined;\n\n        this.audioPlayer?.stop();\n        this.audioPlayer = undefined;\n\n        this.fps = \"0\";\n        clearTimeout(this.fpsCounterIntervalId);\n\n        if (this.isFullScreen) {\n            document.exitFullscreen();\n            this.isFullScreen = false;\n        }\n\n        this.client = undefined;\n        this.running = false;\n    }\n\n    setFullScreenContainer(element: HTMLDivElement | null) {\n        this.fullScreenContainer = element;\n    }\n\n    setRendererContainer(element: HTMLDivElement | null) {\n        this.rendererContainer = element;\n    }\n\n    clientPositionToDevicePosition(clientX: number, clientY: number) {\n        const viewRect = this.rendererContainer!.getBoundingClientRect();\n        let pointerViewX = clamp((clientX - viewRect.x) / viewRect.width, 0, 1);\n        let pointerViewY = clamp(\n            (clientY - viewRect.y) / viewRect.height,\n            0,\n            1\n        );\n\n        if (this.rotation & 1) {\n            [pointerViewX, pointerViewY] = [pointerViewY, pointerViewX];\n        }\n        switch (this.rotation) {\n            case 1:\n                pointerViewY = 1 - pointerViewY;\n                break;\n            case 2:\n                pointerViewX = 1 - pointerViewX;\n                pointerViewY = 1 - pointerViewY;\n                break;\n            case 3:\n                pointerViewX = 1 - pointerViewX;\n                break;\n        }\n\n        return {\n            x: pointerViewX * this.width,\n            y: pointerViewY * this.height,\n        };\n    }\n}\n\nexport const STATE = new ScrcpyPageState();\n","import {\n    CommandBar,\n    ContextualMenuItemType,\n    ICommandBarItemProps,\n} from \"@fluentui/react\";\nimport {\n    AndroidKeyCode,\n    AndroidKeyEventAction,\n    AndroidScreenPowerMode,\n} from \"@yume-chan/scrcpy\";\nimport { action, computed } from \"mobx\";\nimport { observer } from \"mobx-react-lite\";\nimport { Icons } from \"../../utils\";\nimport { CommandBarSpacerItem } from \"../command-bar-spacer-item\";\nimport { RECORD_STATE } from \"./recorder\";\nimport { STATE } from \"./state\";\n\nconst ITEMS = computed(() => {\n    const result: ICommandBarItemProps[] = [];\n\n    result.push({\n        key: \"stop\",\n        iconProps: { iconName: Icons.Stop },\n        text: \"Stop\",\n        onClick: STATE.stop as VoidFunction,\n    });\n\n    result.push(\n        RECORD_STATE.recording\n            ? {\n                  key: \"Record\",\n                  iconProps: {\n                      iconName: Icons.Record,\n                      style: { color: \"red\" },\n                  },\n                  // prettier-ignore\n                  text: `${\n                      RECORD_STATE.hours ? `${RECORD_STATE.hours}:` : \"\"\n                  }${\n                      RECORD_STATE.minutes.toString().padStart(2, \"0\")\n                  }:${\n                      RECORD_STATE.seconds.toString().padStart(2, \"0\")\n                  }`,\n                  onClick: action(() => {\n                      STATE.fullScreenContainer!.focus();\n\n                      RECORD_STATE.recorder.stop();\n                      RECORD_STATE.recording = false;\n                  }),\n              }\n            : {\n                  key: \"Record\",\n                  disabled: !STATE.running,\n                  iconProps: { iconName: Icons.Record },\n                  text: \"Record\",\n                  onClick: action(() => {\n                      STATE.fullScreenContainer!.focus();\n\n                      RECORD_STATE.recorder.start();\n                      RECORD_STATE.recording = true;\n                  }),\n              }\n    );\n\n    result.push({\n        key: \"fullscreen\",\n        disabled: !STATE.running,\n        iconProps: { iconName: Icons.FullScreenMaximize },\n        iconOnly: true,\n        text: \"Fullscreen\",\n        onClick: action(() => {\n            STATE.fullScreenContainer!.focus();\n\n            STATE.fullScreenContainer!.requestFullscreen();\n            STATE.isFullScreen = true;\n        }),\n    });\n\n    result.push(\n        {\n            key: \"volumeUp\",\n            disabled: !STATE.running,\n            iconProps: { iconName: Icons.Speaker2 },\n            iconOnly: true,\n            text: \"Volume Up\",\n            onClick: (async () => {\n                STATE.fullScreenContainer!.focus();\n\n                // TODO: Auto repeat when holding\n                await STATE.client?.controlMessageWriter!.injectKeyCode({\n                    action: AndroidKeyEventAction.Down,\n                    keyCode: AndroidKeyCode.VolumeUp,\n                    repeat: 0,\n                    metaState: 0,\n                });\n                await STATE.client?.controlMessageWriter!.injectKeyCode({\n                    action: AndroidKeyEventAction.Up,\n                    keyCode: AndroidKeyCode.VolumeUp,\n                    repeat: 0,\n                    metaState: 0,\n                });\n            }) as () => void,\n        },\n        {\n            key: \"volumeDown\",\n            disabled: !STATE.running,\n            iconProps: { iconName: Icons.Speaker1 },\n            iconOnly: true,\n            text: \"Volume Down\",\n            onClick: (async () => {\n                STATE.fullScreenContainer!.focus();\n\n                await STATE.client?.controlMessageWriter!.injectKeyCode({\n                    action: AndroidKeyEventAction.Down,\n                    keyCode: AndroidKeyCode.VolumeDown,\n                    repeat: 0,\n                    metaState: 0,\n                });\n                await STATE.client?.controlMessageWriter!.injectKeyCode({\n                    action: AndroidKeyEventAction.Up,\n                    keyCode: AndroidKeyCode.VolumeDown,\n                    repeat: 0,\n                    metaState: 0,\n                });\n            }) as () => void,\n        },\n        {\n            key: \"volumeMute\",\n            disabled: !STATE.running,\n            iconProps: { iconName: Icons.SpeakerOff },\n            iconOnly: true,\n            text: \"Toggle Mute\",\n            onClick: (async () => {\n                STATE.fullScreenContainer!.focus();\n\n                await STATE.client?.controlMessageWriter!.injectKeyCode({\n                    action: AndroidKeyEventAction.Down,\n                    keyCode: AndroidKeyCode.VolumeMute,\n                    repeat: 0,\n                    metaState: 0,\n                });\n                await STATE.client?.controlMessageWriter!.injectKeyCode({\n                    action: AndroidKeyEventAction.Up,\n                    keyCode: AndroidKeyCode.VolumeMute,\n                    repeat: 0,\n                    metaState: 0,\n                });\n            }) as () => void,\n        }\n    );\n\n    result.push(\n        {\n            key: \"rotateDevice\",\n            disabled: !STATE.running,\n            iconProps: { iconName: Icons.Orientation },\n            iconOnly: true,\n            text: \"Rotate Device\",\n            onClick: () => {\n                STATE.fullScreenContainer!.focus();\n\n                STATE.client!.controlMessageWriter!.rotateDevice();\n            },\n        },\n        {\n            key: \"rotateVideoLeft\",\n            disabled: !STATE.running,\n            iconProps: { iconName: Icons.RotateLeft },\n            iconOnly: true,\n            text: \"Rotate Video Left\",\n            onClick: action(() => {\n                STATE.fullScreenContainer!.focus();\n\n                STATE.rotation -= 1;\n                if (STATE.rotation < 0) {\n                    STATE.rotation = 3;\n                }\n            }),\n        },\n        {\n            key: \"rotateVideoRight\",\n            disabled: !STATE.running,\n            iconProps: { iconName: Icons.RotateRight },\n            iconOnly: true,\n            text: \"Rotate Video Right\",\n            onClick: action(() => {\n                STATE.fullScreenContainer!.focus();\n\n                STATE.rotation = (STATE.rotation + 1) & 3;\n            }),\n        }\n    );\n\n    result.push(\n        {\n            key: \"turnScreenOff\",\n            disabled: !STATE.running,\n            iconProps: { iconName: Icons.Lightbulb },\n            iconOnly: true,\n            text: \"Turn Screen Off\",\n            onClick: () => {\n                STATE.fullScreenContainer!.focus();\n\n                STATE.client!.controlMessageWriter!.setScreenPowerMode(\n                    AndroidScreenPowerMode.Off\n                );\n            },\n        },\n        {\n            key: \"turnScreenOn\",\n            disabled: !STATE.running,\n            iconProps: { iconName: Icons.LightbulbFilament },\n            iconOnly: true,\n            text: \"Turn Screen On\",\n            onClick: () => {\n                STATE.fullScreenContainer!.focus();\n\n                STATE.client!.controlMessageWriter!.setScreenPowerMode(\n                    AndroidScreenPowerMode.Normal\n                );\n            },\n        }\n    );\n\n    if (STATE.running) {\n        result.push({\n            key: \"fps\",\n            text: `FPS: ${STATE.fps}`,\n            disabled: true,\n        });\n    }\n\n    result.push(\n        {\n            // HACK: make CommandBar overflow on far items\n            // https://github.com/microsoft/fluentui/issues/11842\n            key: \"spacer\",\n            onRender: () => <CommandBarSpacerItem />,\n        },\n        {\n            // HACK: add a separator in CommandBar overflow menu\n            // https://github.com/microsoft/fluentui/issues/10035\n            key: \"separator\",\n            disabled: true,\n            itemType: ContextualMenuItemType.Divider,\n        }\n    );\n\n    result.push(\n        {\n            key: \"NavigationBar\",\n            iconProps: { iconName: Icons.PanelBottom },\n            canCheck: true,\n            checked: STATE.navigationBarVisible,\n            text: \"Navigation Bar\",\n            iconOnly: true,\n            onClick: action(() => {\n                STATE.navigationBarVisible = !STATE.navigationBarVisible;\n            }),\n        },\n        {\n            key: \"Log\",\n            iconProps: { iconName: Icons.TextGrammarError },\n            canCheck: true,\n            checked: STATE.logVisible,\n            text: \"Log\",\n            iconOnly: true,\n            onClick: action(() => {\n                STATE.logVisible = !STATE.logVisible;\n            }),\n        },\n        {\n            key: \"DemoMode\",\n            iconProps: { iconName: Icons.Wand },\n            canCheck: true,\n            checked: STATE.demoModeVisible,\n            text: \"Demo Mode\",\n            iconOnly: true,\n            onClick: action(() => {\n                STATE.demoModeVisible = !STATE.demoModeVisible;\n            }),\n        }\n    );\n\n    return result;\n});\n\nexport const ScrcpyCommandBar = observer(function ScrcpyCommandBar() {\n    return <CommandBar items={ITEMS.get()} />;\n});\n","import { IconButton, Stack } from \"@fluentui/react\";\nimport { makeStyles, mergeClasses } from \"@griffel/react\";\nimport { AndroidKeyCode, AndroidKeyEventAction } from \"@yume-chan/scrcpy\";\nimport { observer } from \"mobx-react-lite\";\nimport { CSSProperties, PointerEvent, ReactNode } from \"react\";\nimport { Icons } from \"../../utils\";\nimport { STATE } from \"./state\";\n\nconst useClasses = makeStyles({\n    container: {\n        height: \"40px\",\n        backgroundColor: \"#999\",\n    },\n    bar: {\n        width: \"100%\",\n        maxWidth: \"300px\",\n    },\n    icon: {\n        color: \"white\",\n    },\n    back: {\n        transform: \"rotate(180deg)\",\n    },\n});\n\nfunction handlePointerDown(e: PointerEvent<HTMLDivElement>) {\n    if (!STATE.client) {\n        return false;\n    }\n\n    if (e.button !== 0) {\n        return false;\n    }\n\n    STATE.fullScreenContainer!.focus();\n    e.currentTarget.setPointerCapture(e.pointerId);\n    e.preventDefault();\n    e.stopPropagation();\n\n    return true;\n}\n\nfunction handlePointerUp(e: PointerEvent<HTMLDivElement>) {\n    if (!STATE.client) {\n        return false;\n    }\n\n    if (e.button !== 0) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction handleBackPointerDown(e: PointerEvent<HTMLDivElement>) {\n    if (!handlePointerDown(e)) {\n        return;\n    }\n\n    STATE.client!.controlMessageWriter!.backOrScreenOn(\n        AndroidKeyEventAction.Down\n    );\n}\n\nfunction handleBackPointerUp(e: PointerEvent<HTMLDivElement>) {\n    if (!handlePointerUp(e)) {\n        return;\n    }\n\n    STATE.client!.controlMessageWriter!.backOrScreenOn(\n        AndroidKeyEventAction.Up\n    );\n}\n\nfunction handleHomePointerDown(e: PointerEvent<HTMLDivElement>) {\n    if (!handlePointerDown(e)) {\n        return;\n    }\n\n    STATE.client!.controlMessageWriter!.injectKeyCode({\n        action: AndroidKeyEventAction.Down,\n        keyCode: AndroidKeyCode.AndroidHome,\n        repeat: 0,\n        metaState: 0,\n    });\n}\n\nfunction handleHomePointerUp(e: PointerEvent<HTMLDivElement>) {\n    if (!handlePointerUp(e)) {\n        return;\n    }\n\n    STATE.client!.controlMessageWriter!.injectKeyCode({\n        action: AndroidKeyEventAction.Up,\n        keyCode: AndroidKeyCode.AndroidHome,\n        repeat: 0,\n        metaState: 0,\n    });\n}\n\nfunction handleAppSwitchPointerDown(e: PointerEvent<HTMLDivElement>) {\n    if (!handlePointerDown(e)) {\n        return;\n    }\n\n    STATE.client!.controlMessageWriter!.injectKeyCode({\n        action: AndroidKeyEventAction.Down,\n        keyCode: AndroidKeyCode.AndroidAppSwitch,\n        repeat: 0,\n        metaState: 0,\n    });\n}\n\nfunction handleAppSwitchPointerUp(e: PointerEvent<HTMLDivElement>) {\n    if (!handlePointerUp(e)) {\n        return;\n    }\n\n    STATE.client!.controlMessageWriter!.injectKeyCode({\n        action: AndroidKeyEventAction.Up,\n        keyCode: AndroidKeyCode.AndroidAppSwitch,\n        repeat: 0,\n        metaState: 0,\n    });\n}\n\nexport const NavigationBar = observer(function NavigationBar({\n    className,\n    style,\n    children,\n}: {\n    className: string;\n    style: CSSProperties;\n    children: ReactNode;\n}) {\n    const classes = useClasses();\n\n    if (!STATE.navigationBarVisible) {\n        return (\n            <div className={className} style={style}>\n                {children}\n            </div>\n        );\n    }\n\n    return (\n        <Stack\n            className={mergeClasses(classes.container, className)}\n            verticalFill\n            horizontalAlign=\"center\"\n            style={style}\n        >\n            {children}\n\n            <Stack\n                className={classes.bar}\n                verticalFill\n                horizontal\n                horizontalAlign=\"space-evenly\"\n                verticalAlign=\"center\"\n            >\n                <IconButton\n                    className={mergeClasses(classes.back, classes.icon)}\n                    iconProps={{ iconName: Icons.Play }}\n                    onPointerDown={handleBackPointerDown}\n                    onPointerUp={handleBackPointerUp}\n                />\n                <IconButton\n                    className={classes.icon}\n                    iconProps={{ iconName: Icons.Circle }}\n                    onPointerDown={handleHomePointerDown}\n                    onPointerUp={handleHomePointerUp}\n                />\n                <IconButton\n                    className={classes.icon}\n                    iconProps={{ iconName: Icons.Stop }}\n                    onPointerDown={handleAppSwitchPointerDown}\n                    onPointerUp={handleAppSwitchPointerUp}\n                />\n            </Stack>\n        </Stack>\n    );\n});\n","import { makeStyles } from \"@griffel/react\";\nimport {\n    AndroidMotionEventAction,\n    AndroidMotionEventButton,\n    ScrcpyPointerId,\n} from \"@yume-chan/scrcpy\";\nimport { MouseEvent, PointerEvent, useEffect, useState } from \"react\";\nimport { STATE } from \"./state\";\n\nconst useClasses = makeStyles({\n    video: {\n        transformOrigin: \"center center\",\n        touchAction: \"none\",\n    },\n});\n\nfunction handleWheel(e: WheelEvent) {\n    if (!STATE.client) {\n        return;\n    }\n\n    STATE.fullScreenContainer!.focus();\n    e.preventDefault();\n    e.stopPropagation();\n\n    const { x, y } = STATE.clientPositionToDevicePosition(e.clientX, e.clientY);\n    STATE.client!.controlMessageWriter!.injectScroll({\n        screenWidth: STATE.client!.screenWidth!,\n        screenHeight: STATE.client!.screenHeight!,\n        pointerX: x,\n        pointerY: y,\n        scrollX: -e.deltaX / 100,\n        scrollY: -e.deltaY / 100,\n        buttons: 0,\n    });\n}\n\nconst MOUSE_EVENT_BUTTON_TO_ANDROID_BUTTON = [\n    AndroidMotionEventButton.Primary,\n    AndroidMotionEventButton.Tertiary,\n    AndroidMotionEventButton.Secondary,\n    AndroidMotionEventButton.Back,\n    AndroidMotionEventButton.Forward,\n];\n\nfunction injectTouch(\n    action: AndroidMotionEventAction,\n    e: PointerEvent<HTMLDivElement>\n) {\n    if (!STATE.client) {\n        return;\n    }\n\n    const { pointerType } = e;\n    let pointerId: bigint;\n    if (pointerType === \"mouse\") {\n        // Android 13 has bug with mouse injection\n        // https://github.com/Genymobile/scrcpy/issues/3708\n        pointerId = ScrcpyPointerId.Finger;\n    } else {\n        pointerId = BigInt(e.pointerId);\n    }\n\n    const { x, y } = STATE.clientPositionToDevicePosition(e.clientX, e.clientY);\n\n    const messages = STATE.hoverHelper!.process({\n        action,\n        pointerId,\n        screenWidth: STATE.client.screenWidth!,\n        screenHeight: STATE.client.screenHeight!,\n        pointerX: x,\n        pointerY: y,\n        pressure: e.pressure,\n        actionButton: MOUSE_EVENT_BUTTON_TO_ANDROID_BUTTON[e.button],\n        // `MouseEvent.buttons` has the same order as Android `MotionEvent`\n        buttons: e.buttons,\n    });\n    for (const message of messages) {\n        STATE.client.controlMessageWriter!.injectTouch(message);\n    }\n}\n\nfunction handlePointerDown(e: PointerEvent<HTMLDivElement>) {\n    if (!STATE.client) {\n        return;\n    }\n\n    STATE.fullScreenContainer!.focus();\n    e.preventDefault();\n    e.stopPropagation();\n\n    e.currentTarget.setPointerCapture(e.pointerId);\n    injectTouch(AndroidMotionEventAction.Down, e);\n}\n\nfunction handlePointerMove(e: PointerEvent<HTMLDivElement>) {\n    if (!STATE.client) {\n        return;\n    }\n\n    e.preventDefault();\n    e.stopPropagation();\n    injectTouch(\n        e.buttons === 0\n            ? AndroidMotionEventAction.HoverMove\n            : AndroidMotionEventAction.Move,\n        e\n    );\n}\n\nfunction handlePointerUp(e: PointerEvent<HTMLDivElement>) {\n    if (!STATE.client) {\n        return;\n    }\n\n    e.preventDefault();\n    e.stopPropagation();\n    injectTouch(AndroidMotionEventAction.Up, e);\n}\n\nfunction handlePointerLeave(e: PointerEvent<HTMLDivElement>) {\n    if (!STATE.client) {\n        return;\n    }\n\n    e.preventDefault();\n    e.stopPropagation();\n    // Because pointer capture on pointer down, this event only happens for hovering mouse and pen.\n    // Release the injected pointer, otherwise it will stuck at the last position.\n    injectTouch(AndroidMotionEventAction.HoverExit, e);\n    injectTouch(AndroidMotionEventAction.Up, e);\n}\n\nfunction handleContextMenu(e: MouseEvent<HTMLDivElement>) {\n    e.preventDefault();\n}\n\nexport function VideoContainer() {\n    const classes = useClasses();\n\n    const [container, setContainer] = useState<HTMLDivElement | null>(null);\n\n    useEffect(() => {\n        STATE.setRendererContainer(container);\n\n        if (!container) {\n            return;\n        }\n\n        container.addEventListener(\"wheel\", handleWheel, {\n            passive: false,\n        });\n\n        return () => {\n            container.removeEventListener(\"wheel\", handleWheel);\n        };\n    }, [container]);\n\n    return (\n        <div\n            ref={setContainer}\n            className={classes.video}\n            style={{\n                width: STATE.width,\n                height: STATE.height,\n                transform: `translate(${\n                    (STATE.rotatedWidth - STATE.width) / 2\n                }px, ${(STATE.rotatedHeight - STATE.height) / 2}px) rotate(${\n                    STATE.rotation * 90\n                }deg)`,\n            }}\n            onPointerDown={handlePointerDown}\n            onPointerMove={handlePointerMove}\n            onPointerUp={handlePointerUp}\n            onPointerCancel={handlePointerUp}\n            onPointerLeave={handlePointerLeave}\n            onContextMenu={handleContextMenu}\n        />\n    );\n}\n","export * from \"./command-bar\";\nexport * from \"./fetch-server\";\nexport * from \"./navigation-bar\";\nexport * from \"./settings\";\nexport * from \"./state\";\nexport * from \"./video-container\";\n","import { useEffect } from \"react\";\n\ntype CommonEventMaps<T> = T extends typeof globalThis\n    ? WindowEventMap\n    : T extends Window\n    ? WindowEventMap\n    : T extends Document\n    ? DocumentEventMap\n    : T extends HTMLElement\n    ? HTMLElementEventMap\n    : T extends SVGElement\n    ? SVGElementEventMap\n    : { [type: string]: unknown };\n\nconst useClientAddEventListener = <\n    T extends EventTarget,\n    U extends keyof CommonEventMaps<T>\n>(\n    target: T | (() => T),\n    type: U,\n    listener: (this: T, ev: CommonEventMaps<T>[U]) => any,\n    options?: AddEventListenerOptions,\n    deps?: readonly unknown[]\n) => {\n    useEffect(() => {\n        const targetValue = typeof target === \"function\" ? target() : target;\n        targetValue.addEventListener(type as any, listener as any, options);\n\n        return () =>\n            targetValue.removeEventListener(\n                type as any,\n                listener as any,\n                options\n            );\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, deps);\n};\n\nexport const useAddEventListener =\n    typeof window !== \"undefined\" ? useClientAddEventListener : () => {};\n","import { useLayoutEffect as useReactLayoutEffect } from \"react\";\n\nexport const useLayoutEffect =\n    typeof window !== \"undefined\" ? useReactLayoutEffect : () => {};\n","import { MutableRefObject, useRef } from \"react\";\n\nimport { useLayoutEffect } from \"./layout-effect\";\n\nconst UNINITIALIZED = Symbol(\"UNINITIALIZED\");\n\nexport function useConstLazy<T>(initializer: () => T): T {\n    const ref = useRef<T | typeof UNINITIALIZED>(UNINITIALIZED);\n    if (ref.current === UNINITIALIZED) {\n        ref.current = initializer();\n    }\n    return ref.current;\n}\n\nexport function useConst<T>(value: T): T {\n    const ref = useRef(value);\n    return ref.current;\n}\n\nexport function useLatestRef<T>(value: T): MutableRefObject<T> {\n    const ref = useRef(value);\n    useLayoutEffect(() => {\n        ref.current = value;\n    }, [value]);\n    return ref;\n}\n\nexport function useStableCallback<T extends (...args: any[]) => void>(\n    callback: T\n): T {\n    const callbackRef = useLatestRef(callback);\n    return useConst(function (...args) {\n        return callbackRef.current(...args);\n    } as T);\n}\n","import { useState } from \"react\";\n\nimport { useAddEventListener } from \"./add-event-listener\";\nimport { useStableCallback } from \"./stable-callback\";\n\nfunction useClientLocalStorage<T extends string = string>(\n    key: string,\n    fallbackValue: T\n) {\n    const [value, setValue] = useState<T>(\n        () => (localStorage.getItem(key) as T) || fallbackValue\n    );\n\n    useAddEventListener(\n        globalThis,\n        \"storage\",\n        () =>\n            setValue((localStorage.getItem(key) as T | null) ?? fallbackValue),\n        { passive: true },\n        [key, fallbackValue]\n    );\n\n    const handleChange = useStableCallback((value: T) => {\n        setValue(value);\n        localStorage.setItem(key, value);\n    });\n\n    return [value, handleChange] as const;\n}\n\nexport const useLocalStorage: typeof useClientLocalStorage =\n    typeof localStorage !== \"undefined\"\n        ? useClientLocalStorage\n        : (key, fallbackValue) => [fallbackValue, () => {}];\n","export * from \"./add-event-listener\";\nexport * from \"./layout-effect\";\nexport * from \"./local-storage\";\nexport * from \"./stable-callback\";\n","import {\n    Dialog,\n    LayerHost,\n    Link,\n    PrimaryButton,\n    ProgressIndicator,\n    Stack,\n    StackItem,\n} from \"@fluentui/react\";\nimport { useId } from \"@fluentui/react-hooks\";\nimport { makeStyles, shorthands } from \"@griffel/react\";\nimport { WebCodecsDecoder } from \"@yume-chan/scrcpy-decoder-webcodecs\";\nimport { action, runInAction } from \"mobx\";\nimport { observer } from \"mobx-react-lite\";\nimport { NextPage } from \"next\";\nimport Head from \"next/head\";\nimport { KeyboardEvent, useEffect, useState } from \"react\";\nimport { DemoModePanel, DeviceView, ExternalLink } from \"../components\";\nimport {\n    NavigationBar,\n    SETTING_DEFINITIONS,\n    SETTING_STATE,\n    STATE,\n    ScrcpyCommandBar,\n    SettingItem,\n    VideoContainer,\n} from \"../components/scrcpy\";\nimport { useLocalStorage } from \"../hooks\";\nimport { GLOBAL_STATE } from \"../state\";\nimport { CommonStackTokens, RouteStackProps, formatSpeed } from \"../utils\";\n\nconst useClasses = makeStyles({\n    layerHost: {\n        position: \"absolute\",\n        top: 0,\n        bottom: 0,\n        left: 0,\n        right: 0,\n        pointerEvents: \"none\",\n        ...shorthands.margin(0),\n    },\n    fullScreenContainer: {\n        flexGrow: 1,\n        display: \"flex\",\n        flexDirection: \"column\",\n        backgroundColor: \"black\",\n        \":focus-visible\": {\n            ...shorthands.outline(\"0\"),\n        },\n    },\n    fullScreenStatusBar: {\n        display: \"flex\",\n        color: \"white\",\n        columnGap: \"12px\",\n        ...shorthands.padding(\"8px\", \"20px\"),\n    },\n    spacer: {\n        flexGrow: 1,\n    },\n});\n\nconst ConnectingDialog = observer(() => {\n    const classes = useClasses();\n    const layerHostId = useId(\"layerHost\");\n\n    const [isClient, setIsClient] = useState(false);\n\n    useEffect(() => {\n        setIsClient(true);\n    }, []);\n\n    if (!isClient) {\n        return null;\n    }\n\n    return (\n        <>\n            <LayerHost id={layerHostId} className={classes.layerHost} />\n\n            <Dialog\n                hidden={!STATE.connecting}\n                modalProps={{ layerProps: { hostId: layerHostId } }}\n                dialogContentProps={{ title: \"Connecting...\" }}\n            >\n                <Stack tokens={CommonStackTokens}>\n                    <ProgressIndicator\n                        label=\"Downloading scrcpy server...\"\n                        percentComplete={\n                            STATE.serverTotalSize\n                                ? STATE.serverDownloadedSize /\n                                  STATE.serverTotalSize\n                                : undefined\n                        }\n                        description={formatSpeed(\n                            STATE.debouncedServerDownloadedSize,\n                            STATE.serverTotalSize,\n                            STATE.serverDownloadSpeed\n                        )}\n                    />\n\n                    <ProgressIndicator\n                        label=\"Pushing scrcpy server to device...\"\n                        progressHidden={\n                            STATE.serverTotalSize === 0 ||\n                            STATE.serverDownloadedSize !== STATE.serverTotalSize\n                        }\n                        percentComplete={\n                            STATE.serverUploadedSize / STATE.serverTotalSize\n                        }\n                        description={formatSpeed(\n                            STATE.debouncedServerUploadedSize,\n                            STATE.serverTotalSize,\n                            STATE.serverUploadSpeed\n                        )}\n                    />\n\n                    <ProgressIndicator\n                        label=\"Starting scrcpy server on device...\"\n                        progressHidden={\n                            STATE.serverTotalSize === 0 ||\n                            STATE.serverUploadedSize !== STATE.serverTotalSize\n                        }\n                    />\n                </Stack>\n            </Dialog>\n        </>\n    );\n});\n\nasync function handleKeyEvent(e: KeyboardEvent<HTMLDivElement>) {\n    if (!STATE.client) {\n        return;\n    }\n\n    e.preventDefault();\n    e.stopPropagation();\n\n    const { type, code } = e;\n    STATE.keyboard![type === \"keydown\" ? \"down\" : \"up\"](code);\n}\n\nfunction handleBlur() {\n    if (!STATE.client) {\n        return;\n    }\n\n    STATE.keyboard?.reset();\n}\n\nconst FullscreenHint = observer(function FullscreenHint({\n    keyboardLockEnabled,\n}: {\n    keyboardLockEnabled: boolean;\n}) {\n    const classes = useClasses();\n\n    const [hintHidden, setHintHidden] = useLocalStorage<`${boolean}`>(\n        \"scrcpy-hint-hidden\",\n        \"false\"\n    );\n\n    if (!keyboardLockEnabled || !STATE.isFullScreen || hintHidden === \"true\") {\n        return null;\n    }\n\n    return (\n        <div className={classes.fullScreenStatusBar}>\n            <div>{GLOBAL_STATE.device?.serial}</div>\n            <div>FPS: {STATE.fps}</div>\n\n            <div className={classes.spacer} />\n\n            <div>Press and hold ESC to exit full screen</div>\n\n            <Link onClick={() => setHintHidden(\"true\")}>\n                {`Don't show again`}\n            </Link>\n        </div>\n    );\n});\n\nconst Scrcpy: NextPage = () => {\n    const classes = useClasses();\n\n    useEffect(() => {\n        // Detect WebCodecs support at client side\n        if (\n            SETTING_STATE.decoders.length === 1 &&\n            WebCodecsDecoder.isSupported()\n        ) {\n            runInAction(() => {\n                SETTING_STATE.decoders.unshift({\n                    key: \"webcodecs\",\n                    name: \"WebCodecs\",\n                    Constructor: WebCodecsDecoder,\n                });\n            });\n        }\n    }, []);\n\n    const [keyboardLockEnabled, setKeyboardLockEnabled] = useState(false);\n    useEffect(() => {\n        if (!(\"keyboard\" in navigator)) {\n            return;\n        }\n\n        // Keyboard Lock is only effective in fullscreen mode,\n        // but the `lock` method can be called at any time.\n\n        // @ts-expect-error\n        navigator.keyboard.lock();\n        setKeyboardLockEnabled(true);\n\n        return () => {\n            // @ts-expect-error\n            navigator.keyboard.unlock();\n        };\n    }, []);\n\n    useEffect(() => {\n        window.addEventListener(\"blur\", handleBlur);\n\n        return () => {\n            window.removeEventListener(\"blur\", handleBlur);\n        };\n    }, []);\n\n    return (\n        <Stack {...RouteStackProps}>\n            <Head>\n                <title>Scrcpy - Tango</title>\n            </Head>\n\n            {STATE.running ? (\n                <>\n                    <ScrcpyCommandBar />\n\n                    <Stack horizontal grow styles={{ root: { height: 0 } }}>\n                        <div\n                            ref={STATE.setFullScreenContainer}\n                            className={classes.fullScreenContainer}\n                            tabIndex={0}\n                            onKeyDown={handleKeyEvent}\n                            onKeyUp={handleKeyEvent}\n                        >\n                            <FullscreenHint\n                                keyboardLockEnabled={keyboardLockEnabled}\n                            />\n\n                            <DeviceView\n                                width={STATE.rotatedWidth}\n                                height={STATE.rotatedHeight}\n                                BottomElement={NavigationBar}\n                            >\n                                <VideoContainer />\n                            </DeviceView>\n                        </div>\n\n                        <div\n                            style={{\n                                padding: 12,\n                                overflow: \"hidden auto\",\n                                display: STATE.logVisible ? \"block\" : \"none\",\n                                width: 500,\n                                fontFamily: \"monospace\",\n                                overflowY: \"auto\",\n                                whiteSpace: \"pre-wrap\",\n                                wordWrap: \"break-word\",\n                            }}\n                        >\n                            {STATE.log.map((line, index) => (\n                                <div key={index}>{line}</div>\n                            ))}\n                        </div>\n\n                        <DemoModePanel\n                            style={{\n                                display: STATE.demoModeVisible\n                                    ? \"block\"\n                                    : \"none\",\n                            }}\n                        />\n                    </Stack>\n                </>\n            ) : (\n                <>\n                    <div>\n                        <ExternalLink\n                            href=\"https://github.com/Genymobile/scrcpy\"\n                            spaceAfter\n                        >\n                            Scrcpy\n                        </ExternalLink>\n                        can mirror device display and audio with low latency and\n                        control the device, all without root access.\n                    </div>\n                    <div>\n                        This is a TypeScript re-implementation of the client\n                        part. Paired with official pre-built server binary.\n                    </div>\n\n                    <StackItem align=\"start\">\n                        <PrimaryButton\n                            text=\"Start\"\n                            disabled={!GLOBAL_STATE.adb}\n                            onClick={STATE.start}\n                        />\n                    </StackItem>\n\n                    {SETTING_DEFINITIONS.get().map((definition) => (\n                        <SettingItem\n                            key={definition.key}\n                            definition={definition}\n                            value={\n                                (SETTING_STATE[definition.group] as any)[\n                                    definition.key\n                                ]\n                            }\n                            onChange={action(\n                                (definition, value) =>\n                                    ((SETTING_STATE[definition.group] as any)[\n                                        definition.key\n                                    ] = value)\n                            )}\n                        />\n                    ))}\n\n                    <ConnectingDialog />\n                </>\n            )}\n        </Stack>\n    );\n};\n\nexport default observer(Scrcpy);\n"],"names":["window","__NEXT_P","push","__webpack_require__","CommandBarSpacerItem","container","setContainer","useState","useEffect","parent","parentElement","originalFlexGrow","style","flexGrow","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__","jsx","div","ref","cachedValue","worker","cachedInitializePromise","AndroidAv1Profile","AndroidAv1Level","AndroidAvcProfile","AndroidAvcLevel","AndroidHevcProfile","AndroidHevcLevel","AndroidMotionEventAction","AndroidMotionEventButton","ScrcpyPointerId","ScrcpyControlMessageType","AndroidKeyEventAction","AndroidKeyEventMeta","AndroidKeyCode","AndroidScreenPowerMode","ScrcpyDeviceMessageType","ScrcpyLogLevel1_16","ScrcpyVideoOrientation1_16","ScrcpyVideoCodecId","ScrcpyLogLevel1_18","ScrcpyVideoOrientation1_18","annexBSplitNalu","buffer","start","zeroCount","inEmulation","i","length","byte","prevZeroCount","subarray","NaluSodbBitReader","nalu","byteLength","stopBitIndex","bytePosition","bitPosition","ended","constructor","j","readByte","next","value","read","result","skip","decodeExponentialGolombNumber","save","restore","state","peek","readBytes","Uint8Array","peekBytes","h264SearchConfiguration","sequenceParameterSet","pictureParameterSet","naluType","h264ParseConfiguration","data","profile_idc","profileIndex","constraint_set","constraintSet","level_idc","levelIndex","pic_width_in_mbs_minus1","pic_height_in_map_units_minus1","frame_mbs_only_flag","frame_crop_left_offset","frame_crop_right_offset","frame_crop_top_offset","frame_crop_bottom_offset","h264ParseSequenceParameterSet","reader","nal_ref_idc","nal_unit_type","constraint_set0_flag","constraint_set1_flag","constraint_set2_flag","constraint_set3_flag","constraint_set4_flag","constraint_set5_flag","seq_parameter_set_id","chroma_format_idc","seq_scaling_matrix_present_flag","seq_scaling_list_present_flag","pic_order_cnt_type","num_ref_frames_in_pic_order_cnt_cycle","offset_for_ref_frame","frame_cropping_flag","encodedWidth","encodedHeight","cropLeft","cropRight","cropTop","cropBottom","croppedWidth","croppedHeight","h265ParseVideoParameterSet","vps_num_units_in_tick","vps_time_scale","vps_poc_proportional_to_timing_flag","vps_num_ticks_poc_diff_one_minus1","vps_num_hrd_parameters","hrd_layer_set_idx","cprms_present_flag","hrdParameters","vps_video_parameter_set_id","vps_base_layer_internal_flag","vps_base_layer_available_flag","vps_max_layers_minus1","vps_max_sub_layers_minus1","vps_temporal_id_nesting_flag","profileTierLevel","h265ParseProfileTierLevel","vps_sub_layer_ordering_info_present_flag","vps_max_dec_pic_buffering_minus1","vps_max_num_reorder_pics","vps_max_latency_increase_plus1","vps_max_layer_id","vps_num_layer_sets_minus1","layer_id_included_flag","vps_timing_info_present_flag","h265ParseHrdParameters","commonInfPresentFlag","maxNumSubLayersMinus1","nal_hrd_parameters_present_flag","vcl_hrd_parameters_present_flag","sub_pic_hrd_params_present_flag","tick_divisor_minus2","du_cpb_removal_delay_increment_length_minus1","sub_pic_cpb_params_in_pic_timing_sei_flag","dpb_output_delay_du_length_minus1","bit_rate_scale","cpb_size_scale","cpb_size_du_scale","initial_cpb_removal_delay_length_minus1","au_cpb_removal_delay_length_minus1","dpb_output_delay_length_minus1","fixed_pic_rate_general_flag","fixed_pic_rate_within_cvs_flag","elemental_duration_in_tc_minus1","low_delay_hrd_flag","cpb_cnt_minus1","nalHrdParameters","vclHrdParameters","cpb_cnt_minus_1","h265ParseSubLayerHrdParameters","vps_extension_flag","h265ParseSequenceParameterSet","separate_colour_plane_flag","conf_win_left_offset","conf_win_right_offset","conf_win_top_offset","conf_win_bottom_offset","sps_max_dec_pic_buffering_minus1","sps_max_num_reorder_pics","sps_max_latency_increase_plus1","sps_scaling_list_data_present_flag","scalingListData","pcm_sample_bit_depth_luma_minus1","pcm_sample_bit_depth_chroma_minus1","log2_min_pcm_luma_coding_block_size_minus3","log2_diff_max_min_pcm_luma_coding_block_size","pcm_loop_filter_disabled_flag","num_long_term_ref_pics_sps","lt_ref_pic_poc_lsb_sps","used_by_curr_pic_lt_sps_flag","vuiParameters","sps_range_extension_flag","sps_multilayer_extension_flag","sps_3d_extension_flag","sps_scc_extension_flag","sps_extension_4bits","spsMultilayerExtension","sps3dExtension","sps_extension_data_flag","sps_video_parameter_set_id","sps_max_sub_layers_minus1","sps_temporal_id_nesting_flag","sps_seq_parameter_set_id","pic_width_in_luma_samples","pic_height_in_luma_samples","conformance_window_flag","bit_depth_luma_minus8","bit_depth_chroma_minus8","log2_max_pic_order_cnt_lsb_minus4","sps_sub_layer_ordering_info_present_flag","log2_min_luma_coding_block_size_minus3","log2_diff_max_min_luma_coding_block_size","log2_min_luma_transform_block_size_minus2","log2_diff_max_min_luma_transform_block_size","max_transform_hierarchy_depth_inter","max_transform_hierarchy_depth_intra","scaling_list_enabled_flag","h265ParseScalingListData","scaling_list","sizeId","matrixId","scaling_list_pred_mode_flag","nextCoef","coefNum","Math","min","scaling_list_dc_coef_minus8","scaling_list_delta_coef","amp_enabled_flag","sample_adaptive_offset_enabled_flag","pcm_enabled_flag","num_short_term_ref_pic_sets","shortTermRefPicSets","h265ParseShortTermReferencePictureSet","stRpsIdx","sets","inter_ref_pic_set_prediction_flag","delta_idx_minus1","delta_rps_sign","abs_delta_rps_minus1","used_by_curr_pic_flag","use_delta_flag","num_negative_pics","num_positive_pics","delta_poc_s0_minus1","used_by_curr_pic_s0_flag","delta_poc_s1_minus1","used_by_curr_pic_s1_flag","RefRpsIdx","RefRps","NumDeltaPocs_RefRpsIdx","DeltaRps","Number","RefPocS0","RefPocS1","pocS0","pocS1","dPoc","prev","current","long_term_ref_pics_present_flag","sps_temporal_mvp_enabled_flag","strong_intra_smoothing_enabled_flag","vui_parameters_present_flag","h265ParseVuiParameters","aspect_ratio_idc","sar_width","sar_height","overscan_appropriate_flag","video_format","video_full_range_flag","colour_description_present_flag","colour_primaries","transfer_characteristics","matrix_coeffs","chroma_sample_loc_type_top_field","chroma_sample_loc_type_bottom_field","def_disp_win_left_offset","def_disp_win_right_offset","def_disp_win_top_offset","def_disp_win_bottom_offset","vui_num_units_in_tick","vui_time_scale","vui_poc_proportional_to_timing_flag","vui_num_ticks_poc_diff_one_minus1","vui_hrd_parameters_present_flag","tiles_fixed_structure_flag","motion_vectors_over_pic_boundaries_flag","restricted_ref_pic_lists_flag","min_spatial_segmentation_idc","max_bytes_per_pic_denom","max_bits_per_min_cu_denom","log2_max_mv_length_horizontal","log2_max_mv_length_vertical","aspect_ratio_info_present_flag","overscan_info_present_flag","video_signal_type_present_flag","chroma_loc_info_present_flag","neutral_chroma_indication_flag","field_seq_flag","frame_field_info_present_flag","default_display_window_flag","vui_timing_info_present_flag","bitstream_restriction_flag","sps_extension_present_flag","h265ParseSpsMultilayerExtension","inter_view_mv_vert_constraint_flag","h265ParseSps3dExtension","iv_di_mc_enabled_flag","iv_mv_scal_enabled_flag","log2_ivmc_sub_pb_size_minus3","iv_res_pred_enabled_flag","depth_ref_enabled_flag","vsp_mc_enabled_flag","dbbp_enabled_flag","tex_mc_enabled_flag","log2_texmc_sub_pb_size_minus3","intra_contour_enabled_flag","intra_dc_only_wedge_enabled_flag","cqt_cu_part_pred_enabled_flag","inter_dc_only_enabled_flag","skip_intra_enabled_flag","h265ParseProfileTier","max_12bit_constraint_flag","max_10bit_constraint_flag","max_8bit_constraint_flag","max_422chroma_constraint_flag","max_420chroma_constraint_flag","max_monochrome_constraint_flag","intra_constraint_flag","one_picture_only_constraint_flag","lower_bit_rate_constraint_flag","max_14bit_constraint_flag","inbld_flag","profile_space","tier_flag","profileCompatibilitySet","profile_compatibility_flag","progressive_source_flag","interlaced_source_flag","non_packed_constraint_flag","frame_only_constraint_flag","profilePresentFlag","generalProfileTier","general_level_idc","sub_layer_profile_present_flag","sub_layer_level_present_flag","subLayerProfileTier","sub_layer_level_idc","subLayerId","CpbCnt","bit_rate_value_minus1","cpb_size_value_minus1","cbr_flag","cpb_size_du_value_minus1","bit_rate_du_value_minus1","h265SearchConfiguration","videoParameterSet","count","header","h265ParseNaluHeader","nuh_layer_id","nuh_temporal_id_plus1","raw","rbsp","h265ParseConfiguration","generalProfileSpace","generalTierFlag","generalProfileIndex","generalProfileCompatibilitySet","generalConstraintSet","generalLevelIndex","SubWidthC","getSubWidthC","SubHeightC","getSubHeightC","BasicControlMessage","esm","AU","uint8","Mouse","Finger","VirtualMouse","VirtualFinger","ScrcpyControlMessageTypeValue","types","options","controlMessageTypes","get","type","indexOf","fillMessageType","message","ScrcpyHoverHelper","lastHoverMessage","process","pointerId","action","Up","undefined","HoverMove","InjectTouch","ScrcpyInjectKeyCodeControlMessage","ZP","W$","uint32","ScrcpyInjectTextControlMessage","string","lengthField","ScrcpySetScreenPowerModeControlMessage","ScrcpyControlMessageSerializer","typeValues","scrollController","createScrollController","injectKeyCode","serialize","InjectKeyCode","injectText","text","InjectText","injectTouch","serializeInjectTouchControlMessage","injectScroll","serializeScrollMessage","InjectScroll","backOrScreenOn","serializeBackOrScreenOnControlMessage","BackOrScreenOn","setScreenPowerMode","mode","SetScreenPowerMode","rotateDevice","ScrcpyRotateDeviceControlMessage","RotateDevice","ScrcpyControlMessageWriter","writer","serializer","write","stream_extra_esm","ConsumableWritableStream","releaseLock","close","ScrcpyAckClipboardDeviceMessage","uint64","extra","AckClipboard","ScrcpyClipboardDeviceMessage","Clipboard","ScrcpyDeviceMessageDeserializeStream","BufferedTransformStream","stream","readExactly","deserialize","e","tb","oU","hy","CODEC_OPTION_TYPES","repeatPreviousFrameAfter","maxPtsGapToEncoder","CodecOptions","toOptionValue","entries","Object","filter","map","key","input","replace","toLowerCase","join","clamp","max","ScrcpyFloatToUint16FieldDefinition","Pl","size","signed","array","littleEndian","ek","Uint16","dataView","offset","SCRCPY_CONTROL_MESSAGE_TYPES_1_16","ExpandNotificationPanel","CollapseNotificationPanel","GetClipboard","SetClipboard","ScrcpyMediaStreamRawPacket","uint8Array","SCRCPY_MEDIA_PACKET_FLAG_CONFIG","ScrcpyInjectTouchControlMessage1_16","uint16","field","ScrcpySetClipboardControlMessage1_15","ScrcpyAudioCodec","OPUS","AAC","RAW","optionValue","metadataValue","mimeType","webCodecId","DEFAULT_SERVER_PATH","toScrcpyOptionValue","empty","String","ScrcpyOptionsBase","_base","base","setValue","assign","setListEncoders","setListDisplays","parseEncoder","line","parseDisplay","parseVideoStreamMetadata","parseAudioStreamMetadata","createMediaStreamTransformer","serializeSetClipboardControlMessage","ScrcpyInjectScrollControlMessage1_16","int32","ScrcpyScrollController1_16","accumulatedX","accumulatedY","processMessage","scrollX","scrollY","processed","ScrcpyOptions1_16","DEFAULTS","logLevel","Debug","maxSize","bitRate","maxFps","lockVideoOrientation","Unlocked","tunnelForward","crop","sendFrameMeta","control","displayId","showTouches","stayAwake","codecOptions","SERIALIZE_ORDER","order","parseCString","maxLength","FO","substring","parseUint16BE","parseUint32BE","Uint32","defaults","init","match","id","parseInt","buffered","BufferedReadableStream","metadata","codec","H264","deviceName","width","height","release","TransformStream","transform","chunk","controller","enqueue","deserializeStream","StructDeserializeStream","writable","readable","pipeThrough","packet","pts","Down","ScrcpyBackOrScreenOnControlMessage1_16","ScrcpyOptions1_17","encoderName","encoderNameRegex","name","ScrcpyBackOrScreenOnControlMessage1_18","concat","SCRCPY_CONTROL_MESSAGE_TYPES_1_18","slice","splice","ExpandSettingPanel","LOG_LEVEL_MAP","Verbose","Info","Warn","Error","VIDEO_ORIENTATION_MAP","Initial","Portrait","Landscape","PortraitFlipped","LandscapeFlipped","ScrcpyOptions1_18","powerOffOnClose","ScrcpySetClipboardControlMessage1_21","int8","ScrcpyOptions1_21","clipboardAutosync","serializedValue","defaultValue","ScrcpyInjectScrollControlMessage1_22","ScrcpyScrollController1_22","ScrcpyOptions1_22","downsizeOnError","sendDeviceMeta","sendDummyByte","KEYFRAME_PTS","ScrcpyOptions1_23","cleanup","keyframe","ScrcpyOptions1_24","powerOn","ScrcpyFloatToInt16FieldDefinition","Int16","ScrcpyInjectScrollControlMessage1_25","ScrcpyScrollController1_25","ScrcpyOptions1_25","ScrcpyInjectTouchControlMessage2_0","ScrcpyInstanceId","NONE","random","toString","ScrcpyOptions2_0","omit","obj","keys","includes","scid","videoCodec","videoBitRate","videoCodecOptions","videoEncoder","audio","audioCodec","audioBitRate","audioCodecOptions","audioEncoder","listEncoders","listDisplays","sendCodecMeta","display","resolution","H265","AV1","codecMetadataValue","PushReadableStream","getReader","done","ScrcpyOptions2_1","video","audioSource","ScrcpyLogLevel","ScrcpyVideoOrientation","ScrcpyOptionsLatest","toHex","padStart","toUpperCase","toUint32Le","WebCodecsDecoder","isSupported","globalThis","VideoDecoder","capabilities","h264","h265","renderer","frameRendered","frameSkipped","context","decoder","config","currentFrameRendered","animationFrameId","document","createElement","getContext","output","drawImage","frame","error","WritableStream","configure","decode","onFramePresented","requestAnimationFrame","optimizeForLatency","set","EncodedVideoChunk","timestamp","dispose","cancelAnimationFrame","MatroskaVideoCodecNameMap","MatroskaAudioCodecNameMap","MatroskaMuxingRecorder","addVideoChunk","_firstTimestamp","sample","h264StreamToAvcSample","nalUnits","totalLength","unit","muxer","addVideoChunkRaw","configurationWritten","decoderConfig","description","videoCodecDescription","addVideoPacket","videoMetadata","h264ConfigurationToAvcDecoderConfigurationRecord","h265ConfigurationToHevcDecoderConfigurationRecord","general_profile_space","general_tier_flag","general_profile_idc","_packetsFromLastKeyframe","console","addAudioChunk","addAudioChunkRaw","addAudioPacket","_this_videoMetadata_width","_this_videoMetadata_height","running","target","ArrayBufferTarget","firstTimestampBehavior","sampleRate","numberOfChannels","bitDepth","WebMMuxer","stop","finalize","now","Date","saveFile","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getWriter","RECORD_STATE","makeAutoObservable","recorder","recording","intervalId","hours","minutes","seconds","reaction","setInterval","clearInterval","AdbScrcpyExitedError","AdbScrcpyClient","pushServer","adb","file","filename","sync","path","version","connection","createConnection","initialize","adb_esm","AdbReverseNotSupportedError","tunnelForwardOverride","subprocess","spawn","protocols","AdbSubprocessNoneProtocol","stdout","DecodeUtf8Stream","SplitStringStream","abortController","AbortController","pipe","pipeTo","signal","preventCancel","catch","aborted","streams","Promise","race","exit","then","getStreams","abort","concatStreams","item","videoStream","audioStream","controlStream","kill","getEncoders","getDisplays","screenWidth","screenHeight","controlMessageWriter","deviceMessageStream","createVideoStream","createAudioStream","initialStream","InspectStream","AdbScrcpyConnection","socketName","getSocketName","AdbScrcpyForwardConnection","disposed","connect","createSocket","connectAndRetry","async_esm","delay","AdbScrcpyReverseConnection","address","reverse","remove","queue","add","socket","accept","NOOP","types_AdbScrcpyOptionsBase","_1_16_AdbScrcpyOptions1_16","connectionOptions","client","encoders","encoder","displays","AdbScrcpyOptions2_0","AdbScrcpyOptions2_1","AdbScrcpyOptionsLatest","VERSION","BIN","U","PcmPlayer","worklet","buffers","AudioContext","latencyHint","feed","source","feedCore","audioWorklet","addModule","AudioWorkletNode","sourceName","numberOfInputs","numberOfOutputs","outputChannelCount","destination","disconnect","Int16PcmPlayer","byteOffset","port","postMessage","Float32PcmPlayer","Float32PlanerPcmPlayer","channel","AacDecodeStream","AudioDecoder","log","Array","from","_","format","planeIndex","Float32Array","allocationSize","BYTES_PER_ELEMENT","copyTo","EncodedAudioChunk","flush","OpusDecodeStream","FetchWithProgress","downloaded","_downloaded","total","_total","onProgress","progressEvent","event","fetch","url","response","headers","fire","body","chunks","reduce","position","EventEmitter","promise","fetchServer","ScrcpyKeyboardInjector","setModifier","keyCode","ControlLeft","_controlLeft","ControlRight","_controlRight","ShiftLeft","_shiftLeft","ShiftRight","_shiftRight","AltLeft","_altLeft","AltRight","_altRight","MetaLeft","_metaLeft","MetaRight","_metaRight","CapsLock","_capsLock","NumLock","_numLock","getMetaState","metaState","AltOn","AltLeftOn","AltRightOn","ShiftOn","ShiftLeftOn","ShiftRightOn","CtrlOn","CtrlLeftOn","CtrlRightOn","MetaOn","MetaLeftOn","MetaRightOn","CapsLockOn","NumLockOn","down","_this_client_controlMessageWriter","_keys","repeat","up","delete","reset","clear","Set","AoaKeyboardInjector","register","device","keyboard","AoaHidDevice","HidKeyboard","DESCRIPTOR","HidKeyCode","hidKeyboard","aoaKeyboard","sendInputReport","serializeInputReport","unregister","workerReady","pendingResolvers","streamId","PICTURE_READY_SUBSCRIPTIONS","Map","TinyH264Wrapper","event_esm","Xn","pictureReadyEvent","vp","onPictureReady","handler","addDisposable","handlePictureReady","renderStateId","all","t","bind","YuvBuffer","default","YuvCanvas","TinyH264Decoder","maxProfile","Baseline","maxLevel","Level4","yuvCanvas","initializer","wrapper","PromiseResolver","attach","chromaWidth","chromaHeight","cropWidth","cropHeight","displayWidth","displayHeight","createTinyH264Wrapper","Worker","tu","URL","p","u","b","addEventListener","resolver","resolve","uPlaneOffset","vPlaneOffset","lumaPlane","chromaPlane","drawFrame","useClasses","makeStyles","labelRight","marginLeft","maxWidth","SettingItem","observer","param","definition","onChange","classes","label","jsx_runtime","jsxs","Stack","horizontal","verticalAlign","span","TooltipHost","content","Icon","className","iconName","Icons","labelExtra","TextField","placeholder","Dropdown","selectedKey","option","Toggle","checked","disabled","SpinButton","labelPosition","Position","top","step","DEFAULT_SETTINGS","SETTING_STATE","decoders","Constructor","settings","clientSettings","observable","shallow","deep","SCRCPY_SETTINGS_FILENAME","autorun","GLOBAL_STATE","JSON","parse","ConcatStringStream","runInAction","AdbSyncError","SETTING_DEFINITIONS","computed","group","IconButton","iconProps","ArrowClockwise","onClick","STATE","some","x","showErrorDialog","encodersForCurrentVideoCodec","every","encodersForCurrentAudioCodec","rotatedWidth","rotation","rotatedHeight","serverBuffer","ReadableStream","Consumable","_this_client","_this_decoder","_this_keyboard","_this_audioPlayer","audioPlayer","fps","clearTimeout","fpsCounterIntervalId","isFullScreen","exitFullscreen","setFullScreenContainer","element","fullScreenContainer","setRendererContainer","rendererContainer","clientPositionToDevicePosition","clientX","clientY","viewRect","getBoundingClientRect","pointerViewX","pointerViewY","y","logVisible","demoModeVisible","navigationBarVisible","hoverHelper","connecting","serverTotalSize","serverDownloadedSize","debouncedServerDownloadedSize","serverDownloadSpeed","serverUploadedSize","debouncedServerUploadedSize","serverUploadSpeed","DistributionStream","ADB_SYNC_MAX_PACKET_SIZE","ProgressStream","progress","decoderDefinition","find","ignoreDecoderCodecArgs","capability","profile","level","encodeUtf8","stringify","lastFrameRendered","lastFrameSkipped","deltaRendered","deltaSkipped","lastKeyframe","interval","recordStream","playbackStream","tee","Int16Array","navigator","clipboard","writeText","turnScreenOff","Off","AdbDaemonWebUsbDevice","bound","fullscreenElement","firstChild","appendChild","ITEMS","Stop","Record","color","focus","FullScreenMaximize","iconOnly","requestFullscreen","Speaker2","VolumeUp","Speaker1","VolumeDown","SpeakerOff","VolumeMute","Orientation","RotateLeft","RotateRight","Lightbulb","LightbulbFilament","Normal","onRender","itemType","ContextualMenuItemType","Divider","PanelBottom","canCheck","TextGrammarError","Wand","ScrcpyCommandBar","CommandBar","items","backgroundColor","bar","icon","back","handlePointerDown","button","currentTarget","setPointerCapture","preventDefault","stopPropagation","handlePointerUp","handleBackPointerDown","handleBackPointerUp","handleHomePointerDown","AndroidHome","handleHomePointerUp","handleAppSwitchPointerDown","AndroidAppSwitch","handleAppSwitchPointerUp","NavigationBar","children","mergeClasses","verticalFill","horizontalAlign","Play","onPointerDown","onPointerUp","Circle","transformOrigin","touchAction","handleWheel","pointerX","pointerY","deltaX","deltaY","buttons","MOUSE_EVENT_BUTTON_TO_ANDROID_BUTTON","Primary","Tertiary","Secondary","Back","Forward","pointerType","BigInt","messages","pressure","actionButton","handlePointerMove","Move","handlePointerLeave","HoverExit","handleContextMenu","VideoContainer","passive","removeEventListener","onPointerMove","onPointerCancel","onPointerLeave","onContextMenu","useAddEventListener","listener","deps","targetValue","useLayoutEffect","useReactLayoutEffect","Symbol","useLocalStorage","localStorage","fallbackValue","getItem","handleChange","useStableCallback","callback","callbackRef","useLatestRef","useRef","useConst","_len","arguments","args","_key","setItem","layerHost","bottom","left","right","pointerEvents","shorthands","margin","flexDirection","outline","fullScreenStatusBar","columnGap","padding","spacer","ConnectingDialog","layerHostId","useId","isClient","setIsClient","Fragment","LayerHost","Dialog","hidden","modalProps","layerProps","hostId","dialogContentProps","title","tokens","CommonStackTokens","ProgressIndicator","percentComplete","formatSpeed","progressHidden","handleKeyEvent","code","handleBlur","FullscreenHint","keyboardLockEnabled","hintHidden","setHintHidden","serial","Link","scrcpy","unshift","setKeyboardLockEnabled","lock","unlock","RouteStackProps","Head","grow","styles","root","tabIndex","onKeyDown","onKeyUp","DeviceView","BottomElement","overflow","fontFamily","overflowY","whiteSpace","wordWrap","index","DemoModePanel","ExternalLink","href","spaceAfter","StackItem","align","PrimaryButton"],"sourceRoot":""}